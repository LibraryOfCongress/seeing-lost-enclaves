{"version":3,"sources":["three","src/index.ts","src/data/constants.ts","src/icons/arrow.svg","src/icons/close.svg","src/icons/download.svg","src/icons/fullscreen-in.svg","src/icons/fullscreen-out.svg","src/icons/info.svg","src/icons/menu.svg","src/icons/zoom-in.svg","src/icons/zoom-out.svg","src/utils/index.ts","src/utils/math.ts","src/utils/browser.ts","src/utils/misc.ts","src/utils/psv.ts","src/PSVError.ts","src/utils/Animation.ts","src/utils/Dynamic.ts","src/utils/MultiDynamic.ts","src/utils/PressHandler.ts","src/utils/Slider.ts","src/events.ts","src/lib/TypedEventTarget.ts","src/adapters/AbstractAdapter.ts","src/adapters/EquirectangularAdapter.ts","src/data/system.ts","src/adapters/interpolationWorker.ts","src/components/AbstractComponent.ts","src/buttons/AbstractButton.ts","src/buttons/CustomButton.ts","src/buttons/DescriptionButton.ts","src/buttons/DownloadButton.ts","src/buttons/FullscreenButton.ts","src/buttons/MenuButton.ts","src/buttons/AbstractMoveButton.ts","src/buttons/MoveDownButton.ts","src/buttons/MoveLeftButton.ts","src/buttons/MoveRightButton.ts","src/buttons/MoveUpButton.ts","src/buttons/AbstractZoomButton.ts","src/buttons/ZoomInButton.ts","src/buttons/ZoomOutButton.ts","src/buttons/ZoomRangeButton.ts","src/data/config.ts","src/plugins/AbstractPlugin.ts","src/components/NavbarCaption.ts","src/components/Navbar.ts","src/data/cache.ts","src/components/Loader.ts","src/components/Notification.ts","src/components/Overlay.ts","src/components/Panel.ts","src/components/Tooltip.ts","src/icons/error.svg","src/services/DataHelper.ts","src/services/AbstractService.ts","src/services/EventsHandler.ts","src/icons/gesture.svg","src/icons/mousewheel.svg","src/services/Renderer.ts","src/lib/BlobLoader.ts","src/lib/ImageLoader.ts","src/services/TextureLoader.ts","src/services/ViewerDynamics.ts","src/services/ViewerState.ts","src/Viewer.ts"],"sourcesContent":["module.exports = THREE","import * as CONSTANTS from './data/constants';\nimport * as utils from './utils';\nimport * as events from './events';\n\nexport type { AdapterConstructor } from './adapters/AbstractAdapter';\nexport type { EquirectangularAdapterConfig } from './adapters/EquirectangularAdapter';\nexport type { ButtonConfig, ButtonConstructor } from './buttons/AbstractButton';\nexport type { Tooltip, TooltipConfig, TooltipPosition } from './components/Tooltip';\nexport type { Loader } from './components/Loader';\nexport type { Navbar } from './components/Navbar';\nexport type { Notification, NotificationConfig } from './components/Notification';\nexport type { Overlay, OverlayConfig } from './components/Overlay';\nexport type { Panel, PanelConfig } from './components/Panel';\nexport type { TypedEventTarget } from './lib/TypedEventTarget';\nexport type { PluginConstructor } from './plugins/AbstractPlugin';\nexport type { DataHelper } from './services/DataHelper';\nexport type { Renderer, CustomRenderer } from './services/Renderer';\nexport type { TextureLoader } from './services/TextureLoader';\nexport type { ViewerState } from './services/ViewerState';\n\nexport { AbstractAdapter } from './adapters/AbstractAdapter';\nexport { EquirectangularAdapter } from './adapters/EquirectangularAdapter';\nexport { AbstractButton } from './buttons/AbstractButton';\nexport { AbstractComponent } from './components/AbstractComponent';\nexport { registerButton } from './components/Navbar';\nexport { Cache } from './data/cache';\nexport { DEFAULTS } from './data/config';\nexport { SYSTEM } from './data/system';\nexport { TypedEvent } from './lib/TypedEventTarget';\nexport { AbstractPlugin, AbstractConfigurablePlugin } from './plugins/AbstractPlugin';\nexport { PSVError } from './PSVError';\nexport { Viewer } from './Viewer';\nexport * from './model';\nexport { CONSTANTS, events, utils };\nexport const VERSION = PKG_VERSION;\n\n/** @internal  */\nimport './styles/index.scss';\n","import arrow from '../icons/arrow.svg';\nimport close from '../icons/close.svg';\nimport download from '../icons/download.svg';\nimport fullscreenIn from '../icons/fullscreen-in.svg';\nimport fullscreenOut from '../icons/fullscreen-out.svg';\nimport info from '../icons/info.svg';\nimport menu from '../icons/menu.svg';\nimport zoomIn from '../icons/zoom-in.svg';\nimport zoomOut from '../icons/zoom-out.svg';\n\n/**\n * Default duration of the transition between panoramas\n */\nexport const DEFAULT_TRANSITION = 1500;\n\n/**\n *  Minimum duration of the animations created with {@link Viewer#animate}\n */\nexport const ANIMATION_MIN_DURATION = 500;\n\n/**\n * Number of pixels bellow which a mouse move will be considered as a click\n */\nexport const MOVE_THRESHOLD = 4;\n\n/**\n * Delay in milliseconds between two clicks to consider a double click\n */\nexport const DBLCLICK_DELAY = 300;\n\n/**\n * Delay in milliseconds to emulate a long touch\n */\nexport const LONGTOUCH_DELAY = 500;\n\n/**\n * Delay in milliseconds to for the two fingers overlay to appear\n */\nexport const TWOFINGERSOVERLAY_DELAY = 100;\n\n/**\n * Duration in milliseconds of the \"ctrl zoom\" overlay\n */\nexport const CTRLZOOM_TIMEOUT = 2000;\n\n/**\n * Duration of the mouse position history used to compute inertia\n */\nexport const INERTIA_WINDOW = 300;\n\n/**\n * Radius of the SphereGeometry, Half-length of the BoxGeometry\n */\nexport const SPHERE_RADIUS = 10;\n\n/**\n * Property name added to viewer element\n */\nexport const VIEWER_DATA = 'photoSphereViewer';\n\n/**\n * CSS class that must be applied on elements whose mouse events must not bubble to the viewer itself\n */\nexport const CAPTURE_EVENTS_CLASS = 'psv--capture-event';\n\n/**\n * Actions available for {@link ViewerConfig['keyboard']} configuration\n */\nexport enum ACTIONS {\n    ROTATE_UP = 'ROTATE_UP',\n    ROTATE_DOWN = 'ROTATE_DOWN',\n    ROTATE_RIGHT = 'ROTATE_RIGHT',\n    ROTATE_LEFT = 'ROTATE_LEFT',\n    ZOOM_IN = 'ZOOM_IN',\n    ZOOM_OUT = 'ZOOM_OUT',\n}\n\n/**\n * Internal identifiers for various stuff\n * @internal\n */\nexport const IDS = {\n    MENU: 'menu',\n    TWO_FINGERS: 'twoFingers',\n    CTRL_ZOOM: 'ctrlZoom',\n    ERROR: 'error',\n    DESCRIPTION: 'description',\n};\n\n/**\n * Subset of keyboard codes\n */\nexport const KEY_CODES = {\n    Enter: 'Enter',\n    Control: 'Control',\n    Escape: 'Escape',\n    Space: ' ',\n    PageUp: 'PageUp',\n    PageDown: 'PageDown',\n    ArrowLeft: 'ArrowLeft',\n    ArrowUp: 'ArrowUp',\n    ArrowRight: 'ArrowRight',\n    ArrowDown: 'ArrowDown',\n    Delete: 'Delete',\n    Plus: '+',\n    Minus: '-',\n};\n\n/**\n * Collection of SVG icons\n */\nexport const ICONS = {\n    arrow,\n    close,\n    download,\n    fullscreenIn,\n    fullscreenOut,\n    info,\n    menu,\n    zoomIn,\n    zoomOut,\n};\n\n/**\n * Collection of easing functions\n * @link https://gist.github.com/frederickk/6165768\n */\n// @formatter:off\n// prettier-ignore\nexport const EASINGS: Record<string, (t: number) => number> = {\n    linear: (t: number) => t,\n\n    inQuad: (t: number) => t * t,\n    outQuad: (t: number) => t * (2 - t),\n    inOutQuad: (t: number) => (t < 0.5 ? 2 * t * t : -1 + (4 - 2 * t) * t),\n\n    inCubic: (t: number) => t * t * t,\n    outCubic: (t: number) => --t * t * t + 1,\n    inOutCubic: (t: number) => (t < 0.5 ? 4 * t * t * t : (t - 1) * (2 * t - 2) * (2 * t - 2) + 1),\n\n    inQuart: (t: number) => t * t * t * t,\n    outQuart: (t: number) => 1 - --t * t * t * t,\n    inOutQuart: (t: number) => (t < 0.5 ? 8 * t * t * t * t : 1 - 8 * --t * t * t * t),\n\n    inQuint: (t: number) => t * t * t * t * t,\n    outQuint: (t: number) => 1 + --t * t * t * t * t,\n    inOutQuint: (t: number) => (t < 0.5 ? 16 * t * t * t * t * t : 1 + 16 * --t * t * t * t * t),\n\n    inSine: (t: number) => 1 - Math.cos(t * (Math.PI / 2)),\n    outSine: (t: number) => Math.sin(t * (Math.PI / 2)),\n    inOutSine: (t: number) => 0.5 - 0.5 * Math.cos(Math.PI * t),\n\n    inExpo: (t: number) => Math.pow(2, 10 * (t - 1)),\n    outExpo: (t: number) => 1 - Math.pow(2, -10 * t),\n    inOutExpo: (t: number) => ((t = t * 2 - 1) < 0 ? 0.5 * Math.pow(2, 10 * t) : 1 - 0.5 * Math.pow(2, -10 * t)),\n\n    inCirc: (t: number) => 1 - Math.sqrt(1 - t * t),\n    outCirc: (t: number) => Math.sqrt(1 - (t - 1) * (t - 1)),\n    inOutCirc: (t: number) => (t *= 2) < 1 ? 0.5 - 0.5 * Math.sqrt(1 - t * t) : 0.5 + 0.5 * Math.sqrt(1 - (t -= 2) * t),\n};\n// @formatter:on\n","<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"40 40 432 432\"><g transform=\"rotate(0, 256, 256)\"><path fill=\"currentColor\" d=\"M425.23 210.55H227.39a5 5 0 01-3.53-8.53l56.56-56.57a45.5 45.5 0 000-64.28 45.15 45.15 0 00-32.13-13.3 45.15 45.15 0 00-32.14 13.3L41.32 256l174.83 174.83a45.15 45.15 0 0032.14 13.3 45.15 45.15 0 0032.13-13.3 45.5 45.5 0 000-64.28l-56.57-56.57a5 5 0 013.54-8.53h197.84c25.06 0 45.45-20.39 45.45-45.45s-20.4-45.45-45.45-45.45z\"/></g><!-- Created by Flatart from the Noun Project --></svg>\n","<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 100 100\"><g fill=\"currentColor\" transform=\" translate(50, 50) rotate(45)\"><rect x=\"-5\" y=\"-65\" width=\"10\" height=\"130\"/><rect x=\"-65\" y=\"-5\" width=\"130\" height=\"10\"/></g></svg>","<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 100 100\"><path fill=\"currentColor\" d=\"M83.3 35.6h-17V3H32.2v32.6H16.6l33.6 32.7 33-32.7z\"/><path fill=\"currentColor\" d=\"M83.3 64.2v16.3H16.6V64.2H-.1v32.6H100V64.2H83.3z\"/><!--Created by Michael Zenaty from the Noun Project--></svg>\n","<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 100 100\"><path fill=\"currentColor\" d=\"M100 40H87.1V18.8h-21V6H100zM100 93.2H66V80.3h21.1v-21H100zM34 93.2H0v-34h12.9v21.1h21zM12.9 40H0V6h34v12.9H12.8z\"/><!--Created by Garrett Knoll from the Noun Project--></svg>\n","<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 100 100\"><path fill=\"currentColor\" d=\"M66 7h13v21h21v13H66zM66 60.3h34v12.9H79v21H66zM0 60.3h34v34H21V73.1H0zM21 7h13v34H0V28h21z\"/><!--Created by Garrett Knoll from the Noun Project--></svg>\n","<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 64 64\"><path fill=\"currentColor\" d=\"M28.3 26.1c-1 2.6-1.9 4.8-2.6 7-2.5 7.4-5 14.7-7.2 22-1.3 4.4.5 7.2 4.3 7.8 1.3.2 2.8.2 4.2-.1 8.2-2 11.9-8.6 15.7-15.2l-2.2 2a18.8 18.8 0 0 1-7.4 5.2 2 2 0 0 1-1.6-.2c-.2-.1 0-1 0-1.4l.8-1.8L41.9 28c.5-1.4.9-3 .7-4.4-.2-2.6-3-4.4-6.3-4.4-8.8.2-15 4.5-19.5 11.8-.2.3-.2.6-.3 1.3 3.7-2.8 6.8-6.1 11.8-6.2z\"/><circle fill=\"currentColor\" cx=\"39.3\" cy=\"9.2\" r=\"8.2\"/><!--Created by Arafat Uddin from the Noun Project--></svg>\n","<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"10 10 80 80\"><g fill=\"currentColor\"><circle r=\"10\" cx=\"20\" cy=\"20\"/><circle r=\"10\" cx=\"50\" cy=\"20\"/><circle r=\"10\" cx=\"80\" cy=\"20\"/><circle r=\"10\" cx=\"20\" cy=\"50\"/><circle r=\"10\" cx=\"50\" cy=\"50\"/><circle r=\"10\" cx=\"80\" cy=\"50\"/><circle r=\"10\" cx=\"20\" cy=\"80\"/><circle r=\"10\" cx=\"50\" cy=\"80\"/><circle r=\"10\" cx=\"80\" cy=\"80\"/></g><!-- Created by Richard Kunák from the Noun Project--></svg>\n","<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 20 20\"><path fill=\"currentColor\" d=\"M14.043 12.22a7.738 7.738 0 1 0-1.823 1.822l4.985 4.985c.503.504 1.32.504 1.822 0a1.285 1.285 0 0 0 0-1.822l-4.984-4.985zm-6.305 1.043a5.527 5.527 0 1 1 0-11.053 5.527 5.527 0 0 1 0 11.053z\"/><path fill=\"currentColor\" d=\"M8.728 4.009H6.744v2.737H4.006V8.73h2.738v2.736h1.984V8.73h2.737V6.746H8.728z\"/><!--Created by Ryan Canning from the Noun Project--></svg>\n","<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 20 20\"><path fill=\"currentColor\" d=\"M14.043 12.22a7.738 7.738 0 1 0-1.823 1.822l4.985 4.985c.503.504 1.32.504 1.822 0a1.285 1.285 0 0 0 0-1.822l-4.984-4.985zm-6.305 1.043a5.527 5.527 0 1 1 0-11.053 5.527 5.527 0 0 1 0 11.053z\"/><path fill=\"currentColor\" d=\"M4.006 6.746h7.459V8.73H4.006z\"/><!--Created by Ryan Canning from the Noun Project--></svg>\n","export * from './browser';\nexport * from './math';\nexport * from './misc';\nexport * from './psv';\n\nexport * from './Animation';\nexport * from './Dynamic';\nexport * from './MultiDynamic';\nexport * from './PressHandler';\nexport * from './Slider';\n","import { Point, Position } from '../model';\n\n/**\n * Ensures a value is within 0 and `max` by wrapping max to 0\n */\nexport function wrap(value: number, max: number): number {\n    let result = value % max;\n\n    if (result < 0) {\n        result += max;\n    }\n\n    return result;\n}\n\n/**\n * Computes the sum of an array\n */\nexport function sum(array: number[]): number {\n    return array.reduce((a, b) => a + b, 0);\n}\n\n/**\n * Computes the distance between two points\n */\nexport function distance(p1: Point, p2: Point): number {\n    return Math.sqrt(Math.pow(p1.x - p2.x, 2) + Math.pow(p1.y - p2.y, 2));\n}\n\n/**\n * Computes the angle wet ween two points\n */\nexport function angle(p1: Point, p2: Point): number {\n    return Math.atan2(p2.y - p1.y, p2.x - p1.x);\n}\n\n/**\n * Compute the shortest offset between two angles on a sphere\n */\nexport function getShortestArc(from: number, to: number): number {\n    const candidates = [\n        0, // direct\n        Math.PI * 2, // clock-wise cross zero\n        -Math.PI * 2, // counter-clock-wise cross zero\n    ];\n\n    return candidates.reduce((value, candidate) => {\n        const newCandidate = to - from + candidate;\n        return Math.abs(newCandidate) < Math.abs(value) ? newCandidate : value;\n    }, Infinity);\n}\n\n/**\n * Computes the angle between the current position and a target position\n */\nexport function getAngle(position1: Position, position2: Position): number {\n    // prettier-ignore\n    return Math.acos(\n        Math.cos(position1.pitch)\n        * Math.cos(position2.pitch) \n        * Math.cos(position1.yaw - position2.yaw) \n        + Math.sin(position1.pitch) \n        * Math.sin(position2.pitch)\n    );\n}\n\n/**\n * Returns the distance between two points on a sphere of radius one\n * @link http://www.movable-type.co.uk/scripts/latlong.html\n */\nexport function greatArcDistance([yaw1, pitch1]: [number, number], [yaw2, pitch2]: [number, number]): number {\n    // if yaw delta is > PI, apply an offset to only consider the shortest arc\n    if (yaw1 - yaw2 > Math.PI) {\n        yaw1 -= 2 * Math.PI;\n    } else if (yaw1 - yaw2 < -Math.PI) {\n        yaw1 += 2 * Math.PI;\n    }\n    const x = (yaw2 - yaw1) * Math.cos((pitch1 + pitch2) / 2);\n    const y = pitch2 - pitch1;\n    return Math.sqrt(x * x + y * y);\n}\n","import { Point } from '../model';\nimport { angle, distance } from './math';\n\n/**\n * Get an element in the page by an unknown selector\n */\nexport function getElement(selector: string | HTMLElement): HTMLElement {\n    if (typeof selector === 'string') {\n        return selector.match(/^[a-z]/i) ? document.getElementById(selector) : document.querySelector(selector);\n    } else {\n        return selector;\n    }\n}\n\n/**\n * Toggles a CSS class\n */\nexport function toggleClass(element: Element, className: string, active?: boolean) {\n    if (active === undefined) {\n        element.classList.toggle(className);\n    } else if (active) {\n        element.classList.add(className);\n    } else if (!active) {\n        element.classList.remove(className);\n    }\n}\n\n/**\n * Adds one or several CSS classes to an element\n */\nexport function addClasses(element: Element, className: string) {\n    element.classList.add(...className.split(' '));\n}\n\n/**\n * Removes one or several CSS classes to an element\n */\nexport function removeClasses(element: Element, className: string) {\n    element.classList.remove(...className.split(' '));\n}\n\n/**\n * Searches if an element has a particular parent at any level including itself\n */\nexport function hasParent(el: HTMLElement, parent: Element): boolean {\n    let test: HTMLElement | null = el;\n\n    do {\n        if (test === parent) {\n            return true;\n        }\n        test = test.parentElement;\n    } while (test);\n\n    return false;\n}\n\n/**\n * Gets the closest parent (can by itself)\n */\nexport function getClosest(el: HTMLElement, selector: string): HTMLElement | null {\n    // When el is document or window, the matches does not exist\n    if (!el?.matches) {\n        return null;\n    }\n\n    let test: HTMLElement | null = el;\n\n    do {\n        if (test.matches(selector)) {\n            return test;\n        }\n        test = test.parentElement;\n    } while (test);\n\n    return null;\n}\n\n/**\n * Gets the position of an element in the viewer without reflow\n * @description Will gives the same result as getBoundingClientRect() as soon as there are no CSS transforms\n */\nexport function getPosition(el: HTMLElement): Point {\n    let x = 0;\n    let y = 0;\n    let test: HTMLElement | null = el;\n\n    while (test) {\n        x += test.offsetLeft - test.scrollLeft + test.clientLeft;\n        y += test.offsetTop - test.scrollTop + test.clientTop;\n        test = test.offsetParent as HTMLElement;\n    }\n\n    return { x, y };\n}\n\n/**\n * Gets an element style value\n */\nexport function getStyleProperty(elt: Element, varname: string): string {\n    return window.getComputedStyle(elt).getPropertyValue(varname);\n}\n\nexport type TouchData = {\n    distance: number;\n    angle: number;\n    center: Point;\n};\n\n/**\n * Returns data about a touch event (first 2 fingers) : distance, angle, center\n */\nexport function getTouchData(e: TouchEvent): TouchData {\n    if (e.touches.length < 2) {\n        return null;\n    }\n\n    const p1 = { x: e.touches[0].clientX, y: e.touches[0].clientY };\n    const p2 = { x: e.touches[1].clientX, y: e.touches[1].clientY };\n\n    return {\n        distance: distance(p1, p2),\n        angle: angle(p1, p2),\n        center: { x: (p1.x + p2.x) / 2, y: (p1.y + p2.y) / 2 },\n    };\n}\n\n/**\n * Detects if fullscreen is enabled\n */\nexport function isFullscreenEnabled(elt: HTMLElement): boolean {\n    return (document.fullscreenElement || (document as any).webkitFullscreenElement) === elt;\n}\n\n/**\n * Enters fullscreen mode\n */\nexport function requestFullscreen(elt: HTMLElement) {\n    (elt.requestFullscreen || (elt as any).webkitRequestFullscreen).call(elt);\n}\n\n/**\n * Exits fullscreen mode\n */\nexport function exitFullscreen() {\n    (document.exitFullscreen || (document as any).webkitExitFullscreen).call(document);\n}\n","/**\n * Transforms a string to dash-case\n * @link https://github.com/shahata/dasherize\n */\nexport function dasherize(str: string): string {\n    return str.replace(/[A-Z](?:(?=[^A-Z])|[A-Z]*(?=[A-Z][^A-Z]|$))/g, (s, i) => {\n        return (i > 0 ? '-' : '') + s.toLowerCase();\n    });\n}\n\n/**\n * Returns a function, that, when invoked, will only be triggered at most once during a given window of time.\n */\nexport function throttle<T extends (...args: any) => any>(callback: T, wait: number): (...args: Parameters<T>) => void {\n    let paused = false;\n    return function (this: any, ...args: Parameters<T>) {\n        if (!paused) {\n            paused = true;\n            setTimeout(() => {\n                callback.apply(this, args);\n                paused = false;\n            }, wait);\n        }\n    };\n}\n\n/**\n * Test if an object is a plain object\n * @description Test if an object is a plain object, i.e. is constructed\n * by the built-in Object constructor and inherits directly from Object.prototype\n * or null.\n * @link https://github.com/lodash/lodash/blob/master/isPlainObject.js\n */\nexport function isPlainObject<T extends Record<string, any>>(value: any): value is T {\n    if (typeof value !== 'object' || value === null || Object.prototype.toString.call(value) !== '[object Object]') {\n        return false;\n    }\n    if (Object.getPrototypeOf(value) === null) {\n        return true;\n    }\n    let proto = value;\n    while (Object.getPrototypeOf(proto) !== null) {\n        proto = Object.getPrototypeOf(proto);\n    }\n    return Object.getPrototypeOf(value) === proto;\n}\n\n/**\n * Merges the enumerable attributes of two objects\n * @description Replaces arrays and alters the target object.\n * @copyright Nicholas Fisher <nfisher110@gmail.com>\n */\nexport function deepmerge<T>(target: T, src: T): T {\n    const first = src;\n\n    // eslint-disable-next-line @typescript-eslint/no-shadow\n    return (function merge(target: any, src: any) {\n        if (Array.isArray(src)) {\n            if (!target || !Array.isArray(target)) {\n                target = [];\n            } else {\n                target.length = 0;\n            }\n            src.forEach((e, i) => {\n                target[i] = merge(null, e);\n            });\n        } else if (typeof src === 'object') {\n            if (!target || Array.isArray(target)) {\n                target = {};\n            }\n            Object.keys(src).forEach((key) => {\n                if (typeof src[key] !== 'object' || !src[key] || !isPlainObject(src[key])) {\n                    target[key] = src[key];\n                } else if (src[key] !== first) {\n                    if (!target[key]) {\n                        target[key] = merge(null, src[key]);\n                    } else {\n                        merge(target[key], src[key]);\n                    }\n                }\n            });\n        } else {\n            target = src;\n        }\n\n        return target;\n    })(target, src);\n}\n\n/**\n * Deeply clones an object\n */\nexport function clone<T>(src: T): T {\n    return deepmerge(null as T, src);\n}\n\n/**\n * Tests of an object is empty\n */\nexport function isEmpty(obj: any): boolean {\n    return !obj || (Object.keys(obj).length === 0 && obj.constructor === Object);\n}\n\n/**\n * Returns if a valu is null or undefined\n */\nexport function isNil(val: any): val is null | undefined {\n    return val === null || val === undefined;\n}\n\n/**\n * Returns the first non null non undefined parameter\n */\nexport function firstNonNull<T>(...values: T[]): T | null {\n    for (const val of values) {\n        if (!isNil(val)) {\n            return val;\n        }\n    }\n\n    return null;\n}\n\n/**\n * Returns deep equality between objects\n * @link https://gist.github.com/egardner/efd34f270cc33db67c0246e837689cb9\n */\nexport function deepEqual(obj1: any, obj2: any): boolean {\n    if (obj1 === obj2) {\n        return true;\n    } else if (isObject(obj1) && isObject(obj2)) {\n        if (Object.keys(obj1).length !== Object.keys(obj2).length) {\n            return false;\n        }\n        for (const prop of Object.keys(obj1)) {\n            if (!deepEqual(obj1[prop], obj2[prop])) {\n                return false;\n            }\n        }\n        return true;\n    } else {\n        return false;\n    }\n}\n\nfunction isObject(obj: any): boolean {\n    return typeof obj === 'object' && obj !== null;\n}\n","import { Euler, LinearFilter, LinearMipmapLinearFilter, MathUtils, Quaternion, Texture, Vector3 } from 'three';\nimport { PSVError } from '../PSVError';\nimport { ExtendedPosition, Point, ResolvableBoolean } from '../model';\nimport { getStyleProperty } from './browser';\nimport { wrap } from './math';\nimport { clone, isPlainObject } from './misc';\n\n/**\n * Executes a callback with the value of a ResolvableBoolean\n */\nexport function resolveBoolean(value: boolean | ResolvableBoolean, cb: (val: boolean, init: boolean) => void) {\n    if (isPlainObject(value)) {\n        cb((value as ResolvableBoolean).initial, true);\n        (value as ResolvableBoolean).promise.then((res) => cb(res, false));\n    } else {\n        cb(value as boolean, true);\n    }\n}\n\n/**\n * Inverts the result of a ResolvableBoolean\n */\nexport function invertResolvableBoolean(value: ResolvableBoolean): ResolvableBoolean {\n    return {\n        initial: !value.initial,\n        promise: value.promise.then((res) => !res),\n    };\n}\n\n/**\n * Builds an Error with name 'AbortError'\n */\nexport function getAbortError(): Error {\n    const error = new Error('Loading was aborted.');\n    error.name = 'AbortError';\n    return error;\n}\n\n/**\n * Tests if an Error has name 'AbortError'\n */\nexport function isAbortError(err: Error): boolean {\n    return err?.name === 'AbortError';\n}\n\n/**\n * Displays a warning in the console with \"PhotoSphereViewer\" prefix\n */\nexport function logWarn(message: string) {\n    console.warn(`PhotoSphereViewer: ${message}`);\n}\n\n/**\n * Checks if an object is a ExtendedPosition, ie has textureX/textureY or yaw/pitch\n */\nexport function isExtendedPosition(object: any): object is ExtendedPosition {\n    if (!object) {\n        return false;\n    }\n    return [\n        ['textureX', 'textureY'],\n        ['yaw', 'pitch'],\n    ].some(([key1, key2]) => {\n        return object[key1] !== undefined && object[key2] !== undefined;\n    });\n}\n\n/**\n * Returns the value of a given attribute in the panorama metadata\n */\nexport function getXMPValue(data: string, attr: string): number | null {\n    // XMP data are stored in children\n    let result = data.match('<GPano:' + attr + '>(.*)</GPano:' + attr + '>');\n    if (result !== null) {\n        const val = parseInt(result[1], 10);\n        return isNaN(val) ? null : val;\n    }\n\n    // XMP data are stored in attributes\n    result = data.match('GPano:' + attr + '=\"(.*?)\"');\n    if (result !== null) {\n        const val = parseInt(result[1], 10);\n        return isNaN(val) ? null : val;\n    }\n\n    return null;\n}\n\nconst CSS_POSITIONS: Record<string, string> = {\n    top: '0%',\n    bottom: '100%',\n    left: '0%',\n    right: '100%',\n    center: '50%',\n};\nconst X_VALUES = ['left', 'center', 'right'];\nconst Y_VALUES = ['top', 'center', 'bottom'];\nconst POS_VALUES = [...X_VALUES, ...Y_VALUES];\nconst CENTER = 'center';\n\n/**\n * Translate CSS values like \"top center\" or \"10% 50%\" as top and left positions (0-1 range)\n * @description The implementation is as close as possible to the \"background-position\" specification\n * {@link https://developer.mozilla.org/en-US/docs/Web/CSS/background-position}\n */\nexport function parsePoint(value: string | Point): Point {\n    if (!value) {\n        return { x: 0.5, y: 0.5 };\n    }\n\n    if (typeof value === 'object') {\n        return value;\n    }\n\n    let tokens = value.toLocaleLowerCase().split(' ').slice(0, 2);\n\n    if (tokens.length === 1) {\n        if (CSS_POSITIONS[tokens[0]]) {\n            tokens = [tokens[0], CENTER];\n        } else {\n            tokens = [tokens[0], tokens[0]];\n        }\n    }\n\n    const xFirst = tokens[1] !== 'left' && tokens[1] !== 'right' && tokens[0] !== 'top' && tokens[0] !== 'bottom';\n\n    tokens = tokens.map((token) => CSS_POSITIONS[token] || token);\n\n    if (!xFirst) {\n        tokens.reverse();\n    }\n\n    const parsed = tokens.join(' ').match(/^([0-9.]+)% ([0-9.]+)%$/);\n\n    if (parsed) {\n        return {\n            x: parseFloat(parsed[1]) / 100,\n            y: parseFloat(parsed[2]) / 100,\n        };\n    } else {\n        return { x: 0.5, y: 0.5 };\n    }\n}\n\n/**\n * Parse a CSS-like position into an array of position keywords among top, bottom, left, right and center\n * @param value\n * @param [options]\n * @param [options.allowCenter=true] allow \"center center\"\n * @param [options.cssOrder=true] force CSS order (y axis then x axis)\n */\nexport function cleanCssPosition(\n    value: string | string[],\n    { allowCenter, cssOrder } = {\n        allowCenter: true,\n        cssOrder: true,\n    }\n): [string, string] | null {\n    if (!value) {\n        return null;\n    }\n\n    if (typeof value === 'string') {\n        value = value.split(' ');\n    }\n\n    if (value.length === 1) {\n        if (value[0] === CENTER) {\n            value = [CENTER, CENTER];\n        } else if (X_VALUES.indexOf(value[0]) !== -1) {\n            value = [CENTER, value[0]];\n        } else if (Y_VALUES.indexOf(value[0]) !== -1) {\n            value = [value[0], CENTER];\n        }\n    }\n\n    if (value.length !== 2 || POS_VALUES.indexOf(value[0]) === -1 || POS_VALUES.indexOf(value[1]) === -1) {\n        logWarn(`Unparsable position ${value}`);\n        return null;\n    }\n\n    if (!allowCenter && value[0] === CENTER && value[1] === CENTER) {\n        logWarn(`Invalid position center center`);\n        return null;\n    }\n\n    if (cssOrder && !cssPositionIsOrdered(value)) {\n        value = [value[1], value[0]];\n    }\n    if (value[1] === CENTER && X_VALUES.indexOf(value[0]) !== -1) {\n        value = [CENTER, value[0]];\n    }\n    if (value[0] === CENTER && Y_VALUES.indexOf(value[1]) !== -1) {\n        value = [value[1], CENTER];\n    }\n\n    return value as [string, string];\n}\n\n/**\n * Checks if an array of two positions is ordered (y axis then x axis)\n */\nexport function cssPositionIsOrdered(value: string[]): boolean {\n    return Y_VALUES.indexOf(value[0]) !== -1 && X_VALUES.indexOf(value[1]) !== -1;\n}\n\n/**\n * @summary Parses an speed\n * @param speed in radians/degrees/revolutions per second/minute\n * @throws {@link PSVError} when the speed cannot be parsed\n */\nexport function parseSpeed(speed: string | number): number {\n    let parsed;\n\n    if (typeof speed === 'string') {\n        const speedStr = speed.toString().trim();\n\n        // Speed extraction\n        let speedValue = parseFloat(speedStr.replace(/^(-?[0-9]+(?:\\.[0-9]*)?).*$/, '$1'));\n        const speedUnit = speedStr.replace(/^-?[0-9]+(?:\\.[0-9]*)?(.*)$/, '$1').trim();\n\n        // \"per minute\" -> \"per second\"\n        if (speedUnit.match(/(pm|per minute)$/)) {\n            speedValue /= 60;\n        }\n\n        // Which unit?\n        switch (speedUnit) {\n            // Degrees per minute / second\n            case 'dpm':\n            case 'degrees per minute':\n            case 'dps':\n            case 'degrees per second':\n                parsed = MathUtils.degToRad(speedValue);\n                break;\n\n            // Radians per minute / second\n            case 'rdpm':\n            case 'radians per minute':\n            case 'rdps':\n            case 'radians per second':\n                parsed = speedValue;\n                break;\n\n            // Revolutions per minute / second\n            case 'rpm':\n            case 'revolutions per minute':\n            case 'rps':\n            case 'revolutions per second':\n                parsed = speedValue * Math.PI * 2;\n                break;\n\n            // Unknown unit\n            default:\n                throw new PSVError(`Unknown speed unit \"${speedUnit}\"`);\n        }\n    } else {\n        parsed = speed;\n    }\n\n    return parsed;\n}\n\n/**\n * Converts a speed into a duration for a specific angle to travel\n */\nexport function speedToDuration(value: string | number, angle: number): number {\n    if (typeof value !== 'number') {\n        // desired radial speed\n        const speed = parseSpeed(value);\n        // compute duration\n        return (angle / Math.abs(speed)) * 1000;\n    } else {\n        return Math.abs(value);\n    }\n}\n\n/**\n * Parses an angle value in radians or degrees and returns a normalized value in radians\n * @param angle - eg: 3.14, 3.14rad, 180deg\n * @param [zeroCenter=false] - normalize between -Pi - Pi instead of 0 - 2*Pi\n * @param [halfCircle=zeroCenter] - normalize between -Pi/2 - Pi/2 instead of -Pi - Pi\n * @throws {@link PSVError} when the angle cannot be parsed\n */\nexport function parseAngle(angle: string | number, zeroCenter = false, halfCircle = zeroCenter): number {\n    let parsed;\n\n    if (typeof angle === 'string') {\n        const match = angle\n            .toLowerCase()\n            .trim()\n            .match(/^(-?[0-9]+(?:\\.[0-9]*)?)(.*)$/);\n\n        if (!match) {\n            throw new PSVError(`Unknown angle \"${angle}\"`);\n        }\n\n        const value = parseFloat(match[1]);\n        const unit = match[2];\n\n        if (unit) {\n            switch (unit) {\n                case 'deg':\n                case 'degs':\n                    parsed = MathUtils.degToRad(value);\n                    break;\n                case 'rad':\n                case 'rads':\n                    parsed = value;\n                    break;\n                default:\n                    throw new PSVError(`Unknown angle unit \"${unit}\"`);\n            }\n        } else {\n            parsed = value;\n        }\n    } else if (typeof angle === 'number' && !isNaN(angle)) {\n        parsed = angle;\n    } else {\n        throw new PSVError(`Unknown angle \"${angle}\"`);\n    }\n\n    parsed = wrap(zeroCenter ? parsed + Math.PI : parsed, Math.PI * 2);\n\n    return zeroCenter\n        ? MathUtils.clamp(parsed - Math.PI, -Math.PI / (halfCircle ? 2 : 1), Math.PI / (halfCircle ? 2 : 1))\n        : parsed;\n}\n\n/**\n * Creates a THREE texture from an image\n */\nexport function createTexture(img: HTMLImageElement | HTMLCanvasElement, mimaps = false): Texture {\n    const texture = new Texture(img);\n    texture.needsUpdate = true;\n    texture.minFilter = mimaps ? LinearMipmapLinearFilter : LinearFilter;\n    texture.generateMipmaps = mimaps;\n    texture.anisotropy = mimaps ? 2 : 1;\n    return texture;\n}\n\nconst quaternion = new Quaternion();\n\n/**\n * Applies the inverse of Euler angles to a vector\n */\nexport function applyEulerInverse(vector: Vector3, euler: Euler) {\n    quaternion.setFromEuler(euler).invert();\n    vector.applyQuaternion(quaternion);\n}\n\n/**\n * Declaration of configuration parsers, used by {@link getConfigParser}\n */\nexport type ConfigParsers<T, U extends T = T> = {\n    [key in keyof T]: (val: T[key], opts: { defValue: U[key]; rawConfig: T }) => U[key];\n};\n\n/**\n * Result of {@link getConfigParser}\n */\nexport type ConfigParser<T, U extends T> = {\n    (config: T): U;\n    defaults: Required<U>;\n    parsers: ConfigParsers<T, U>;\n};\n\n/**\n * Creates a function to validate an user configuration object\n *\n * @template T type of input config\n * @template U type of config after parsing\n *\n * @param defaults the default configuration\n * @param parsers function used to parse/validate the configuration\n *\n * @example\n * ```ts\n * type MyConfig = {\n *      value: number;\n *      label?: string;\n * };\n *\n * const getConfig<MyConfig>({\n *      value: 1,\n *      label: 'Title',\n * }, {\n *      value(value, { defValue }) {\n *          return value < 10 ? value : defValue;\n *      }\n * });\n *\n * const config = getConfig({ value: 3 });\n * ```\n */\nexport function getConfigParser<T extends Record<string, any>, U extends T = T>(\n    defaults: Required<U>,\n    parsers?: ConfigParsers<T, U>\n): ConfigParser<T, U> {\n    const parser = function (userConfig: T): U {\n        if (!userConfig) {\n            return clone(defaults);\n        }\n\n        const rawConfig: U = clone({\n            ...defaults,\n            ...userConfig,\n        });\n\n        const config: U = {} as U;\n\n        for (let [key, value] of Object.entries(rawConfig) as Array<[keyof T, any]>) {\n            if (parsers && key in parsers) {\n                value = parsers[key](value, {\n                    rawConfig: rawConfig,\n                    defValue: defaults[key],\n                });\n            } else if (!(key in defaults)) {\n                logWarn(`Unknown option ${key as string}`);\n                continue;\n            }\n\n            // @ts-ignore\n            config[key] = value;\n        }\n\n        return config;\n    } as ConfigParser<T, U>;\n\n    parser.defaults = defaults;\n    parser.parsers = parsers || ({} as any);\n\n    return parser;\n}\n\n/**\n * Checks if a stylesheet is loaded by the presence of a CSS variable\n */\nexport function checkStylesheet(element: HTMLElement, name: string) {\n    if (getStyleProperty(element, `--psv-${name}-loaded`) !== 'true') {\n        console.error(`PhotoSphereViewer: stylesheet \"@photo-sphere-viewer/${name}/index.css\" is not loaded`);\n    }\n}\n\n/**\n * Checks that a dependency version is the same as the core\n */\nexport function checkVersion(name: string, version: string, coreVersion: string) {\n    if (version && version !== coreVersion) {\n        console.error(`PhotoSphereViewer: @photo-sphere-viewer/${name} is in version ${version} but @photo-sphere-viewer/core is in version ${coreVersion}`);\n    }\n}\n","export class PSVError extends Error {\n    constructor(message: string) {\n        super(message);\n        this.name = 'PSVError';\n        (Error as any).captureStackTrace?.(this, PSVError);\n    }\n}\n","import { EASINGS } from '../data/constants';\n\n/**\n * Options for {@link Animation}\n */\nexport type AnimationOptions<T> = {\n    /**\n     * interpolated properties\n     */\n    properties: Partial<Record<keyof T, { start: number; end: number }>>;\n    /**\n     * duration of the animation\n     */\n    duration: number;\n    /**\n     * delay before start\n     * @default 0\n     */\n    delay?: number;\n    /**\n     * interpoaltion function, see {@link CONSTANTS.EASINGS}\n     * @default 'linear'\n     */\n    easing?: string | ((t: number) => number);\n    /**\n     * function called for each frame\n     */\n    onTick: (properties: Record<keyof T, number>, progress: number) => void;\n};\n\ntype PropertyValues = AnimationOptions<any>['properties']['k'];\n\n/**\n * @summary Interpolation helper for animations\n * @description\n * Implements the Promise API with an additional \"cancel\" method.\n * The promise is resolved with `true` when the animation is completed and `false` if the animation is cancelled.\n * @template T the type of interpoalted properties\n *\n * @example\n * ```ts\n * const anim = new Animation({\n *     properties: {\n *         width: {start: 100, end: 200}\n *     },\n *     duration: 5000,\n *     onTick: (properties) => element.style.width = `${properties.width}px`;\n * });\n *\n * anim.then((completed) => ...);\n *\n * anim.cancel();\n * ```\n */\nexport class Animation<T = any> implements PromiseLike<boolean> {\n    private options: AnimationOptions<T>;\n    private easing: (t: number) => number = EASINGS['linear'];\n    private callbacks: Array<(complete: boolean) => void> = [];\n    private start?: number;\n    private delayTimeout: ReturnType<typeof setTimeout>;\n    private animationFrame: ReturnType<typeof requestAnimationFrame>;\n\n    resolved = false;\n    cancelled = false;\n\n    constructor(options: AnimationOptions<T>) {\n        this.options = options;\n\n        if (options) {\n            if (options.easing) {\n                this.easing =\n                    typeof options.easing === 'function'\n                        ? options.easing\n                        : EASINGS[options.easing] || EASINGS['linear'];\n            }\n\n            this.delayTimeout = setTimeout(() => {\n                this.delayTimeout = undefined;\n                this.animationFrame = window.requestAnimationFrame((t) => this.__run(t));\n            }, options.delay || 0);\n        } else {\n            this.resolved = true;\n        }\n    }\n\n    private __run(timestamp: number) {\n        if (this.cancelled) {\n            return;\n        }\n\n        // first iteration\n        if (!this.start) {\n            this.start = timestamp;\n        }\n\n        // compute progress\n        const progress = (timestamp - this.start) / this.options.duration;\n        const current = {} as Record<keyof T, number>;\n\n        if (progress < 1.0) {\n            // interpolate properties\n            for (const [name, prop] of Object.entries(this.options.properties) as Array<[string, PropertyValues]>) {\n                if (prop) {\n                    const value = prop.start + (prop.end - prop.start) * this.easing(progress);\n                    // @ts-ignore\n                    current[name] = value;\n                }\n            }\n            this.options.onTick(current, progress);\n\n            this.animationFrame = window.requestAnimationFrame((t) => this.__run(t));\n        } else {\n            // call onTick one last time with final values\n            for (const [name, prop] of Object.entries(this.options.properties) as Array<[string, PropertyValues]>) {\n                if (prop) {\n                    // @ts-ignore\n                    current[name] = prop.end;\n                }\n            }\n            this.options.onTick(current, 1.0);\n\n            this.__resolve(true);\n            this.animationFrame = undefined;\n        }\n    }\n\n    private __resolve(value: boolean) {\n        if (value) {\n            this.resolved = true;\n        } else {\n            this.cancelled = true;\n        }\n        this.callbacks.forEach((cb) => cb(value));\n        this.callbacks.length = 0;\n    }\n\n    /**\n     * Promise chaining\n     * @param [onFulfilled] - Called when the animation is complete (true) or cancelled (false)\n     */\n    then<U>(onFulfilled: (complete: boolean) => PromiseLike<U> | U): Promise<U> {\n        if (this.resolved || this.cancelled) {\n            return Promise.resolve(this.resolved).then(onFulfilled);\n        }\n\n        return new Promise((resolve: (complete: boolean) => void) => {\n            this.callbacks.push(resolve);\n        }).then(onFulfilled);\n    }\n\n    /**\n     * Cancels the animation\n     */\n    cancel() {\n        if (!this.cancelled && !this.resolved) {\n            this.__resolve(false);\n\n            if (this.delayTimeout) {\n                window.clearTimeout(this.delayTimeout);\n                this.delayTimeout = undefined;\n            }\n            if (this.animationFrame) {\n                window.cancelAnimationFrame(this.animationFrame);\n                this.animationFrame = undefined;\n            }\n        }\n    }\n}\n","import { MathUtils } from 'three';\nimport { PSVError } from '../PSVError';\nimport { wrap } from './math';\n\nconst enum DynamicMode {\n    STOP,\n    INFINITE,\n    POSITION,\n}\n\n/**\n * Represents a variable that can dynamically change with time (using requestAnimationFrame)\n */\nexport class Dynamic {\n    private readonly min: number;\n    private readonly max: number;\n    private readonly wrap: boolean;\n\n    private mode = DynamicMode.STOP;\n    private speed = 0;\n    private speedMult = 0;\n    private currentSpeed = 0;\n    private target = 0;\n    private __current = 0;\n\n    get current(): number {\n        return this.__current;\n    }\n\n    private set current(current: number) {\n        this.__current = current;\n    }\n\n    constructor(\n        private readonly fn: (val: number) => void,\n        config: {\n            min: number;\n            max: number;\n            defaultValue: number;\n            wrap: boolean;\n        }\n    ) {\n        this.min = config.min;\n        this.max = config.max;\n        this.wrap = config.wrap;\n        this.current = config.defaultValue;\n\n        if (this.wrap && this.min !== 0) {\n            throw new PSVError('invalid config');\n        }\n\n        if (this.fn) {\n            this.fn(this.current);\n        }\n    }\n\n    /**\n     * Changes base speed\n     */\n    setSpeed(speed: number) {\n        this.speed = speed;\n    }\n\n    /**\n     * Defines the target position\n     */\n    goto(position: number, speedMult = 1) {\n        this.mode = DynamicMode.POSITION;\n        this.target = this.wrap ? wrap(position, this.max) : MathUtils.clamp(position, this.min, this.max);\n        this.speedMult = speedMult;\n    }\n\n    /**\n     * Increases/decreases the target position\n     */\n    step(step: number, speedMult = 1) {\n        if (speedMult === 0) {\n            this.setValue(this.current + step);\n        } else {\n            if (this.mode !== DynamicMode.POSITION) {\n                this.target = this.current;\n            }\n            this.goto(this.target + step, speedMult);\n        }\n    }\n\n    /**\n     * Starts infinite movement\n     */\n    roll(invert = false, speedMult = 1) {\n        this.mode = DynamicMode.INFINITE;\n        this.target = invert ? -Infinity : Infinity;\n        this.speedMult = speedMult;\n    }\n\n    /**\n     * Stops movement\n     */\n    stop() {\n        this.mode = DynamicMode.STOP;\n    }\n\n    /**\n     * Defines the current position and immediately stops movement\n     * @param {number} value\n     */\n    setValue(value: number): boolean {\n        this.target = this.wrap ? wrap(value, this.max) : MathUtils.clamp(value, this.min, this.max);\n        this.mode = DynamicMode.STOP;\n        this.currentSpeed = 0;\n        if (this.target !== this.current) {\n            this.current = this.target;\n            if (this.fn) {\n                this.fn(this.current);\n            }\n            return true;\n        }\n        return false;\n    }\n\n    /**\n     * @internal\n     */\n    update(elapsed: number): boolean {\n        // in position mode switch to stop mode when in the decceleration window\n        if (this.mode === DynamicMode.POSITION) {\n            // in loop mode, alter \"current\" to avoid crossing the origin\n            if (this.wrap && Math.abs(this.target - this.current) > this.max / 2) {\n                this.current = this.current < this.target ? this.current + this.max : this.current - this.max;\n            }\n\n            const dstStop = (this.currentSpeed * this.currentSpeed) / (this.speed * this.speedMult * 4);\n            if (Math.abs(this.target - this.current) <= dstStop) {\n                this.mode = DynamicMode.STOP;\n            }\n        }\n\n        // compute speed\n        let targetSpeed = this.mode === DynamicMode.STOP ? 0 : this.speed * this.speedMult;\n        if (this.target < this.current) {\n            targetSpeed = -targetSpeed;\n        }\n        if (this.currentSpeed < targetSpeed) {\n            this.currentSpeed = Math.min(\n                targetSpeed,\n                this.currentSpeed + (elapsed / 1000) * this.speed * this.speedMult * 2\n            );\n        } else if (this.currentSpeed > targetSpeed) {\n            this.currentSpeed = Math.max(\n                targetSpeed,\n                this.currentSpeed - (elapsed / 1000) * this.speed * this.speedMult * 2\n            );\n        }\n\n        // compute new position\n        let next = null;\n        if (this.current > this.target && this.currentSpeed) {\n            next = Math.max(this.target, this.current + (this.currentSpeed * elapsed) / 1000);\n        } else if (this.current < this.target && this.currentSpeed) {\n            next = Math.min(this.target, this.current + (this.currentSpeed * elapsed) / 1000);\n        }\n\n        // apply value\n        if (next !== null) {\n            next = this.wrap ? wrap(next, this.max) : MathUtils.clamp(next, this.min, this.max);\n            if (next !== this.current) {\n                this.current = next;\n                if (this.fn) {\n                    this.fn(this.current);\n                }\n                return true;\n            }\n        }\n\n        return false;\n    }\n}\n","import { Dynamic } from './Dynamic';\n\n/**\n * Wrapper for multiple {@link Dynamic} evolving together\n */\nexport class MultiDynamic<T extends Record<string, Dynamic>> {\n    get current(): Record<keyof T, number> {\n        return Object.entries(this.dynamics).reduce(\n            (values, [name, dynamic]) => {\n                // @ts-ignore\n                values[name] = dynamic.current;\n                return values;\n            },\n            {} as Record<keyof T, number>\n        );\n    }\n\n    constructor(\n        private readonly fn: (val: Record<keyof T, number>) => void,\n        private readonly dynamics: T\n    ) {\n        if (this.fn) {\n            this.fn(this.current);\n        }\n    }\n\n    /**\n     * Changes base speed\n     */\n    setSpeed(speed: number) {\n        for (const d of Object.values(this.dynamics)) {\n            d.setSpeed(speed);\n        }\n    }\n\n    /**\n     * Defines the target positions\n     */\n    goto(positions: Partial<Record<keyof T, number>>, speedMult = 1) {\n        for (const [name, position] of Object.entries(positions)) {\n            this.dynamics[name].goto(position as number, speedMult);\n        }\n    }\n\n    /**\n     * Increase/decrease the target positions\n     */\n    step(steps: Partial<Record<keyof T, number>>, speedMult = 1) {\n        if (speedMult === 0) {\n            this.setValue(\n                Object.keys(steps).reduce(\n                    (values, name: keyof T) => {\n                        values[name] = steps[name] + this.dynamics[name].current;\n                        return values;\n                    },\n                    {} as typeof steps\n                )\n            );\n        } else {\n            for (const [name, step] of Object.entries(steps)) {\n                this.dynamics[name].step(step as number, speedMult);\n            }\n        }\n    }\n\n    /**\n     * Starts infinite movements\n     */\n    roll(rolls: Partial<Record<keyof T, boolean>>, speedMult = 1) {\n        for (const [name, roll] of Object.entries(rolls)) {\n            this.dynamics[name].roll(roll, speedMult);\n        }\n    }\n\n    /**\n     * Stops movements\n     */\n    stop() {\n        for (const d of Object.values(this.dynamics)) {\n            d.stop();\n        }\n    }\n\n    /**\n     * Defines the current positions and immediately stops movements\n     */\n    setValue(values: Partial<Record<keyof T, number>>): boolean {\n        let hasUpdates = false;\n\n        for (const [name, value] of Object.entries(values)) {\n            hasUpdates = this.dynamics[name].setValue(value as number) || hasUpdates;\n        }\n\n        if (hasUpdates && this.fn) {\n            this.fn(this.current);\n        }\n\n        return hasUpdates;\n    }\n\n    /**\n     * @internal\n     */\n    update(elapsed: number): boolean {\n        let hasUpdates = false;\n\n        for (const d of Object.values(this.dynamics)) {\n            hasUpdates = d.update(elapsed) || hasUpdates;\n        }\n\n        if (hasUpdates && this.fn) {\n            this.fn(this.current);\n        }\n\n        return hasUpdates;\n    }\n}\n","/**\n * Helper for pressable things (buttons, keyboard)\n * @description When the pressed thing goes up and was not pressed long enough, wait a bit more before execution\n * @internal\n */\nexport class PressHandler {\n    private time = 0;\n    private timeout: ReturnType<typeof setTimeout>;\n\n    get pending() {\n        return this.time !== 0;\n    }\n\n    constructor(private readonly delay = 200) {\n        this.delay = delay;\n    }\n\n    down() {\n        if (this.timeout) {\n            clearTimeout(this.timeout);\n            this.timeout = undefined;\n        }\n\n        this.time = new Date().getTime();\n    }\n\n    up(cb: () => void) {\n        if (!this.time) {\n            return;\n        }\n\n        const elapsed = Date.now() - this.time;\n        if (elapsed < this.delay) {\n            this.timeout = setTimeout(() => {\n                cb();\n                this.timeout = undefined;\n                this.time = 0;\n            }, this.delay);\n        } else {\n            cb();\n            this.time = 0;\n        }\n    }\n}\n","/**\n * Direction of a {@link Slider}\n */\nexport enum SliderDirection {\n    VERTICAL = 'VERTICAL',\n    HORIZONTAL = 'HORIZONTAL',\n}\n\n/**\n * Data transmitted to the {@link Slider} listener\n */\nexport type SliderUpdateData = {\n    /**\n     * slider progression for 0-1\n     */\n    readonly value: number;\n\n    /**\n     * the user clicked on the slider\n     */\n    readonly click: boolean;\n\n    /**\n     * the user moves the cursor above the slider, without click\n     */\n    readonly mouseover: boolean;\n\n    /**\n     * the user moves the cursor above the slider while maintaining click\n     */\n    readonly mousedown: boolean;\n\n    /**\n     * the cursor position on the page\n     */\n    readonly cursor: { clientX: number; clientY: number };\n};\n\n/**\n * Helper to make sliders elements\n */\nexport class Slider {\n    private mousedown = false;\n    private mouseover = false;\n\n    get isVertical() {\n        return this.direction === SliderDirection.VERTICAL;\n    }\n\n    get isHorizontal() {\n        return this.direction === SliderDirection.HORIZONTAL;\n    }\n\n    constructor(\n        /** main container of the sliding element */\n        private readonly container: HTMLElement,\n        /** direction of the slider */\n        private readonly direction: SliderDirection,\n        /** callback when the user interacts with the slider */\n        private readonly listener: (data: SliderUpdateData) => void\n    ) {\n        this.container.addEventListener('click', this);\n        this.container.addEventListener('mousedown', this);\n        this.container.addEventListener('mouseenter', this);\n        this.container.addEventListener('mouseleave', this);\n        this.container.addEventListener('touchstart', this);\n        this.container.addEventListener('mousemove', this, true);\n        this.container.addEventListener('touchmove', this, true);\n        window.addEventListener('mouseup', this);\n        window.addEventListener('touchend', this);\n    }\n\n    destroy() {\n        window.removeEventListener('mouseup', this);\n        window.removeEventListener('touchend', this);\n    }\n\n    /**\n     * @internal\n     */\n    handleEvent(e: Event) {\n        // prettier-ignore\n        switch (e.type) {\n            case 'click': e.stopPropagation(); break;\n            case 'mousedown': this.__onMouseDown(e as MouseEvent); break;\n            case 'mouseenter': this.__onMouseEnter(e as MouseEvent); break;\n            case 'mouseleave': this.__onMouseLeave(e as MouseEvent); break;\n            case 'touchstart': this.__onTouchStart(e as TouchEvent); break;\n            case 'mousemove': this.__onMouseMove(e as MouseEvent); break;\n            case 'touchmove': this.__onTouchMove(e as TouchEvent); break;\n            case 'mouseup': this.__onMouseUp(e as MouseEvent); break;\n            case 'touchend': this.__onTouchEnd(e as TouchEvent); break;\n        }\n    }\n\n    private __onMouseDown(evt: MouseEvent) {\n        this.mousedown = true;\n        this.__update(evt.clientX, evt.clientY, true);\n    }\n\n    private __onMouseEnter(evt: MouseEvent) {\n        this.mouseover = true;\n        this.__update(evt.clientX, evt.clientY, true);\n    }\n\n    private __onTouchStart(evt: TouchEvent) {\n        this.mouseover = true;\n        this.mousedown = true;\n        const touch = evt.changedTouches[0];\n        this.__update(touch.clientX, touch.clientY, true);\n    }\n\n    private __onMouseMove(evt: MouseEvent) {\n        if (this.mousedown || this.mouseover) {\n            evt.stopPropagation();\n            this.__update(evt.clientX, evt.clientY, true);\n        }\n    }\n\n    private __onTouchMove(evt: TouchEvent) {\n        if (this.mousedown || this.mouseover) {\n            evt.stopPropagation();\n            const touch = evt.changedTouches[0];\n            this.__update(touch.clientX, touch.clientY, true);\n        }\n    }\n\n    private __onMouseUp(evt: MouseEvent) {\n        if (this.mousedown) {\n            this.mousedown = false;\n            this.__update(evt.clientX, evt.clientY, false);\n        }\n    }\n\n    private __onMouseLeave(evt: MouseEvent) {\n        if (this.mouseover) {\n            this.mouseover = false;\n            this.__update(evt.clientX, evt.clientY, true);\n        }\n    }\n\n    private __onTouchEnd(evt: TouchEvent) {\n        if (this.mousedown) {\n            this.mouseover = false;\n            this.mousedown = false;\n            const touch = evt.changedTouches[0];\n            this.__update(touch.clientX, touch.clientY, false);\n        }\n    }\n\n    private __update(clientX: number, clientY: number, moving: boolean) {\n        const boundingClientRect = this.container.getBoundingClientRect();\n        const cursor = this.isVertical ? clientY : clientX;\n        const pos = boundingClientRect[this.isVertical ? 'bottom' : 'left'];\n        const size = boundingClientRect[this.isVertical ? 'height' : 'width'];\n        const val = Math.abs((pos - cursor) / size);\n\n        this.listener({\n            value: val,\n            click: !moving,\n            mousedown: this.mousedown,\n            mouseover: this.mouseover,\n            cursor: { clientX, clientY },\n        });\n    }\n}\n","import { Mesh } from 'three';\nimport { Tooltip, TooltipConfig } from './components/Tooltip';\nimport { TypedEvent } from './lib/TypedEventTarget';\nimport { ClickData, Point, Position, Size, TextureData, ViewerConfig } from './model';\nimport type { Viewer } from './Viewer';\n\n/**\n * Base class for all events dispatched by {@link Viewer}\n */\nexport abstract class ViewerEvent extends TypedEvent<Viewer> {}\n\n/**\n * @event Triggered before an animation, can be cancelled\n */\nexport class BeforeAnimateEvent extends ViewerEvent {\n    static override readonly type = 'before-animate';\n    override type: 'before-animate';\n\n    /** @internal */\n    constructor(\n        /** target position, can be modified */\n        public position?: Position,\n        /** target zoom level, can be modified */\n        public zoomLevel?: number\n    ) {\n        super(BeforeAnimateEvent.type, true);\n    }\n}\n\n/**\n * @event Triggered before a render\n */\nexport class BeforeRenderEvent extends ViewerEvent {\n    static override readonly type = 'before-render';\n    override type: 'before-render';\n\n    /** @internal */\n    constructor(\n        /** time provided by requestAnimationFrame */\n        public readonly timestamp: number,\n        /**  time elapsed since the previous frame */\n        public readonly elapsed: number\n    ) {\n        super(BeforeRenderEvent.type);\n    }\n}\n\n/**\n * @event Triggered before a rotate operation, can be cancelled\n */\nexport class BeforeRotateEvent extends ViewerEvent {\n    static override readonly type = 'before-rotate';\n    override type: 'before-rotate';\n\n    /** @internal */\n    constructor(\n        /** target position, can be modified */\n        public position: Position\n    ) {\n        super(BeforeRotateEvent.type, true);\n    }\n}\n\n/**\n * @event Triggered when the user clicks on the viewer (everywhere excluding the navbar and the side panel)\n */\nexport class ClickEvent extends ViewerEvent {\n    static override readonly type = 'click';\n    override type: 'click';\n\n    /** @internal */\n    constructor(public readonly data: ClickData) {\n        super(ClickEvent.type);\n    }\n}\n\n/**\n * @event Triggered when some options are changed\n */\nexport class ConfigChangedEvent extends ViewerEvent {\n    static override readonly type = 'config-changed';\n    override type: 'config-changed';\n\n    /** @internal */\n    constructor(public readonly options: Array<keyof ViewerConfig>) {\n        super(ConfigChangedEvent.type);\n    }\n\n    /**\n     * Checks if at least one of the `options` has been modified\n     */\n    containsOptions(...options: Array<keyof ViewerConfig>): boolean {\n        return options.some((option) => this.options.includes(option));\n    }\n}\n\n/**\n * @event Triggered when the user double clicks on the viewer. The simple `click` event is always fired before `dblclick`.\n */\nexport class DoubleClickEvent extends ViewerEvent {\n    static override readonly type = 'dblclick';\n    override type: 'dblclick';\n\n    /** @internal */\n    constructor(public readonly data: ClickData) {\n        super(DoubleClickEvent.type);\n    }\n}\n\n/**\n * @event Triggered when the fullscreen is enabled/disabled\n */\nexport class FullscreenEvent extends ViewerEvent {\n    static override readonly type = 'fullscreen';\n    override type: 'fullscreen';\n\n    /** @internal */\n    constructor(public readonly fullscreenEnabled: boolean) {\n        super(FullscreenEvent.type);\n    }\n}\n\n/**\n * @event Triggered when the notification is hidden\n */\nexport class HideNotificationEvent extends ViewerEvent {\n    static override readonly type = 'hide-notification';\n    override type: 'hide-notification';\n\n    /** @internal */\n    constructor(public readonly notificationId?: string) {\n        super(HideNotificationEvent.type);\n    }\n}\n\n/**\n * @event Triggered when the overlay is hidden\n */\nexport class HideOverlayEvent extends ViewerEvent {\n    static override readonly type = 'hide-overlay';\n    override type: 'hide-overlay';\n\n    /** @internal */\n    constructor(public readonly overlayId?: string) {\n        super(HideOverlayEvent.type);\n    }\n}\n\n/**\n * @event Triggered when the panel is hidden\n */\nexport class HidePanelEvent extends ViewerEvent {\n    static override readonly type = 'hide-panel';\n    override type: 'hide-panel';\n\n    /** @internal */\n    constructor(public readonly panelId?: string) {\n        super(HidePanelEvent.type);\n    }\n}\n\n/**\n * @event Triggered when a tooltip is hidden\n */\nexport class HideTooltipEvent extends ViewerEvent {\n    static override readonly type = 'hide-tooltip';\n    override type: 'hide-tooltip';\n\n    /** @internal */\n    constructor(\n        /** Userdata associated to the tooltip */\n        public readonly tooltipData: TooltipConfig['data']\n    ) {\n        super(HideTooltipEvent.type);\n    }\n}\n\n/**\n * @event Triggered when a key is pressed, can be cancelled\n */\nexport class KeypressEvent extends ViewerEvent {\n    static override readonly type = 'key-press';\n    override type: 'key-press';\n\n    /** @internal */\n    constructor(public readonly key: string) {\n        super(KeypressEvent.type, true);\n    }\n}\n\n/**\n * @event Triggered when the loader value changes\n */\nexport class LoadProgressEvent extends ViewerEvent {\n    static override readonly type = 'load-progress';\n    override type: 'load-progress';\n\n    /** @internal */\n    constructor(public readonly progress: number) {\n        super(LoadProgressEvent.type);\n    }\n}\n\n/**\n * @event Triggered when a panorama image starts loading\n */\nexport class PanoramaLoadEvent extends ViewerEvent {\n    static override readonly type = 'panorama-load';\n    override type: 'panorama-load';\n\n    /** @internal */\n    constructor(public readonly panorama: any) {\n        super(PanoramaLoadEvent.type);\n    }\n}\n\n/**\n * @event Triggered when a panorama image has been loaded\n */\nexport class PanoramaLoadedEvent extends ViewerEvent {\n    static override readonly type = 'panorama-loaded';\n    override type: 'panorama-loaded';\n\n    /** @internal */\n    constructor(public readonly data: TextureData) {\n        super(PanoramaLoadedEvent.type);\n    }\n}\n\n/**\n * @event Triggered when an error occured when loading the panorama\n */\nexport class PanoramaErrorEvent extends ViewerEvent {\n    static override readonly type = 'panorama-error';\n    override type: 'panorama-error';\n\n    /** @internal */\n    constructor(\n        public readonly panorama: any,\n        public readonly error: Error\n    ) {\n        super(PanoramaErrorEvent.type);\n    }\n}\n\n/**\n * @event Triggered when the view angles change\n */\nexport class PositionUpdatedEvent extends ViewerEvent {\n    static override readonly type = 'position-updated';\n    override type: 'position-updated';\n\n    /** @internal */\n    constructor(public readonly position: Position) {\n        super(PositionUpdatedEvent.type);\n    }\n}\n\n/**\n * @event Triggered when camera roll change\n */\nexport class RollUpdatedEvent extends ViewerEvent {\n    static override readonly type = 'roll-updated';\n    override type: 'roll-updated';\n\n    /** @internal */\n    constructor(public readonly roll: number) {\n        super(RollUpdatedEvent.type);\n    }\n}\n\n/**\n * @event Triggered when the panorama image has been loaded and the viewer is ready to perform the first render\n */\nexport class ReadyEvent extends ViewerEvent {\n    static override readonly type = 'ready';\n    override type: 'ready';\n\n    /** @internal */\n    constructor() {\n        super(ReadyEvent.type);\n    }\n}\n\n/**\n * @event Triggered on each viewer render\n */\nexport class RenderEvent extends ViewerEvent {\n    static override readonly type = 'render';\n    override type: 'render';\n\n    /** @internal */\n    constructor() {\n        super(RenderEvent.type);\n    }\n}\n\n/**\n * @event Triggered when the notification is shown\n */\nexport class ShowNotificationEvent extends ViewerEvent {\n    static override readonly type = 'show-notification';\n    override type: 'show-notification';\n\n    /** @internal */\n    constructor(public readonly notificationId?: string) {\n        super(ShowNotificationEvent.type);\n    }\n}\n\n/**\n * @event Triggered when the overlay is shown\n */\nexport class ShowOverlayEvent extends ViewerEvent {\n    static override readonly type = 'show-overlay';\n    override type: 'show-overlay';\n\n    /** @internal */\n    constructor(public readonly overlayId?: string) {\n        super(ShowOverlayEvent.type);\n    }\n}\n\n/**\n * @event Triggered when the panel is shown\n */\nexport class ShowPanelEvent extends ViewerEvent {\n    static override readonly type = 'show-panel';\n    override type: 'show-panel';\n\n    /** @internal */\n    constructor(public readonly panelId?: string) {\n        super(ShowPanelEvent.type);\n    }\n}\n\n/**\n * @event Triggered when a tooltip is shown\n */\nexport class ShowTooltipEvent extends ViewerEvent {\n    static override readonly type = 'show-tooltip';\n    override type: 'show-tooltip';\n\n    /** @internal */\n    constructor(\n        /** Instance of the tooltip */\n        public readonly tooltip: Tooltip,\n        /** Userdata associated to the tooltip */\n        public readonly tooltipData?: TooltipConfig['data']\n    ) {\n        super(ShowTooltipEvent.type);\n    }\n}\n\n/**\n * @event Triggered when the viewer size changes\n */\nexport class SizeUpdatedEvent extends ViewerEvent {\n    static override readonly type = 'size-updated';\n    override type: 'size-updated';\n\n    /** @internal */\n    constructor(public readonly size: Size) {\n        super(SizeUpdatedEvent.type);\n    }\n}\n\n/**\n * @event Triggered when all current animations are stopped\n */\nexport class StopAllEvent extends ViewerEvent {\n    static override readonly type = 'stop-all';\n    override type: 'stop-all';\n\n    /** @internal */\n    constructor() {\n        super(StopAllEvent.type);\n    }\n}\n\n/**\n * @event Triggered when the viewer zoom changes\n */\nexport class ZoomUpdatedEvent extends ViewerEvent {\n    static override readonly type = 'zoom-updated';\n    override type: 'zoom-updated';\n\n    /** @internal */\n    constructor(public readonly zoomLevel: number) {\n        super(ZoomUpdatedEvent.type);\n    }\n}\n\n/**\n * Base class for events on three.js objects\n *\n * Note: {@link Viewer#observeObjects} must be called for these events to be dispatched\n */\nexport abstract class ObjectEvent extends ViewerEvent {\n    /** @internal */\n    constructor(\n        type: string,\n        public readonly originalEvent: MouseEvent,\n        public readonly object: Mesh<any, any>,\n        public readonly viewerPoint: Point,\n        public readonly userDataKey: string\n    ) {\n        super(type);\n    }\n}\n\n/**\n * @event Triggered when the cursor enters an object in the scene\n *\n * Note: {@link Viewer#observeObjects} must be called for this event to be dispatched\n */\nexport class ObjectEnterEvent extends ObjectEvent {\n    static override readonly type = 'enter-object';\n    override type: 'enter-object';\n\n    /** @internal */\n    constructor(originalEvent: MouseEvent, object: Mesh, viewerPoint: Point, userDataKey: string) {\n        super(ObjectEnterEvent.type, originalEvent, object, viewerPoint, userDataKey);\n    }\n}\n\n/**\n * @event Triggered when the cursor leaves an object in the scene\n *\n * Note: {@link Viewer#observeObjects} must be called for this event to be dispatched\n */\nexport class ObjectLeaveEvent extends ObjectEvent {\n    static override readonly type = 'leave-object';\n    override type: 'leave-object';\n\n    /** @internal */\n    constructor(originalEvent: MouseEvent, object: Mesh, viewerPoint: Point, userDataKey: string) {\n        super(ObjectLeaveEvent.type, originalEvent, object, viewerPoint, userDataKey);\n    }\n}\n\n/**\n * @event Triggered when the cursor moves over an object in the scene\n *\n * Note: {@link Viewer#observeObjects} must be called for this event to be dispatched\n */\nexport class ObjectHoverEvent extends ObjectEvent {\n    static override readonly type = 'hover-object';\n    override type: 'hover-object';\n\n    /** @internal */\n    constructor(originalEvent: MouseEvent, object: Mesh, viewerPoint: Point, userDataKey: string) {\n        super(ObjectHoverEvent.type, originalEvent, object, viewerPoint, userDataKey);\n    }\n}\n\nexport type ViewerEvents =\n    | BeforeAnimateEvent\n    | BeforeRenderEvent\n    | BeforeRotateEvent\n    | ClickEvent\n    | ConfigChangedEvent\n    | DoubleClickEvent\n    | FullscreenEvent\n    | HideNotificationEvent\n    | HideOverlayEvent\n    | HidePanelEvent\n    | HideTooltipEvent\n    | KeypressEvent\n    | LoadProgressEvent\n    | PanoramaLoadEvent\n    | PanoramaLoadedEvent\n    | PanoramaErrorEvent\n    | PositionUpdatedEvent\n    | RollUpdatedEvent\n    | ReadyEvent\n    | RenderEvent\n    | ShowNotificationEvent\n    | ShowOverlayEvent\n    | ShowPanelEvent\n    | ShowTooltipEvent\n    | SizeUpdatedEvent\n    | StopAllEvent\n    | ZoomUpdatedEvent\n    | ObjectEnterEvent\n    | ObjectLeaveEvent\n    | ObjectHoverEvent;\n","/**\n * Base class for events dispatched by {@link TypedEventTarget}\n * @template TTarget type of the event target\n */\nexport abstract class TypedEvent<TTarget extends TypedEventTarget<any>> extends Event {\n    static readonly type: string;\n\n    override target: TTarget;\n\n    constructor(type: string, cancelable = false) {\n        super(type, { cancelable });\n    }\n}\n\n/**\n * Decorator for EventTarget allowing to strongly type events and listeners\n * @link https://rjzaworski.com/2021/06/event-target-with-typescript\n * @template TEvents union of dispatched events\n */\nexport class TypedEventTarget<TEvents extends TypedEvent<any>> extends EventTarget {\n    override dispatchEvent(e: TEvents): boolean {\n        return super.dispatchEvent(e);\n    }\n\n    /**\n     * @template T the name of event\n     * @template E the class of the event\n     */\n    override addEventListener<T extends TEvents['type'], E extends TEvents & { type: T }>(\n        type: T,\n        callback: ((e: E) => void) | EventListenerObject | null,\n        options?: AddEventListenerOptions | boolean\n    ) {\n        super.addEventListener(type, callback as any, options);\n    }\n\n    /**\n     * @template T the name of event\n     * @template E the class of the event\n     */\n    override removeEventListener<T extends TEvents['type'], E extends TEvents & { type: T }>(\n        type: TEvents['type'],\n        callback: ((e: E) => void) | EventListenerObject | null,\n        options?: EventListenerOptions | boolean\n    ) {\n        super.removeEventListener(type, callback as any, options);\n    }\n}\n","import { Mesh } from 'three';\nimport { PSVError } from '../PSVError';\nimport type { Viewer } from '../Viewer';\nimport { PanoData, PanoDataProvider, PanoramaPosition, Position, TextureData } from '../model';\nimport { checkVersion } from '../utils';\n\n/**\n * Base class for adapters\n * @template TPanorama type of the panorama object\n * @template TTexture type of the loaded texture\n * @template TData type of the panorama metadata\n */\nexport abstract class AbstractAdapter<TPanorama, TTexture, TData> {\n    /**\n     * Unique identifier of the adapter\n     */\n    static readonly id: string;\n    /**\n     * Expected version of the core\n     * DO NOT USE on custom adapters\n     */\n    static readonly VERSION: string;\n\n    /**\n     * Indicates if the adapter supports panorama download natively\n     */\n    static readonly supportsDownload: boolean = false;\n\n    constructor(protected readonly viewer: Viewer) {}\n\n    /**\n     * Initializes the adapter\n     */\n    // eslint-disable-next-line @typescript-eslint/no-empty-function\n    init(): void {}\n\n    /**\n     * Destroys the adapter\n     */\n    // eslint-disable-next-line @typescript-eslint/no-empty-function\n    destroy(): void {}\n\n    /**\n     * Indicates if the adapter supports transitions between panoramas\n     */\n    // @ts-ignore unused parameter\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    supportsTransition(panorama: TPanorama): boolean {\n        return false;\n    }\n\n    /**\n     * Indicates if the adapter supports preload of a panorama\n     */\n    // @ts-ignore unused parameter\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    supportsPreload(panorama: TPanorama): boolean {\n        return false;\n    }\n\n    /**\n     * Converts pixel texture coordinates to spherical radians coordinates\n     * @throws {@link PSVError} when the current adapter does not support texture coordinates\n     */\n    // @ts-ignore unused parameter\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    textureCoordsToSphericalCoords(point: PanoramaPosition, data: TData): Position {\n        throw new PSVError('Current adapter does not support texture coordinates.');\n    }\n\n    /**\n     * Converts spherical radians coordinates to pixel texture coordinates\n     * @throws {@link PSVError} when the current adapter does not support texture coordinates\n     */\n    // @ts-ignore unused parameter\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    sphericalCoordsToTextureCoords(position: Position, data: TData): PanoramaPosition {\n        throw new PSVError('Current adapter does not support texture coordinates.');\n    }\n\n    /**\n     * Loads the panorama texture\n     */\n    abstract loadTexture(\n        panorama: TPanorama,\n        loader?: boolean,\n        newPanoData?: PanoData | PanoDataProvider,\n        useXmpPanoData?: boolean\n    ): Promise<TextureData<TTexture, TPanorama, TData>>;\n\n    /**\n     * Creates the mesh\n     */\n    abstract createMesh(scale?: number): Mesh;\n\n    /**\n     * Applies the texture to the mesh\n     */\n    abstract setTexture(mesh: Mesh, textureData: TextureData<TTexture, TPanorama, TData>, transition?: boolean): void;\n\n    /**\n     * Changes the opacity of the mesh\n     */\n    abstract setTextureOpacity(mesh: Mesh, opacity: number): void;\n\n    /**\n     * Clear a loaded texture from memory\n     */\n    abstract disposeTexture(textureData: TextureData<TTexture, TPanorama, TData>): void;\n}\n\n// prettier-ignore\nexport type AdapterConstructor = (new (viewer: Viewer, config?: any) => AbstractAdapter<any, any, any>);\n\n/**\n * Returns the adapter constructor from the imported object\n * @internal\n */\nexport function adapterInterop(adapter: any): AdapterConstructor & typeof AbstractAdapter {\n    if (adapter) {\n        for (const [, p] of [['_', adapter], ...Object.entries(adapter)]) {\n            if (p.prototype instanceof AbstractAdapter) {\n                checkVersion(p.id, p.VERSION, PKG_VERSION);\n                return p;\n            }\n        }\n    }\n    return null;\n}\n","import { BufferGeometry, Material, MathUtils, Mesh, MeshBasicMaterial, SphereGeometry, Texture } from 'three';\nimport { PSVError } from '../PSVError';\nimport type { Viewer } from '../Viewer';\nimport { SPHERE_RADIUS } from '../data/constants';\nimport { SYSTEM } from '../data/system';\nimport { PanoData, PanoDataProvider, PanoramaPosition, Position, TextureData } from '../model';\nimport { createTexture, firstNonNull, getConfigParser, getXMPValue, isNil, logWarn } from '../utils';\nimport { AbstractAdapter } from './AbstractAdapter';\nimport { interpolationWorkerSrc } from './interpolationWorker';\n\n/**\n * Configuration for {@link EquirectangularAdapter}\n */\nexport type EquirectangularAdapterConfig = {\n    /**\n     * Background color of the canvas, which will be visible when using cropped panoramas\n     * @default '#000'\n     */\n    backgroundColor?: string;\n    /**\n     * Interpolate the missing parts of cropped panoramas (async)\n     */\n    interpolateBackground?: boolean;\n    /**\n     * number of faces of the sphere geometry, higher values may decrease performances\n     * @default 64\n     */\n    resolution?: number;\n    /**\n     * read real image size from XMP data\n     * @default true\n     */\n    useXmpData?: boolean;\n    /**\n     * used for equirectangular tiles adapter\n     * @internal\n     */\n    blur?: boolean;\n};\n\ntype EquirectangularMesh = Mesh<BufferGeometry, Material>;\ntype EquirectangularTexture = TextureData<Texture, string, PanoData>;\n\nconst getConfig = getConfigParser<EquirectangularAdapterConfig>(\n    {\n        backgroundColor: '#000',\n        interpolateBackground: false,\n        resolution: 64,\n        useXmpData: true,\n        blur: false,\n    },\n    {\n        resolution: (resolution) => {\n            if (!resolution || !MathUtils.isPowerOfTwo(resolution)) {\n                throw new PSVError('EquirectangularAdapter resolution must be power of two');\n            }\n            return resolution;\n        },\n    }\n);\n\n/**\n * Adapter for equirectangular panoramas\n */\nexport class EquirectangularAdapter extends AbstractAdapter<string, Texture, PanoData> {\n    static override readonly id: string = 'equirectangular';\n    static override readonly VERSION = PKG_VERSION;\n    static override readonly supportsDownload: boolean = true;\n\n    private readonly config: EquirectangularAdapterConfig;\n\n    private interpolationWorker: Worker;\n\n    readonly SPHERE_SEGMENTS: number;\n    readonly SPHERE_HORIZONTAL_SEGMENTS: number;\n\n    constructor(viewer: Viewer, config?: EquirectangularAdapterConfig) {\n        super(viewer);\n\n        this.config = getConfig(config);\n\n        if (this.config.interpolateBackground) {\n            if (!window.Worker) {\n                logWarn('Web Worker API not available');\n                this.config.interpolateBackground = false;\n            } else {\n                this.interpolationWorker = new Worker(interpolationWorkerSrc);\n            }\n        }\n\n        this.SPHERE_SEGMENTS = this.config.resolution;\n        this.SPHERE_HORIZONTAL_SEGMENTS = this.SPHERE_SEGMENTS / 2;\n    }\n\n    override supportsTransition() {\n        return true;\n    }\n\n    override supportsPreload() {\n        return true;\n    }\n\n    override destroy(): void {\n        this.interpolationWorker?.terminate();\n\n        super.destroy();\n    }\n\n    override textureCoordsToSphericalCoords(point: PanoramaPosition, data: PanoData): Position {\n        if (isNil(point.textureX) || isNil(point.textureY)) {\n            throw new PSVError(`Texture position is missing 'textureX' or 'textureY'`);\n        }\n\n        const relativeX = ((point.textureX + data.croppedX) / data.fullWidth) * Math.PI * 2;\n        const relativeY = ((point.textureY + data.croppedY) / data.fullHeight) * Math.PI;\n\n        return {\n            yaw: relativeX >= Math.PI ? relativeX - Math.PI : relativeX + Math.PI,\n            pitch: Math.PI / 2 - relativeY,\n        };\n    }\n\n    override sphericalCoordsToTextureCoords(position: Position, data: PanoData): PanoramaPosition {\n        const relativeLong = (position.yaw / Math.PI / 2) * data.fullWidth;\n        const relativeLat = (position.pitch / Math.PI) * data.fullHeight;\n\n        return {\n            textureX:\n                Math.round(\n                    position.yaw < Math.PI ? relativeLong + data.fullWidth / 2 : relativeLong - data.fullWidth / 2\n                ) - data.croppedX,\n            textureY: Math.round(data.fullHeight / 2 - relativeLat) - data.croppedY,\n        };\n    }\n\n    async loadTexture(\n        panorama: string,\n        loader = true,\n        newPanoData?: PanoData | PanoDataProvider,\n        useXmpPanoData = this.config.useXmpData\n    ): Promise<EquirectangularTexture> {\n        if (typeof panorama !== 'string') {\n            return Promise.reject(new PSVError('Invalid panorama url, are you using the right adapter?'));\n        }\n\n        const blob = await this.viewer.textureLoader.loadFile(\n            panorama,\n            loader ? (p) => this.viewer.loader.setProgress(p) : null,\n            panorama\n        );\n        const xmpPanoData = useXmpPanoData ? await this.loadXMP(blob) : null;\n        const img = await this.viewer.textureLoader.blobToImage(blob);\n\n        if (typeof newPanoData === 'function') {\n            newPanoData = newPanoData(img, xmpPanoData);\n        }\n        if (!newPanoData && !xmpPanoData) {\n            newPanoData = this.__defaultPanoData(img);\n        }\n\n        const panoData: PanoData = {\n            isEquirectangular: true,\n            fullWidth: firstNonNull(newPanoData?.fullWidth, xmpPanoData?.fullWidth, img.width),\n            fullHeight: firstNonNull(newPanoData?.fullHeight, xmpPanoData?.fullHeight, img.height),\n            croppedWidth: firstNonNull(newPanoData?.croppedWidth, xmpPanoData?.croppedWidth, img.width),\n            croppedHeight: firstNonNull(newPanoData?.croppedHeight, xmpPanoData?.croppedHeight, img.height),\n            croppedX: firstNonNull(newPanoData?.croppedX, xmpPanoData?.croppedX, 0),\n            croppedY: firstNonNull(newPanoData?.croppedY, xmpPanoData?.croppedY, 0),\n            poseHeading: firstNonNull(newPanoData?.poseHeading, xmpPanoData?.poseHeading, 0),\n            posePitch: firstNonNull(newPanoData?.posePitch, xmpPanoData?.posePitch, 0),\n            poseRoll: firstNonNull(newPanoData?.poseRoll, xmpPanoData?.poseRoll, 0),\n        };\n\n        if (panoData.croppedWidth !== img.width || panoData.croppedHeight !== img.height) {\n            logWarn(`Invalid panoData, croppedWidth/croppedHeight is not coherent with the loaded image.\n            panoData: ${panoData.croppedWidth}x${panoData.croppedHeight}, image: ${img.width}x${img.height}`);\n        }\n        if (Math.abs(panoData.fullWidth - panoData.fullHeight * 2) > 1) {\n            logWarn('Invalid panoData, fullWidth should be twice fullHeight');\n            panoData.fullWidth = panoData.fullHeight * 2;\n        }\n        if (panoData.croppedX + panoData.croppedWidth > panoData.fullWidth) {\n            logWarn('Invalid panoData, croppedX + croppedWidth > fullWidth');\n            panoData.croppedX = panoData.fullWidth - panoData.croppedWidth;\n        }\n        if (panoData.croppedY + panoData.croppedHeight > panoData.fullHeight) {\n            logWarn('Invalid panoData, croppedY + croppedHeight > fullHeight');\n            panoData.croppedY = panoData.fullHeight - panoData.croppedHeight;\n        }\n\n        const texture = this.createEquirectangularTexture(img, panoData);\n\n        return {\n            panorama,\n            texture,\n            panoData,\n            cacheKey: panorama,\n        };\n    }\n\n    /**\n     * Loads the XMP data of an image\n     */\n    private async loadXMP(blob: Blob): Promise<PanoData> {\n        const binary = await this.loadBlobAsString(blob);\n\n        const a = binary.indexOf('<x:xmpmeta');\n        const b = binary.indexOf('</x:xmpmeta>');\n        const data = binary.substring(a, b);\n\n        if (a !== -1 && b !== -1 && data.includes('GPano:')) {\n            return {\n                isEquirectangular: true,\n                fullWidth: getXMPValue(data, 'FullPanoWidthPixels'),\n                fullHeight: getXMPValue(data, 'FullPanoHeightPixels'),\n                croppedWidth: getXMPValue(data, 'CroppedAreaImageWidthPixels'),\n                croppedHeight: getXMPValue(data, 'CroppedAreaImageHeightPixels'),\n                croppedX: getXMPValue(data, 'CroppedAreaLeftPixels'),\n                croppedY: getXMPValue(data, 'CroppedAreaTopPixels'),\n                poseHeading: getXMPValue(data, 'PoseHeadingDegrees'),\n                posePitch: getXMPValue(data, 'PosePitchDegrees'),\n                poseRoll: getXMPValue(data, 'PoseRollDegrees'),\n            };\n        }\n\n        return null;\n    }\n\n    /**\n     * Reads a Blob as a string\n     */\n    private loadBlobAsString(blob: Blob): Promise<string> {\n        return new Promise((resolve, reject) => {\n            const reader = new FileReader();\n            reader.onload = () => resolve(reader.result as string);\n            reader.onerror = reject;\n            reader.readAsText(blob);\n        });\n    }\n\n    /**\n     * Creates the final texture from image and panorama data\n     */\n    private createEquirectangularTexture(img: HTMLImageElement, panoData: PanoData): Texture {\n        // resize image / fill cropped parts with black\n        if (this.config.blur\n            || panoData.fullWidth > SYSTEM.maxTextureWidth\n            || panoData.croppedWidth !== panoData.fullWidth\n            || panoData.croppedHeight !== panoData.fullHeight\n        ) {\n            const ratio = Math.min(1, SYSTEM.maxCanvasWidth / panoData.fullWidth);\n\n            const resizedPanoData = {\n                fullWidth: panoData.fullWidth * ratio,\n                fullHeight: panoData.fullHeight * ratio,\n                croppedWidth: panoData.croppedWidth * ratio,\n                croppedHeight: panoData.croppedHeight * ratio,\n                croppedX: panoData.croppedX * ratio,\n                croppedY: panoData.croppedY * ratio,\n            };\n\n            const buffer = document.createElement('canvas');\n            buffer.width = resizedPanoData.fullWidth;\n            buffer.height = resizedPanoData.fullHeight;\n\n            const ctx = buffer.getContext('2d');\n\n            if (this.config.backgroundColor) {\n                ctx.fillStyle = this.config.backgroundColor;\n                ctx.fillRect(0, 0, buffer.width, buffer.height);\n            }\n\n            if (this.config.blur) {\n                const blurSize = buffer.width / 2048;\n                const margin = Math.ceil(blurSize * 2);\n\n                // copy edges before applying the blur\n                if (resizedPanoData.croppedWidth === buffer.width) {\n                    ctx.drawImage(\n                        img,\n                        0, 0,\n                        margin / ratio, img.height,\n                        0, resizedPanoData.croppedY,\n                        margin, resizedPanoData.croppedHeight\n                    );\n                    ctx.drawImage(\n                        img,\n                        img.width - margin / ratio, 0,\n                        margin / ratio, img.height,\n                        buffer.width - margin, resizedPanoData.croppedY,\n                        margin, resizedPanoData.croppedHeight\n                    );\n                }\n                if (resizedPanoData.croppedHeight === buffer.height) {\n                    ctx.drawImage(\n                        img,\n                        0, 0,\n                        1, 1,\n                        resizedPanoData.croppedX, 0,\n                        resizedPanoData.croppedWidth, margin\n                    );\n                    ctx.drawImage(\n                        img,\n                        0, img.height - 1,\n                        1, 1,\n                        resizedPanoData.croppedX, buffer.height - margin,\n                        resizedPanoData.croppedWidth, margin\n                    );\n                }\n\n                ctx.filter = `blur(${blurSize }px)`;\n            }\n\n            ctx.drawImage(\n                img,\n                resizedPanoData.croppedX,\n                resizedPanoData.croppedY,\n                resizedPanoData.croppedWidth,\n                resizedPanoData.croppedHeight\n            );\n\n            const t = createTexture(buffer);\n\n            if (this.config.interpolateBackground && (\n                panoData.croppedWidth !== panoData.fullWidth\n                || panoData.croppedHeight !== panoData.fullHeight\n            )) {\n                this.interpolationWorker.postMessage({\n                    image: ctx.getImageData(\n                        resizedPanoData.croppedX,\n                        resizedPanoData.croppedY,\n                        resizedPanoData.croppedWidth,\n                        resizedPanoData.croppedHeight\n                    ),\n                    panoData: resizedPanoData,\n                });\n\n                this.interpolationWorker.onmessage = (e) => {\n                    ctx.putImageData(e.data, 0, 0);\n                    t.needsUpdate = true;\n                    this.viewer.needsUpdate();\n                };\n            }\n\n            return t;\n        }\n\n        return createTexture(img);\n    }\n\n    createMesh(scale = 1): EquirectangularMesh {\n        // The middle of the panorama is placed at yaw=0\n        const geometry = new SphereGeometry(\n            SPHERE_RADIUS * scale,\n            this.SPHERE_SEGMENTS,\n            this.SPHERE_HORIZONTAL_SEGMENTS,\n            -Math.PI / 2\n        ).scale(-1, 1, 1);\n\n        return new Mesh(geometry, new MeshBasicMaterial());\n    }\n\n    setTexture(mesh: EquirectangularMesh, textureData: EquirectangularTexture) {\n        (mesh.material as MeshBasicMaterial).map = textureData.texture;\n    }\n\n    setTextureOpacity(mesh: EquirectangularMesh, opacity: number) {\n        mesh.material.opacity = opacity;\n        mesh.material.transparent = opacity < 1;\n    }\n\n    disposeTexture(textureData: EquirectangularTexture) {\n        textureData.texture?.dispose();\n    }\n\n    private __defaultPanoData(img: HTMLImageElement): PanoData {\n        const fullWidth = Math.max(img.width, img.height * 2);\n        const fullHeight = Math.round(fullWidth / 2);\n        const croppedX = Math.round((fullWidth - img.width) / 2);\n        const croppedY = Math.round((fullHeight - img.height) / 2);\n\n        return {\n            isEquirectangular: true,\n            fullWidth: fullWidth,\n            fullHeight: fullHeight,\n            croppedWidth: img.width,\n            croppedHeight: img.height,\n            croppedX: croppedX,\n            croppedY: croppedY,\n        };\n    }\n}\n","import { ResolvableBoolean } from '../model';\nimport { PSVError } from '../PSVError';\nimport { VIEWER_DATA } from './constants';\n\nconst LOCALSTORAGE_TOUCH_SUPPORT = `${VIEWER_DATA}_touchSupport`;\n\n/**\n * General information about the system\n */\nexport const SYSTEM = {\n    /**\n     * Indicates if the system data has been loaded\n     */\n    loaded: false,\n\n    /**\n     * Device screen pixel ratio\n     */\n    pixelRatio: 1,\n\n    /**\n     * Device supports WebGL\n     */\n    isWebGLSupported: false,\n\n    /**\n     * Maximum WebGL texture width\n     */\n    maxTextureWidth: 0,\n\n    /**\n     * Device supports touch events\n     */\n    isTouchEnabled: null as ResolvableBoolean,\n\n    /**\n     * Name of the fullscreen event\n     */\n    fullscreenEvent: null as string,\n\n    /**\n     * @internal\n     */\n    __maxCanvasWidth: null as number | null,\n\n    /**\n     * Maximum canvas width\n     */\n    get maxCanvasWidth(): number {\n        if (this.__maxCanvasWidth === null) {\n            this.__maxCanvasWidth = getMaxCanvasWidth(this.maxTextureWidth);\n        }\n        return this.__maxCanvasWidth;\n    },\n\n    /**\n     * Loads the system if not already loaded\n     * @internal\n     */\n    load() {\n        if (!this.loaded) {\n            const ctx = getWebGLCtx();\n\n            this.pixelRatio = window.devicePixelRatio || 1;\n            this.isWebGLSupported = ctx !== null;\n            this.maxTextureWidth = ctx ? ctx.getParameter(ctx.MAX_TEXTURE_SIZE) : 0;\n            this.isTouchEnabled = isTouchEnabled();\n            this.fullscreenEvent = getFullscreenEvent();\n            this.loaded = true;\n        }\n\n        if (!SYSTEM.isWebGLSupported) {\n            throw new PSVError('WebGL is not supported.');\n        }\n        if (SYSTEM.maxTextureWidth === 0) {\n            throw new PSVError('Unable to detect system capabilities');\n        }\n    },\n};\n\n/**\n * Tries to return a canvas webgl context\n */\nfunction getWebGLCtx(): WebGLRenderingContext | null {\n    const canvas = document.createElement('canvas');\n    const names = ['webgl2', 'webgl', 'experimental-webgl'];\n    let context = null;\n\n    if (!canvas.getContext) {\n        return null;\n    }\n\n    if (\n        names.some((name) => {\n            try {\n                context = canvas.getContext(name);\n                return context !== null;\n            } catch (e) {\n                return false;\n            }\n        })\n    ) {\n        return context;\n    } else {\n        return null;\n    }\n}\n\n/**\n * Detects if the user is using a touch screen\n */\nfunction isTouchEnabled(): ResolvableBoolean {\n    let initial = 'ontouchstart' in window || navigator.maxTouchPoints > 0;\n    if (LOCALSTORAGE_TOUCH_SUPPORT in localStorage) {\n        initial = localStorage[LOCALSTORAGE_TOUCH_SUPPORT] === 'true';\n    }\n\n    const promise = new Promise<boolean>((resolve) => {\n        const clear = () => {\n            window.removeEventListener('mousedown', listenerMouse);\n            window.removeEventListener('touchstart', listenerTouch);\n            clearTimeout(listenerTimeoutId);\n        };\n\n        const listenerMouse = () => {\n            clear();\n            localStorage[LOCALSTORAGE_TOUCH_SUPPORT] = false;\n            resolve(false);\n        };\n\n        const listenerTouch = () => {\n            clear();\n            localStorage[LOCALSTORAGE_TOUCH_SUPPORT] = true;\n            resolve(true);\n        };\n\n        const listenerTimeout = () => {\n            clear();\n            localStorage[LOCALSTORAGE_TOUCH_SUPPORT] = initial;\n            resolve(initial);\n        };\n\n        window.addEventListener('mousedown', listenerMouse, false);\n        window.addEventListener('touchstart', listenerTouch, false);\n        const listenerTimeoutId = setTimeout(listenerTimeout, 10000);\n    });\n\n    return { initial, promise };\n}\n\n/**\n * Gets max canvas width supported by the browser.\n * We only test powers of 2 and height = width / 2 because that's what we need to generate WebGL textures\n */\nfunction getMaxCanvasWidth(maxWidth: number): number {\n    const canvas = document.createElement('canvas');\n    const ctx = canvas.getContext('2d');\n    canvas.width = maxWidth;\n    canvas.height = maxWidth / 2;\n\n    while (canvas.width > 1024) {\n        ctx.fillStyle = 'white';\n        ctx.fillRect(0, 0, 1, 1);\n\n        try {\n            if (ctx.getImageData(0, 0, 1, 1).data[0] > 0) {\n                return canvas.width;\n            }\n        } catch (e) {\n            // continue\n        }\n\n        canvas.width /= 2;\n        canvas.height /= 2;\n    }\n\n    throw new PSVError('Unable to detect system capabilities');\n}\n\n/**\n * Gets the event name for fullscreen\n */\nfunction getFullscreenEvent(): string {\n    if ('exitFullscreen' in document) {\n        return 'fullscreenchange';\n    }\n    if ('webkitExitFullscreen' in document) {\n        return 'webkitfullscreenchange';\n    }\n    return null;\n}\n","import type { RGB } from 'three';\nimport type { PanoData } from '../model';\n\n/**\n * Web Worker function to interpolate missing parts of cropped panoramas\n * WARNING : this function must be autonomous\n */\nfunction interpolationWorker() {\n    self.onmessage = (e: MessageEvent) => {\n        const panoData: PanoData = e.data.panoData;\n\n        const buffer = new OffscreenCanvas(panoData.fullWidth, panoData.fullHeight);\n        const ctx = buffer.getContext('2d');\n\n        const img = new OffscreenCanvas(panoData.croppedWidth, panoData.croppedHeight);\n        const ctxImg = img.getContext('2d');\n        ctxImg.putImageData(e.data.image, 0, 0);\n\n        autoBackground(buffer, img, panoData);\n\n        postMessage(ctx.getImageData(0, 0, buffer.width, buffer.height));\n    };\n\n    function autoBackground(buffer: OffscreenCanvas, img: OffscreenCanvas, panoData: PanoData) {\n        const croppedY2 = panoData.fullHeight - panoData.croppedHeight - panoData.croppedY;\n        const croppedX2 = panoData.fullWidth - panoData.croppedWidth - panoData.croppedX;\n        const middleY = panoData.croppedY + panoData.croppedHeight / 2;\n\n        const blurSize = buffer.width / 32;\n        const padding = blurSize;\n        const edge = 10;\n        const filter = `blur(${blurSize}px)`;\n\n        const ctx = buffer.getContext('2d');\n\n        // first draw to get the colors\n        ctx.drawImage(\n            img,\n            panoData.croppedX,\n            panoData.croppedY,\n            panoData.croppedWidth,\n            panoData.croppedHeight\n        );\n\n        // top section\n        if (panoData.croppedY > 0) {\n            if (panoData.croppedX > 0 || croppedX2 > 0) {\n                ctx.filter = 'none';\n\n                const colorLeft = getAverageColor(ctx, panoData.croppedX, panoData.croppedY, edge, edge, 2);\n                const colorRight = getAverageColor(ctx, buffer.width - croppedX2 - 11, panoData.croppedY, edge, edge, 2);\n                const colorCenter = averageRgb(colorLeft, colorRight);\n\n                // top-left corner\n                if (panoData.croppedX > 0) {\n                    ctx.fillStyle = createHorizontalGradient(ctx, 0, panoData.croppedX, colorCenter, colorLeft);\n                    ctx.fillRect(-padding, -padding, panoData.croppedX + padding * 2, middleY + padding);\n                }\n\n                // top right corner\n                if (croppedX2 > 0) {\n                    ctx.fillStyle = createHorizontalGradient(ctx, buffer.width - croppedX2, buffer.width, colorRight, colorCenter);\n                    ctx.fillRect(buffer.width - croppedX2 - padding, -padding, croppedX2 + padding * 2, middleY + padding);\n                }\n            }\n\n            ctx.filter = filter;\n\n            // top\n            ctx.drawImage(\n                img,\n                0, 0,\n                img.width, edge,\n                panoData.croppedX, -padding,\n                panoData.croppedWidth, panoData.croppedY + padding * 2\n            );\n\n            // hide to top seam\n            ctx.fillStyle = rgbCss(getAverageColor(ctx, 0, 0, buffer.width, edge, edge));\n            ctx.fillRect(-padding, -padding, buffer.width + padding * 2, padding * 2);\n        }\n\n        // bottom section\n        if (croppedY2 > 0) {\n            if (panoData.croppedX > 0 || croppedX2 > 0) {\n                ctx.filter = 'none';\n\n                const colorLeft = getAverageColor(ctx, panoData.croppedX, buffer.height - croppedY2 - 1 - edge, edge, edge, 2);\n                const colorRight = getAverageColor(ctx, buffer.width - croppedX2 - 1 - edge, buffer.height - croppedY2 - 1 - edge, edge, edge, 2);\n                const colorCenter = averageRgb(colorLeft, colorRight);\n\n                // bottom-left corner\n                if (panoData.croppedX > 0) {\n                    ctx.fillStyle = createHorizontalGradient(ctx, 0, panoData.croppedX, colorCenter, colorLeft);\n                    ctx.fillRect(-padding, middleY, panoData.croppedX + padding * 2, buffer.height - middleY + padding);\n                }\n\n                // bottom-right corner\n                if (croppedX2 > 0) {\n                    ctx.fillStyle = createHorizontalGradient(ctx, buffer.width - croppedX2, buffer.width, colorRight, colorCenter);\n                    ctx.fillRect(buffer.width - croppedX2 - padding, middleY, croppedX2 + padding * 2, buffer.height - middleY + padding);\n                }\n            }\n\n            ctx.filter = filter;\n\n            // bottom\n            ctx.drawImage(\n                img,\n                0, img.height - edge,\n                img.width, edge,\n                panoData.croppedX, buffer.height - croppedY2 - padding,\n                panoData.croppedWidth, croppedY2 + padding * 2\n            );\n\n            // hide the bottom seam\n            ctx.fillStyle = rgbCss(getAverageColor(ctx, 0, buffer.height - 1 - edge, buffer.width, edge, edge));\n            ctx.fillRect(-padding, buffer.height - padding, buffer.width + padding * 2, padding * 2);\n        }\n\n        // left section\n        if (panoData.croppedX > 0) {\n            ctx.filter = filter;\n\n            ctx.drawImage(\n                img,\n                img.width - edge, 0,\n                edge, img.height,\n                -padding, panoData.croppedY,\n                padding * 2, panoData.croppedHeight\n            );\n\n            ctx.drawImage(\n                img,\n                0, 0,\n                edge, img.height,\n                0, panoData.croppedY,\n                panoData.croppedX + padding, panoData.croppedHeight\n            );\n        }\n\n        // right section\n        if (croppedX2 > 0) {\n            ctx.filter = filter;\n\n            ctx.drawImage(\n                img,\n                0, 0,\n                edge, img.height,\n                buffer.width - padding, panoData.croppedY,\n                padding * 2, panoData.croppedHeight\n            );\n\n            ctx.drawImage(\n                img,\n                img.width - edge, 0,\n                edge, img.height,\n                buffer.width - croppedX2 - padding, panoData.croppedY,\n                croppedX2 + padding, panoData.croppedHeight\n            );\n        }\n\n        ctx.filter = 'none';\n\n        // final draw\n        ctx.drawImage(\n            img,\n            panoData.croppedX,\n            panoData.croppedY,\n            panoData.croppedWidth,\n            panoData.croppedHeight\n        );\n    }\n\n    /**\n     * Returns the CSS string for RGB color\n     */\n    function rgbCss(color: RGB): string {\n        return `rgb(${color.r}, ${color.g}, ${color.b})`;\n    }\n\n    /**\n     * Returns the average of two RGB colors\n     */\n    function averageRgb(c1: RGB, c2: RGB): RGB {\n        return {\n            r: Math.round(c1.r / 2 + c2.r / 2),\n            g: Math.round(c1.g / 2 + c2.g / 2),\n            b: Math.round(c1.b / 2 + c2.b / 2),\n        };\n    }\n\n    /**\n     * Creates a simple horizontal gradient\n     */\n    function createHorizontalGradient(\n        ctx: OffscreenCanvasRenderingContext2D,\n        x1: number,\n        x2: number,\n        c1: RGB,\n        c2: RGB\n    ) {\n        const grad = ctx.createLinearGradient(x1, 0, x2, 0);\n        grad.addColorStop(0, rgbCss(c1));\n        grad.addColorStop(1, rgbCss(c2));\n        return grad;\n    }\n\n    /**\n     * Gets the average RGB color of a portion from a canvas element\n     */\n    function getAverageColor(\n        ctx: OffscreenCanvasRenderingContext2D,\n        x: number,\n        y: number,\n        w: number,\n        h: number,\n        every: number\n    ): RGB {\n        every = Math.round(every);\n\n        let r = 0;\n        let g = 0;\n        let b = 0;\n        let count = 0;\n\n        const data = ctx.getImageData(x, y, w, h);\n\n        for (let row = 0; row < h; row += every) {\n            for (let col = 0; col < w; col += every) {\n                const i = 4 * (row * w + col);\n                r += data.data[i];\n                g += data.data[i + 1];\n                b += data.data[i + 2];\n                count++;\n            }\n        }\n\n        r = Math.round(r / count);\n        g = Math.round(g / count);\n        b = Math.round(b / count);\n\n        return { r, g, b };\n    }\n}\n\nexport const interpolationWorkerSrc = URL.createObjectURL(\n    new Blob(['(', interpolationWorker.toString(), ')()'], \n    { type: 'application/javascript' })\n);\n","import type { Viewer } from '../Viewer';\n\n/**\n * Base class for UI components\n */\nexport abstract class AbstractComponent {\n    /**\n     * Reference to main controller\n     */\n    protected readonly viewer: Viewer;\n\n    /**\n     * All child components\n     * @internal\n     */\n    readonly children: AbstractComponent[] = [];\n\n    /**\n     * Container element\n     */\n    readonly container: HTMLDivElement = document.createElement('div');\n\n    /**\n     * Internal properties\n     * @internal\n     */\n    protected readonly state = {\n        visible: true,\n    };\n\n    constructor(\n        protected readonly parent: Viewer | AbstractComponent,\n        config: { className?: string }\n    ) {\n        this.viewer = parent instanceof AbstractComponent ? parent.viewer : parent;\n\n        this.container.className = config.className || '';\n\n        this.parent.children.push(this);\n        this.parent.container.appendChild(this.container);\n    }\n\n    /**\n     * Destroys the component\n     */\n    destroy() {\n        this.parent.container.removeChild(this.container);\n\n        const childIdx = this.parent.children.indexOf(this);\n        if (childIdx !== -1) {\n            this.parent.children.splice(childIdx, 1);\n        }\n\n        this.children.slice().forEach((child) => child.destroy());\n        this.children.length = 0;\n    }\n\n    /**\n     * Displays or hides the component\n     */\n    toggle(visible = !this.isVisible()) {\n        if (!visible) {\n            this.hide();\n        } else {\n            this.show();\n        }\n    }\n\n    /**\n     * Hides the component\n     */\n    // @ts-ignore unused parameter\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    hide(options?: any) {\n        this.container.style.display = 'none';\n        this.state.visible = false;\n    }\n\n    /**\n     * Displays the component\n     */\n    // @ts-ignore unused parameter\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    show(options?: any) {\n        this.container.style.display = '';\n        this.state.visible = true;\n    }\n\n    /**\n     * Checks if the component is visible\n     */\n    isVisible(): boolean {\n        return this.state.visible;\n    }\n}\n","import { AbstractComponent } from '../components/AbstractComponent';\nimport type { Navbar } from '../components/Navbar';\nimport { KEY_CODES } from '../data/constants';\nimport { ResolvableBoolean } from '../model';\nimport { addClasses, getConfigParser, resolveBoolean, toggleClass } from '../utils';\n\n/**\n * Configuration for {@link AbstractButton}\n */\nexport type ButtonConfig = {\n    id?: string;\n    className?: string;\n    title?: string;\n    /**\n     * if the button has an mouse hover effect\n     * @default false\n     */\n    hoverScale?: boolean;\n    /**\n     * if the button can be moved to menu when the navbar is too small\n     * @default false\n     */\n    collapsable?: boolean;\n    /**\n     * if the button is accessible with the keyboard\n     * @default true\n     */\n    tabbable?: boolean;\n    /**\n     * icon of the button\n     */\n    icon?: string;\n    /**\n     * override icon when the button is active\n     */\n    iconActive?: string;\n};\n\nconst getConfig = getConfigParser<ButtonConfig>({\n    id: null,\n    className: null,\n    title: null,\n    hoverScale: false,\n    collapsable: false,\n    tabbable: true,\n    icon: null,\n    iconActive: null,\n});\n\n/**\n * Base class for navbar buttons\n */\nexport abstract class AbstractButton extends AbstractComponent {\n    /**\n     * Unique identifier of the button\n     */\n    static readonly id: string;\n\n    /**\n     * Identifier to declare a group of buttons\n     */\n    static readonly groupId?: string;\n\n    /**\n     * Internal properties\n     */\n    protected override readonly state = {\n        visible: true,\n        enabled: true,\n        supported: true,\n        collapsed: false,\n        active: false,\n        width: 0,\n    };\n\n    protected readonly config: ButtonConfig;\n\n    get id(): string {\n        return this.config.id;\n    }\n\n    get title(): string {\n        return this.container.title;\n    }\n\n    get content(): string {\n        return this.container.innerHTML;\n    }\n\n    get width(): number {\n        return this.state.width;\n    }\n\n    get collapsable(): boolean {\n        return this.config.collapsable;\n    }\n\n    constructor(navbar: Navbar, config: ButtonConfig) {\n        super(navbar, {\n            className: `psv-button ${config.hoverScale ? 'psv-button--hover-scale' : ''} ${config.className || ''}`,\n        });\n\n        this.config = getConfig(config);\n        this.config.id = (this.constructor as typeof AbstractButton).id;\n\n        if (config.icon) {\n            this.__setIcon(config.icon);\n        }\n\n        this.state.width = this.container.offsetWidth;\n\n        if (this.config.title) {\n            this.container.title = this.config.title;\n        } else if (this.id && this.id in this.viewer.config.lang) {\n            this.container.title = (this.viewer.config.lang as any)[this.id];\n        }\n\n        if (config.tabbable) {\n            this.container.tabIndex = 0;\n        }\n\n        this.container.addEventListener('click', (e) => {\n            if (this.state.enabled) {\n                this.onClick();\n            }\n            e.stopPropagation();\n        });\n\n        this.container.addEventListener('keydown', (e) => {\n            if (e.key === KEY_CODES.Enter && this.state.enabled) {\n                this.onClick();\n                e.stopPropagation();\n            }\n        });\n    }\n\n    /**\n     * Action when the button is clicked\n     */\n    abstract onClick(): void;\n\n    override show(refresh = true) {\n        if (!this.isVisible()) {\n            this.state.visible = true;\n            if (!this.state.collapsed) {\n                this.container.style.display = '';\n            }\n            if (refresh) {\n                this.viewer.navbar.autoSize();\n            }\n        }\n    }\n\n    override hide(refresh = true) {\n        if (this.isVisible()) {\n            this.state.visible = false;\n            this.container.style.display = 'none';\n            if (refresh) {\n                this.viewer.navbar.autoSize();\n            }\n        }\n    }\n\n    /**\n     * Hides/shows the button depending of the result of {@link isSupported}\n     * @internal\n     */\n    checkSupported() {\n        resolveBoolean(this.isSupported(), (supported, init) => {\n            if (!this.state) {\n                return; // the component has been destroyed\n            }\n            this.state.supported = supported;\n            if (!init) {\n                this.toggle(supported);\n            } else if (!supported) {\n                this.hide();\n            }\n        });\n    }\n\n    /**\n     * Perform action when the navbar size/content changes\n     * @internal\n     */\n    autoSize() {\n        // nothing\n    }\n\n    /**\n     * Checks if the button can be displayed\n     */\n    isSupported(): boolean | ResolvableBoolean {\n        return true;\n    }\n\n    /**\n     * Changes the active state of the button\n     */\n    toggleActive(active = !this.state.active) {\n        if (active !== this.state.active) {\n            this.state.active = active;\n            toggleClass(this.container, 'psv-button--active', this.state.active);\n\n            if (this.config.iconActive) {\n                this.__setIcon(this.state.active ? this.config.iconActive : this.config.icon);\n            }\n        }\n    }\n\n    /**\n     * Disables the button\n     */\n    disable() {\n        this.container.classList.add('psv-button--disabled');\n        this.state.enabled = false;\n    }\n\n    /**\n     * Enables the button\n     */\n    enable() {\n        this.container.classList.remove('psv-button--disabled');\n        this.state.enabled = true;\n    }\n\n    /**\n     * Collapses the button in the navbar menu\n     */\n    collapse() {\n        this.state.collapsed = true;\n        this.container.style.display = 'none';\n    }\n\n    /**\n     * Uncollapses the button from the navbar menu\n     */\n    uncollapse() {\n        this.state.collapsed = false;\n        if (this.state.visible) {\n            this.container.style.display = '';\n        }\n    }\n\n    private __setIcon(icon: string) {\n        this.container.innerHTML = icon;\n        addClasses(this.container.querySelector('svg'), 'psv-button-svg');\n    }\n}\n\nexport type ButtonConstructor = (new (navbar: Navbar) => AbstractButton) & typeof AbstractButton;\n","import type { Navbar } from '../components/Navbar';\nimport { NavbarCustomButton } from '../model';\nimport { AbstractButton } from './AbstractButton';\n\nexport class CustomButton extends AbstractButton {\n    private readonly customOnClick: NavbarCustomButton['onClick'];\n\n    constructor(navbar: Navbar, config: NavbarCustomButton) {\n        super(navbar, {\n            className: `psv-custom-button ${config.className || ''}`,\n            hoverScale: false,\n            collapsable: config.collapsable !== false,\n            tabbable: config.tabbable !== false,\n            title: config.title,\n        });\n\n        this.customOnClick = config.onClick;\n\n        if (config.id) {\n            this.config.id = config.id;\n        } else {\n            this.config.id = 'psvButton-' + Math.random().toString(36).substring(2);\n        }\n\n        if (config.content) {\n            if (typeof config.content === 'string') {\n                this.container.innerHTML = config.content;\n            } else {\n                this.container.classList.add('psv-custom-button--no-padding');\n                config.content.style.height = '100%';\n                config.content.attachViewer?.(this.viewer);\n                this.container.appendChild(config.content);\n            }\n        }\n\n        this.state.width = this.container.offsetWidth;\n\n        if (config.disabled) {\n            this.disable();\n        }\n\n        if (config.visible === false) {\n            this.hide();\n        }\n    }\n\n    onClick() {\n        this.customOnClick?.(this.viewer);\n    }\n}\n","import type { Navbar } from '../components/Navbar';\nimport { ICONS, IDS } from '../data/constants';\nimport {\n    ConfigChangedEvent,\n    HideNotificationEvent,\n    HidePanelEvent,\n    ShowNotificationEvent,\n    ShowPanelEvent,\n} from '../events';\nimport { AbstractButton } from './AbstractButton';\n\nconst enum DescriptionButtonMode {\n    NONE,\n    NOTIF,\n    PANEL,\n}\n\nexport class DescriptionButton extends AbstractButton {\n    static override readonly id = 'description';\n\n    private mode = DescriptionButtonMode.NONE;\n\n    constructor(navbar: Navbar) {\n        super(navbar, {\n            className: 'psv-description-button',\n            hoverScale: true,\n            collapsable: false,\n            tabbable: true,\n            icon: ICONS.info,\n        });\n\n        this.viewer.addEventListener(HideNotificationEvent.type, this);\n        this.viewer.addEventListener(ShowNotificationEvent.type, this);\n        this.viewer.addEventListener(HidePanelEvent.type, this);\n        this.viewer.addEventListener(ShowPanelEvent.type, this);\n        this.viewer.addEventListener(ConfigChangedEvent.type, this);\n    }\n\n    override destroy() {\n        this.viewer.removeEventListener(HideNotificationEvent.type, this);\n        this.viewer.removeEventListener(ShowNotificationEvent.type, this);\n        this.viewer.removeEventListener(HidePanelEvent.type, this);\n        this.viewer.removeEventListener(ShowPanelEvent.type, this);\n        this.viewer.removeEventListener(ConfigChangedEvent.type, this);\n\n        super.destroy();\n    }\n\n    handleEvent(e: Event) {\n        if (e instanceof ConfigChangedEvent) {\n            e.containsOptions('description') && this.autoSize(true);\n            return;\n        }\n\n        if (!this.mode) {\n            return;\n        }\n\n        let closed = false;\n        if (e instanceof HideNotificationEvent) {\n            closed = this.mode === DescriptionButtonMode.NOTIF;\n        } else if (e instanceof ShowNotificationEvent) {\n            closed = this.mode === DescriptionButtonMode.NOTIF && e.notificationId !== IDS.DESCRIPTION;\n        } else if (e instanceof HidePanelEvent) {\n            closed = this.mode === DescriptionButtonMode.PANEL;\n        } else if (e instanceof ShowPanelEvent) {\n            closed = this.mode === DescriptionButtonMode.PANEL && e.panelId !== IDS.DESCRIPTION;\n        }\n\n        if (closed) {\n            this.toggleActive(false);\n            this.mode = DescriptionButtonMode.NONE;\n        }\n    }\n\n    onClick() {\n        if (this.mode) {\n            this.__close();\n        } else {\n            this.__open();\n        }\n    }\n\n    override hide(refresh?: boolean) {\n        super.hide(refresh);\n\n        if (this.mode) {\n            this.__close();\n        }\n    }\n\n    /**\n     * This button can only be refreshed from NavbarCaption\n     * @internal\n     */\n    override autoSize(refresh = false) {\n        if (refresh) {\n            const caption = this.viewer.navbar.getButton('caption', false);\n            const captionHidden = caption && !caption.isVisible();\n            const hasDescription = !!this.viewer.config.description;\n\n            if (captionHidden || hasDescription) {\n                this.show(false);\n            } else {\n                this.hide(false);\n            }\n        }\n    }\n\n    private __close() {\n        switch (this.mode) {\n            case DescriptionButtonMode.NOTIF:\n                this.viewer.notification.hide(IDS.DESCRIPTION);\n                break;\n            case DescriptionButtonMode.PANEL:\n                this.viewer.panel.hide(IDS.DESCRIPTION);\n                break;\n            default:\n        }\n    }\n\n    private __open() {\n        this.toggleActive(true);\n\n        if (this.viewer.config.description) {\n            this.mode = DescriptionButtonMode.PANEL;\n            this.viewer.panel.show({\n                id: IDS.DESCRIPTION,\n                content:\n                    (this.viewer.config.caption ? `<p>${this.viewer.config.caption}</p>` : '') +\n                    this.viewer.config.description,\n            });\n        } else {\n            this.mode = DescriptionButtonMode.NOTIF;\n            this.viewer.notification.show({\n                id: IDS.DESCRIPTION,\n                content: this.viewer.config.caption,\n            });\n        }\n    }\n}\n","import { AbstractAdapter } from '../adapters/AbstractAdapter';\nimport type { Navbar } from '../components/Navbar';\nimport { ICONS } from '../data/constants';\nimport { ConfigChangedEvent } from '../events';\nimport { AbstractButton } from './AbstractButton';\n\nexport class DownloadButton extends AbstractButton {\n    static override readonly id = 'download';\n\n    constructor(navbar: Navbar) {\n        super(navbar, {\n            className: 'psv-download-button',\n            hoverScale: true,\n            collapsable: true,\n            tabbable: true,\n            icon: ICONS.download,\n        });\n\n        this.viewer.addEventListener(ConfigChangedEvent.type, this);\n    }\n\n    override destroy(): void {\n        this.viewer.removeEventListener(ConfigChangedEvent.type, this);\n\n        super.destroy();\n    }\n\n    handleEvent(e: Event) {\n        if (e instanceof ConfigChangedEvent) {\n            e.containsOptions('downloadUrl') && this.checkSupported();\n        }\n    }\n\n    onClick() {\n        const link = document.createElement('a');\n        link.href = this.viewer.config.downloadUrl || this.viewer.config.panorama;\n        if (link.href.startsWith('data:') && !this.viewer.config.downloadName) {\n            link.download = 'panorama.' + link.href.substring(0, link.href.indexOf(';')).split('/').pop();\n        } else {\n            link.download = this.viewer.config.downloadName || link.href.split('/').pop();\n        }\n        link.target = '_blank';\n        this.viewer.container.appendChild(link);\n        link.click();\n\n        setTimeout(() => {\n            this.viewer.container.removeChild(link);\n        }, 100);\n    }\n\n    override checkSupported() {\n        const supported =\n            (this.viewer.adapter.constructor as typeof AbstractAdapter).supportsDownload ||\n            this.viewer.config.downloadUrl;\n        if (supported) {\n            this.show();\n        } else {\n            this.hide();\n        }\n    }\n}\n","import type { Navbar } from '../components/Navbar';\nimport { FullscreenEvent } from '../events';\nimport { AbstractButton } from './AbstractButton';\nimport { ICONS } from '../data/constants';\n\nexport class FullscreenButton extends AbstractButton {\n    static override readonly id = 'fullscreen';\n\n    constructor(navbar: Navbar) {\n        super(navbar, {\n            className: 'psv-fullscreen-button',\n            hoverScale: true,\n            collapsable: false,\n            tabbable: true,\n            icon: ICONS.fullscreenIn,\n            iconActive: ICONS.fullscreenOut,\n        });\n\n        this.viewer.addEventListener(FullscreenEvent.type, this);\n    }\n\n    override destroy() {\n        this.viewer.removeEventListener(FullscreenEvent.type, this);\n\n        super.destroy();\n    }\n\n    handleEvent(e: Event) {\n        if (e instanceof FullscreenEvent) {\n            this.toggleActive(e.fullscreenEnabled);\n        }\n    }\n\n    onClick() {\n        this.viewer.toggleFullscreen();\n    }\n}\n","import type { Navbar } from '../components/Navbar';\nimport { ICONS, IDS } from '../data/constants';\nimport { HidePanelEvent, ShowPanelEvent } from '../events';\nimport { getClosest } from '../utils';\nimport { AbstractButton } from './AbstractButton';\n\nconst BUTTON_DATA = 'psvButton';\n\nconst MENU_TEMPLATE = (buttons: AbstractButton[], title: string) => `\n<div class=\"psv-panel-menu psv-panel-menu--stripped\">\n  <h1 class=\"psv-panel-menu-title\">${ICONS.menu} ${title}</h1>\n  <ul class=\"psv-panel-menu-list\">\n    ${buttons\n        .map(\n            (button) => `\n    <li data-psv-button=\"${button.id}\" class=\"psv-panel-menu-item\" tabindex=\"0\">\n      <span class=\"psv-panel-menu-item-icon\">${button.content}</span>\n      <span class=\"psv-panel-menu-item-label\">${button.title}</span>\n    </li>\n    `\n        )\n        .join('')}\n  </ul>\n</div>\n`;\n\nexport class MenuButton extends AbstractButton {\n    static override readonly id = 'menu';\n\n    constructor(navbar: Navbar) {\n        super(navbar, {\n            className: 'psv-menu-button',\n            hoverScale: true,\n            collapsable: false,\n            tabbable: true,\n            icon: ICONS.menu,\n        });\n\n        this.viewer.addEventListener(ShowPanelEvent.type, this);\n        this.viewer.addEventListener(HidePanelEvent.type, this);\n\n        super.hide();\n    }\n\n    override destroy() {\n        this.viewer.removeEventListener(ShowPanelEvent.type, this);\n        this.viewer.removeEventListener(HidePanelEvent.type, this);\n\n        super.destroy();\n    }\n\n    handleEvent(e: Event) {\n        if (e instanceof ShowPanelEvent) {\n            this.toggleActive(e.panelId === IDS.MENU);\n        } else if (e instanceof HidePanelEvent) {\n            this.toggleActive(false);\n        }\n    }\n\n    onClick() {\n        if (this.state.active) {\n            this.__hideMenu();\n        } else {\n            this.__showMenu();\n        }\n    }\n\n    override hide(refresh?: boolean) {\n        super.hide(refresh);\n        this.__hideMenu();\n    }\n\n    override show(refresh?: boolean) {\n        super.show(refresh);\n\n        if (this.state.active) {\n            this.__showMenu();\n        }\n    }\n\n    private __showMenu() {\n        this.viewer.panel.show({\n            id: IDS.MENU,\n            content: MENU_TEMPLATE(this.viewer.navbar.collapsed, this.viewer.config.lang.menu),\n            noMargin: true,\n            clickHandler: (target) => {\n                const li = target ? getClosest(target as HTMLElement, 'li') : undefined;\n                const buttonId = li ? li.dataset[BUTTON_DATA] : undefined;\n\n                if (buttonId) {\n                    this.viewer.navbar.getButton(buttonId).onClick();\n                    this.__hideMenu();\n                }\n            },\n        });\n    }\n\n    private __hideMenu() {\n        this.viewer.panel.hide(IDS.MENU);\n    }\n}\n","import type { Navbar } from '../components/Navbar';\nimport { ICONS, KEY_CODES } from '../data/constants';\nimport { SYSTEM } from '../data/system';\nimport { invertResolvableBoolean } from '../utils';\nimport { PressHandler } from '../utils/PressHandler';\nimport { AbstractButton } from './AbstractButton';\n\nexport const enum MoveButtonDirection {\n    UP,\n    DOWN,\n    LEFT,\n    RIGHT,\n}\n\nfunction getIcon(value: MoveButtonDirection): string {\n    let angle = 0;\n    // prettier-ignore\n    switch (value) {\n        case MoveButtonDirection.UP: angle = 90; break;\n        case MoveButtonDirection.DOWN: angle = -90; break;\n        case MoveButtonDirection.RIGHT: angle = 180; break;\n        default: angle = 0; break;\n    }\n\n    return ICONS.arrow.replace('rotate(0', `rotate(${angle}`);\n}\n\nexport abstract class AbstractMoveButton extends AbstractButton {\n    static override readonly groupId = 'move';\n\n    private readonly handler = new PressHandler();\n\n    constructor(\n        navbar: Navbar,\n        private direction: MoveButtonDirection\n    ) {\n        super(navbar, {\n            className: 'psv-move-button',\n            hoverScale: true,\n            collapsable: false,\n            tabbable: true,\n            icon: getIcon(direction),\n        });\n\n        this.container.addEventListener('mousedown', this);\n        this.container.addEventListener('keydown', this);\n        this.container.addEventListener('keyup', this);\n        this.viewer.container.addEventListener('mouseup', this);\n        this.viewer.container.addEventListener('touchend', this);\n    }\n\n    override destroy() {\n        this.__onMouseUp();\n\n        this.viewer.container.removeEventListener('mouseup', this);\n        this.viewer.container.removeEventListener('touchend', this);\n\n        super.destroy();\n    }\n\n    handleEvent(e: Event) {\n        // prettier-ignore\n        switch (e.type) {\n            case 'mousedown': this.__onMouseDown(); break;\n            case 'mouseup': this.__onMouseUp(); break;\n            case 'touchend': this.__onMouseUp(); break;\n            case 'keydown':  (e as KeyboardEvent).key === KEY_CODES.Enter && this.__onMouseDown(); break;\n            case 'keyup': (e as KeyboardEvent).key === KEY_CODES.Enter && this.__onMouseUp(); break;\n        }\n    }\n\n    onClick() {\n        // nothing\n    }\n\n    override isSupported() {\n        return invertResolvableBoolean(SYSTEM.isTouchEnabled);\n    }\n\n    private __onMouseDown() {\n        if (!this.state.enabled) {\n            return;\n        }\n\n        const dynamicRoll: {\n            yaw?: boolean;\n            pitch?: boolean;\n        } = {};\n        // prettier-ignore\n        switch (this.direction) {\n            case MoveButtonDirection.UP: dynamicRoll.pitch = false; break;\n            case MoveButtonDirection.DOWN: dynamicRoll.pitch = true; break;\n            case MoveButtonDirection.RIGHT: dynamicRoll.yaw = false; break;\n            default: dynamicRoll.yaw = true; break;\n        }\n\n        this.viewer.stopAll();\n        this.viewer.dynamics.position.roll(dynamicRoll);\n        this.handler.down();\n    }\n\n    private __onMouseUp() {\n        if (!this.state.enabled) {\n            return;\n        }\n\n        this.handler.up(() => {\n            this.viewer.dynamics.position.stop();\n            this.viewer.resetIdleTimer();\n        });\n    }\n}\n","import type { Navbar } from '../components/Navbar';\nimport { AbstractMoveButton, MoveButtonDirection } from './AbstractMoveButton';\n\nexport class MoveDownButton extends AbstractMoveButton {\n    static override readonly id = 'moveDown';\n\n    constructor(navbar: Navbar) {\n        super(navbar, MoveButtonDirection.DOWN);\n    }\n}\n","import type { Navbar } from '../components/Navbar';\nimport { AbstractMoveButton, MoveButtonDirection } from './AbstractMoveButton';\n\nexport class MoveLeftButton extends AbstractMoveButton {\n    static override readonly id = 'moveLeft';\n\n    constructor(navbar: Navbar) {\n        super(navbar, MoveButtonDirection.LEFT);\n    }\n}\n","import type { Navbar } from '../components/Navbar';\nimport { AbstractMoveButton, MoveButtonDirection } from './AbstractMoveButton';\n\nexport class MoveRightButton extends AbstractMoveButton {\n    static override readonly id = 'moveRight';\n\n    constructor(navbar: Navbar) {\n        super(navbar, MoveButtonDirection.RIGHT);\n    }\n}\n","import type { Navbar } from '../components/Navbar';\nimport { AbstractMoveButton, MoveButtonDirection } from './AbstractMoveButton';\n\nexport class MoveUpButton extends AbstractMoveButton {\n    static override readonly id = 'moveUp';\n\n    constructor(navbar: Navbar) {\n        super(navbar, MoveButtonDirection.UP);\n    }\n}\n","import type { Navbar } from '../components/Navbar';\nimport { KEY_CODES } from '../data/constants';\nimport { SYSTEM } from '../data/system';\nimport { invertResolvableBoolean } from '../utils';\nimport { PressHandler } from '../utils/PressHandler';\nimport { AbstractButton } from './AbstractButton';\n\nexport const enum ZoomButtonDirection {\n    IN,\n    OUT,\n}\n\nexport class AbstractZoomButton extends AbstractButton {\n    static override readonly groupId = 'zoom';\n\n    private readonly handler = new PressHandler();\n\n    constructor(\n        navbar: Navbar,\n        icon: string,\n        private direction: ZoomButtonDirection\n    ) {\n        super(navbar, {\n            className: 'psv-zoom-button',\n            hoverScale: true,\n            collapsable: false,\n            tabbable: true,\n            icon: icon,\n        });\n\n        this.container.addEventListener('mousedown', this);\n        this.container.addEventListener('keydown', this);\n        this.container.addEventListener('keyup', this);\n        this.viewer.container.addEventListener('mouseup', this);\n        this.viewer.container.addEventListener('touchend', this);\n    }\n\n    override destroy() {\n        this.__onMouseUp();\n\n        this.viewer.container.removeEventListener('mouseup', this);\n        this.viewer.container.removeEventListener('touchend', this);\n\n        super.destroy();\n    }\n\n    handleEvent(e: Event) {\n        // prettier-ignore\n        switch (e.type) {\n            case 'mousedown': this.__onMouseDown(); break;\n            case 'mouseup': this.__onMouseUp(); break;\n            case 'touchend': this.__onMouseUp(); break;\n            case 'keydown': (e as KeyboardEvent).key === KEY_CODES.Enter && this.__onMouseDown(); break;\n            case 'keyup': (e as KeyboardEvent).key === KEY_CODES.Enter && this.__onMouseUp(); break;\n        }\n    }\n\n    onClick() {\n        // nothing\n    }\n\n    override isSupported() {\n        return invertResolvableBoolean(SYSTEM.isTouchEnabled);\n    }\n\n    private __onMouseDown() {\n        if (!this.state.enabled) {\n            return;\n        }\n\n        this.viewer.dynamics.zoom.roll(this.direction === ZoomButtonDirection.OUT);\n        this.handler.down();\n    }\n\n    private __onMouseUp() {\n        if (!this.state.enabled) {\n            return;\n        }\n\n        this.handler.up(() => this.viewer.dynamics.zoom.stop());\n    }\n}\n","import type { Navbar } from '../components/Navbar';\nimport { ICONS } from '../data/constants';\nimport { AbstractZoomButton, ZoomButtonDirection } from './AbstractZoomButton';\n\nexport class ZoomInButton extends AbstractZoomButton {\n    static override readonly id = 'zoomIn';\n\n    constructor(navbar: Navbar) {\n        super(navbar, ICONS.zoomIn, ZoomButtonDirection.IN);\n    }\n}\n","import type { Navbar } from '../components/Navbar';\nimport { ICONS } from '../data/constants';\nimport { AbstractZoomButton, ZoomButtonDirection } from './AbstractZoomButton';\n\nexport class ZoomOutButton extends AbstractZoomButton {\n    static override readonly id = 'zoomOut';\n\n    constructor(navbar: Navbar) {\n        super(navbar, ICONS.zoomOut, ZoomButtonDirection.OUT);\n    }\n}\n","import type { Navbar } from '../components/Navbar';\nimport { SYSTEM } from '../data/system';\nimport { ReadyEvent, ZoomUpdatedEvent } from '../events';\nimport { Slider, SliderDirection, SliderUpdateData, getStyleProperty, invertResolvableBoolean } from '../utils';\nimport { AbstractButton } from './AbstractButton';\n\nexport class ZoomRangeButton extends AbstractButton {\n    static override readonly id = 'zoomRange';\n    static override readonly groupId = 'zoom';\n\n    private readonly slider: Slider;\n    private readonly zoomRange: HTMLElement;\n    private readonly zoomValue: HTMLElement;\n    private readonly mediaMinWidth: number;\n\n    constructor(navbar: Navbar) {\n        super(navbar, {\n            className: 'psv-zoom-range',\n            hoverScale: false,\n            collapsable: false,\n            tabbable: false,\n        });\n\n        this.zoomRange = document.createElement('div');\n        this.zoomRange.className = 'psv-zoom-range-line';\n        this.container.appendChild(this.zoomRange);\n\n        this.zoomValue = document.createElement('div');\n        this.zoomValue.className = 'psv-zoom-range-handle';\n        this.zoomRange.appendChild(this.zoomValue);\n\n        this.slider = new Slider(this.container, SliderDirection.HORIZONTAL, (data) => this.__onSliderUpdate(data));\n\n        this.mediaMinWidth = parseInt(getStyleProperty(this.container, 'max-width'), 10);\n\n        this.viewer.addEventListener(ZoomUpdatedEvent.type, this);\n        if (this.viewer.state.ready) {\n            this.__moveZoomValue(this.viewer.getZoomLevel());\n        } else {\n            this.viewer.addEventListener(ReadyEvent.type, this);\n        }\n    }\n\n    override destroy() {\n        this.slider.destroy();\n\n        this.viewer.removeEventListener(ZoomUpdatedEvent.type, this);\n        this.viewer.removeEventListener(ReadyEvent.type, this);\n\n        super.destroy();\n    }\n\n    handleEvent(e: Event) {\n        if (e instanceof ZoomUpdatedEvent) {\n            this.__moveZoomValue(e.zoomLevel);\n        } else if (e instanceof ReadyEvent) {\n            this.__moveZoomValue(this.viewer.getZoomLevel());\n        }\n    }\n\n    onClick() {\n        // nothing\n    }\n\n    override isSupported() {\n        return invertResolvableBoolean(SYSTEM.isTouchEnabled);\n    }\n\n    override autoSize() {\n        if (this.state.supported) {\n            if (this.viewer.state.size.width <= this.mediaMinWidth && this.state.visible) {\n                this.hide(false);\n            } else if (this.viewer.state.size.width > this.mediaMinWidth && !this.state.visible) {\n                this.show(false);\n            }\n        }\n    }\n\n    private __moveZoomValue(level: number) {\n        this.zoomValue.style.left = (level / 100) * this.zoomRange.offsetWidth - this.zoomValue.offsetWidth / 2 + 'px';\n    }\n\n    private __onSliderUpdate(data: SliderUpdateData) {\n        if (data.mousedown) {\n            this.viewer.zoom(data.value * 100);\n        }\n    }\n}\n","import { MathUtils } from 'three';\nimport { PSVError } from '../PSVError';\nimport { adapterInterop } from '../adapters/AbstractAdapter';\nimport { EquirectangularAdapter } from '../adapters/EquirectangularAdapter';\nimport { ParsedViewerConfig, ReadonlyViewerConfig, ViewerConfig } from '../model';\nimport { pluginInterop } from '../plugins/AbstractPlugin';\nimport { ConfigParsers, clone, getConfigParser, logWarn, parseAngle } from '../utils';\nimport { ACTIONS, KEY_CODES } from './constants';\n\n/**\n * Default options\n */\nexport const DEFAULTS: Required<ParsedViewerConfig> = {\n    panorama: null,\n    container: null,\n    adapter: [EquirectangularAdapter as any, null],\n    plugins: [],\n    caption: null,\n    description: null,\n    downloadUrl: null,\n    downloadName: null,\n    loadingImg: null,\n    loadingTxt: '', // empty string => `lang.loading`\n    size: null,\n    fisheye: 0,\n    minFov: 30,\n    maxFov: 90,\n    defaultZoomLvl: 50,\n    defaultYaw: 0,\n    defaultPitch: 0,\n    sphereCorrection: null,\n    moveSpeed: 1,\n    zoomSpeed: 1,\n    moveInertia: true,\n    mousewheel: true,\n    mousemove: true,\n    mousewheelCtrlKey: false,\n    touchmoveTwoFingers: false,\n    panoData: null,\n    requestHeaders: null,\n    rendererParameters: { alpha: true, antialias: true },\n    withCredentials: false,\n    // prettier-ignore\n    navbar: [\n        'zoom',\n        'move',\n        'download',\n        'description',\n        'caption',\n        'fullscreen',\n    ],\n    lang: {\n        zoom: 'Zoom',\n        zoomOut: 'Zoom out',\n        zoomIn: 'Zoom in',\n        moveUp: 'Move up',\n        moveDown: 'Move down',\n        moveLeft: 'Move left',\n        moveRight: 'Move right',\n        description: 'Description',\n        download: 'Download',\n        fullscreen: 'Fullscreen',\n        loading: 'Loading...',\n        menu: 'Menu',\n        close: 'Close',\n        twoFingers: 'Use two fingers to navigate',\n        ctrlZoom: 'Use ctrl + scroll to zoom the image',\n        loadError: 'The panorama cannot be loaded',\n        webglError: 'Your browser does not seem to support WebGL',\n    },\n    keyboard: 'fullscreen',\n    keyboardActions: {\n        [KEY_CODES.ArrowUp]: ACTIONS.ROTATE_UP,\n        [KEY_CODES.ArrowDown]: ACTIONS.ROTATE_DOWN,\n        [KEY_CODES.ArrowRight]: ACTIONS.ROTATE_RIGHT,\n        [KEY_CODES.ArrowLeft]: ACTIONS.ROTATE_LEFT,\n        [KEY_CODES.PageUp]: ACTIONS.ZOOM_IN,\n        [KEY_CODES.PageDown]: ACTIONS.ZOOM_OUT,\n        [KEY_CODES.Plus]: ACTIONS.ZOOM_IN,\n        [KEY_CODES.Minus]: ACTIONS.ZOOM_OUT,\n    },\n};\n\n/**\n * List of unmodifiable options and their error messages\n * @internal\n */\nexport const READONLY_OPTIONS: Record<ReadonlyViewerConfig, string> = {\n    panorama: 'Use setPanorama method to change the panorama',\n    panoData: 'Use setPanorama method to change the panorama',\n    container: 'Cannot change viewer container',\n    adapter: 'Cannot change adapter',\n    plugins: 'Cannot change plugins',\n};\n\n/**\n * Parsers/validators for each option\n * @internal\n */\nexport const CONFIG_PARSERS: ConfigParsers<ViewerConfig, ParsedViewerConfig> = {\n    container: (container) => {\n        if (!container) {\n            throw new PSVError('No value given for container.');\n        }\n        return container;\n    },\n    adapter: (adapter, { defValue }) => {\n        if (!adapter) {\n            adapter = defValue;\n        } else if (Array.isArray(adapter)) {\n            adapter = [adapterInterop(adapter[0]), adapter[1]];\n        } else {\n            adapter = [adapterInterop(adapter), null];\n        }\n        if (!adapter[0]) {\n            throw new PSVError('An undefined value was given for adapter.');\n        }\n        if (!(adapter[0] as any).id) {\n            throw new PSVError(`Adapter has no id.`);\n        }\n        return adapter;\n    },\n    defaultYaw: (defaultYaw) => {\n        // defaultYaw is between 0 and PI\n        return parseAngle(defaultYaw);\n    },\n    defaultPitch: (defaultPitch) => {\n        // defaultPitch is between -PI/2 and PI/2\n        return parseAngle(defaultPitch, true);\n    },\n    defaultZoomLvl: (defaultZoomLvl) => {\n        return MathUtils.clamp(defaultZoomLvl, 0, 100);\n    },\n    minFov: (minFov, { rawConfig }) => {\n        // minFov and maxFov must be ordered\n        if (rawConfig.maxFov < minFov) {\n            logWarn('maxFov cannot be lower than minFov');\n            minFov = rawConfig.maxFov;\n        }\n        // minFov between 1 and 179\n        return MathUtils.clamp(minFov, 1, 179);\n    },\n    maxFov: (maxFov, { rawConfig }) => {\n        // minFov and maxFov must be ordered\n        if (maxFov < rawConfig.minFov) {\n            maxFov = rawConfig.minFov;\n        }\n        // maxFov between 1 and 179\n        return MathUtils.clamp(maxFov, 1, 179);\n    },\n    lang: (lang) => {\n        return {\n            ...DEFAULTS.lang,\n            ...lang,\n        };\n    },\n    keyboard: (keyboard) => {\n        if (!keyboard) {\n            return false;\n        }\n        if (typeof keyboard === 'object') {\n            logWarn(`Use keyboardActions to configure the keyboard actions, keyboard option must be either true, false, 'fullscreen' or 'always'`);\n            return 'fullscreen';\n        }\n        return keyboard === 'always' ? 'always' : 'fullscreen';\n    },\n    keyboardActions: (keyboardActions, { rawConfig }) => {\n        if (rawConfig.keyboard && typeof rawConfig.keyboard === 'object') {\n            return rawConfig.keyboard;\n        }\n        return keyboardActions;\n    },\n    fisheye: (fisheye) => {\n        // translate boolean fisheye to amount\n        if (fisheye === true) {\n            return 1;\n        } else if (fisheye === false) {\n            return 0;\n        }\n        return fisheye;\n    },\n    requestHeaders: (requestHeaders) => {\n        if (requestHeaders && typeof requestHeaders === 'object') {\n            return () => requestHeaders;\n        }\n        if (typeof requestHeaders === 'function') {\n            return requestHeaders;\n        }\n        return null;\n    },\n    rendererParameters: (rendererParameters, { defValue }) => ({\n        ...rendererParameters,\n        ...defValue,\n    }),\n    plugins: (plugins) => {\n        return plugins.map((plugin, i) => {\n            if (Array.isArray(plugin)) {\n                plugin = [pluginInterop(plugin[0]), plugin[1]];\n            } else {\n                plugin = [pluginInterop(plugin), null];\n            }\n            if (!plugin[0]) {\n                throw new PSVError(`An undefined value was given for plugin ${i}.`);\n            }\n            if (!(plugin[0] as any).id) {\n                throw new PSVError(`Plugin ${i} has no id.`);\n            }\n            return plugin;\n        });\n    },\n    navbar: (navbar) => {\n        if (navbar === false) {\n            return null;\n        }\n        if (navbar === true) {\n            // true becomes the default array\n            return clone(DEFAULTS.navbar as string[]);\n        }\n        if (typeof navbar === 'string') {\n            // can be a space or coma separated list\n            return navbar.split(/[ ,]/);\n        }\n        return navbar;\n    },\n};\n\n/**\n * @internal\n */\nexport const getViewerConfig = getConfigParser<ViewerConfig, ParsedViewerConfig>(DEFAULTS, CONFIG_PARSERS);\n","import { TypedEvent, TypedEventTarget } from '../lib/TypedEventTarget';\nimport { checkVersion, ConfigParser, logWarn } from '../utils';\nimport type { Viewer } from '../Viewer';\n\n/**\n * Base class for plugins\n * @template TEvents union of dispatched events\n */\nexport abstract class AbstractPlugin<\n    TEvents extends TypedEvent<AbstractPlugin> = never\n> extends TypedEventTarget<TEvents> {\n    /**\n     * Unique identifier of the plugin\n     */\n    static readonly id: string;\n    /**\n     * Expected version of the core\n     * DO NOT USE on custom plugins\n     */\n    static readonly VERSION: string;\n\n    constructor(protected viewer: Viewer) {\n        super();\n    }\n\n    /**\n     * Initializes the plugin\n     */\n    // eslint-disable-next-line @typescript-eslint/no-empty-function\n    init(): void {}\n\n    /**\n     * Destroys the plugin\n     */\n    // eslint-disable-next-line @typescript-eslint/no-empty-function\n    destroy(): void {}\n}\n\n/**\n * Base class for plugins with updatable configuration\n * The implementation must have a static `configParser` property which is the result of {@link utils.getConfigParser}\n *\n * @template TConfig type of input config\n * @template TParsedConfig type of config after parsing\n * @template TUpdatableConfig type of config that can be updated\n * @template TEvents union of dispatched events\n */\nexport abstract class AbstractConfigurablePlugin<\n    TConfig extends Record<string, any>,\n    TParsedConfig extends TConfig = TConfig,\n    TUpdatableConfig extends TConfig = TConfig,\n    TEvents extends TypedEvent<AbstractPlugin> = never\n> extends AbstractPlugin<TEvents> {\n    static configParser: ConfigParser<any, any>;\n    static readonlyOptions: string[] = [];\n\n    readonly config: TParsedConfig;\n\n    constructor(viewer: Viewer, config: TConfig) {\n        super(viewer);\n\n        this.config = (this.constructor as typeof AbstractConfigurablePlugin).configParser(config) as TParsedConfig;\n    }\n\n    /**\n     * Update options\n     */\n    setOption<T extends keyof TUpdatableConfig>(option: T, value: TUpdatableConfig[T]) {\n        // @ts-ignore\n        this.setOptions({ [option]: value });\n    }\n\n    /**\n     * Update options\n     */\n    setOptions(options: Partial<TUpdatableConfig>) {\n        const rawConfig: TConfig = {\n            ...this.config,\n            ...options,\n        };\n\n        const ctor = this.constructor as typeof AbstractConfigurablePlugin;\n        const parser: ConfigParser<TConfig, TParsedConfig> = ctor.configParser as any;\n        const readonly = ctor.readonlyOptions;\n        const id = ctor.id;\n\n        for (let [key, value] of Object.entries(options) as Array<[keyof TConfig, any]>) {\n            if (!(key in parser.defaults)) {\n                logWarn(`${id}: Unknown option \"${key as string}\"`);\n                continue;\n            }\n\n            if (readonly.includes(key as string)) {\n                logWarn(`${id}: Option \"${key as string}\" cannot be updated`);\n                continue;\n            }\n\n            if (key in parser.parsers) {\n                value = parser.parsers[key](value, {\n                    rawConfig: rawConfig,\n                    defValue: parser.defaults[key],\n                });\n            }\n\n            this.config[key] = value;\n        }\n    }\n}\n\nexport type PluginConstructor = new (viewer: Viewer, config?: any) => AbstractPlugin<any>;\n\n/**\n * Returns the plugin constructor from the imported object\n * @internal\n */\nexport function pluginInterop(plugin: any): PluginConstructor & typeof AbstractPlugin {\n    if (plugin) {\n        for (const [, p] of [['_', plugin], ...Object.entries(plugin)]) {\n            if (p.prototype instanceof AbstractPlugin) {\n                checkVersion(p.id, p.VERSION, PKG_VERSION);\n                return p;\n            }\n        }\n    }\n    return null;\n}\n","import { AbstractButton } from '../buttons/AbstractButton';\nimport { DescriptionButton } from '../buttons/DescriptionButton';\nimport type { Navbar } from './Navbar';\n\nexport class NavbarCaption extends AbstractButton {\n    static override readonly id = 'caption';\n\n    private contentWidth = 0;\n\n    private readonly contentElt: HTMLElement;\n\n    constructor(navbar: Navbar) {\n        super(navbar, {\n            className: 'psv-caption',\n            hoverScale: false,\n            collapsable: false,\n            tabbable: true,\n        });\n\n        this.state.width = 0;\n\n        this.contentElt = document.createElement('div');\n        this.contentElt.className = 'psv-caption-content';\n        this.container.appendChild(this.contentElt);\n\n        this.setCaption(this.viewer.config.caption);\n    }\n\n    override hide() {\n        this.contentElt.style.display = 'none';\n        this.state.visible = false;\n    }\n\n    override show() {\n        this.contentElt.style.display = '';\n        this.state.visible = true;\n    }\n\n    onClick(): void {\n        // nothing\n    }\n\n    /**\n     * Changes the caption\n     */\n    setCaption(html: string) {\n        this.show();\n        this.contentElt.innerHTML = html ?? '';\n\n        if (this.contentElt.innerHTML) {\n            this.contentWidth = this.contentElt.offsetWidth;\n        } else {\n            this.contentWidth = 0;\n        }\n\n        this.autoSize();\n    }\n\n    /**\n     * Toggles content and icon depending on available space\n     */\n    override autoSize() {\n        this.toggle(this.container.offsetWidth >= this.contentWidth);\n        this.__refreshButton();\n    }\n\n    private __refreshButton() {\n        (this.viewer.navbar.getButton(DescriptionButton.id, false) as DescriptionButton)?.autoSize(true);\n    }\n}\n","import { AbstractButton, ButtonConstructor } from '../buttons/AbstractButton';\nimport { CustomButton } from '../buttons/CustomButton';\nimport { DescriptionButton } from '../buttons/DescriptionButton';\nimport { DownloadButton } from '../buttons/DownloadButton';\nimport { FullscreenButton } from '../buttons/FullscreenButton';\nimport { MenuButton } from '../buttons/MenuButton';\nimport { MoveDownButton } from '../buttons/MoveDownButton';\nimport { MoveLeftButton } from '../buttons/MoveLeftButton';\nimport { MoveRightButton } from '../buttons/MoveRightButton';\nimport { MoveUpButton } from '../buttons/MoveUpButton';\nimport { ZoomInButton } from '../buttons/ZoomInButton';\nimport { ZoomOutButton } from '../buttons/ZoomOutButton';\nimport { ZoomRangeButton } from '../buttons/ZoomRangeButton';\nimport { DEFAULTS } from '../data/config';\nimport { CAPTURE_EVENTS_CLASS } from '../data/constants';\nimport { ParsedViewerConfig } from '../model';\nimport { PSVError } from '../PSVError';\nimport { logWarn } from '../utils';\nimport type { Viewer } from '../Viewer';\nimport { AbstractComponent } from './AbstractComponent';\nimport { NavbarCaption } from './NavbarCaption';\n\n/**\n * List of available buttons\n */\nconst AVAILABLE_BUTTONS: Record<string, ButtonConstructor> = {};\n\n/**\n * List of available buttons\n */\nconst AVAILABLE_GROUPS: Record<string, ButtonConstructor[]> = {};\n\n/**\n * Register a new button available for all viewers\n * @param button\n * @param [defaultPosition]  If provided the default configuration of the navbar will be modified.\n * Possible values are :\n *    - `start`\n *    - `end`\n *    - `[id]:left`\n *    - `[id]:right`\n * @throws {@link PSVError} if the button constructor has no \"id\"\n */\nexport function registerButton(button: ButtonConstructor, defaultPosition?: string) {\n    if (!button.id) {\n        throw new PSVError('Button id is required');\n    }\n\n    AVAILABLE_BUTTONS[button.id] = button;\n\n    if (button.groupId) {\n        (AVAILABLE_GROUPS[button.groupId] = AVAILABLE_GROUPS[button.groupId] || []).push(button);\n    }\n\n    if (defaultPosition) {\n        const navbar = DEFAULTS.navbar as string[];\n        switch (defaultPosition) {\n            case 'start':\n                navbar.unshift(button.id);\n                break;\n            case 'end':\n                navbar.push(button.id);\n                break;\n            default: {\n                const [id, pos] = defaultPosition.split(':');\n                const idx = navbar.indexOf(id);\n                if (!id || !pos || idx === -1) {\n                    throw new PSVError(`Invalid defaultPosition ${defaultPosition}`);\n                }\n                navbar.splice(idx + (pos === 'right' ? 1 : 0), 0, button.id);\n            }\n        }\n    }\n}\n\n[\n    ZoomOutButton,\n    ZoomRangeButton,\n    ZoomInButton,\n    DescriptionButton,\n    NavbarCaption,\n    DownloadButton,\n    FullscreenButton,\n    MoveLeftButton,\n    MoveRightButton,\n    MoveUpButton,\n    MoveDownButton,\n].forEach((btn) => registerButton(btn));\n\n/**\n * Navigation bar component\n */\nexport class Navbar extends AbstractComponent {\n    /**\n     * @internal\n     */\n    collapsed: AbstractButton[] = [];\n\n    /**\n     * @internal\n     */\n    constructor(viewer: Viewer) {\n        super(viewer, {\n            className: `psv-navbar ${CAPTURE_EVENTS_CLASS}`,\n        });\n\n        this.state.visible = false;\n    }\n\n    /**\n     * Shows the navbar\n     */\n    override show() {\n        this.viewer.container.classList.add('psv--has-navbar');\n        this.container.classList.add('psv-navbar--open');\n        this.state.visible = true;\n    }\n\n    /**\n     * Hides the navbar\n     */\n    override hide() {\n        this.viewer.container.classList.remove('psv--has-navbar');\n        this.container.classList.remove('psv-navbar--open');\n        this.state.visible = false;\n    }\n\n    /**\n     * Change the buttons visible on the navbar\n     */\n    setButtons(buttons: ParsedViewerConfig['navbar']) {\n        this.children.slice().forEach((item) => item.destroy());\n        this.children.length = 0;\n\n        // force description button if caption is present (used on narrow screens)\n        if (buttons.indexOf(NavbarCaption.id) !== -1 && buttons.indexOf(DescriptionButton.id) === -1) {\n            buttons.splice(buttons.indexOf(NavbarCaption.id), 0, DescriptionButton.id);\n        }\n\n        buttons.forEach((button) => {\n            if (typeof button === 'object') {\n                new CustomButton(this, button);\n            } else if (AVAILABLE_BUTTONS[button]) {\n                // @ts-ignore\n                new AVAILABLE_BUTTONS[button](this);\n            } else if (AVAILABLE_GROUPS[button]) {\n                AVAILABLE_GROUPS[button].forEach((buttonCtor) => {\n                    // @ts-ignore\n                    new buttonCtor(this);\n                });\n            } else {\n                logWarn(`Unknown button ${button}`);\n            }\n        });\n\n        new MenuButton(this);\n\n        this.children.forEach((item) => {\n            if (item instanceof AbstractButton) {\n                item.checkSupported();\n            }\n        });\n\n        this.autoSize();\n    }\n\n    /**\n     * Changes the navbar caption\n     */\n    setCaption(html: string) {\n        this.children.some((item) => {\n            if (item instanceof NavbarCaption) {\n                item.setCaption(html);\n                return true;\n            } else {\n                return false;\n            }\n        });\n    }\n\n    /**\n     * Returns a button by its identifier\n     */\n    getButton(id: string, warnNotFound = true): AbstractButton {\n        const button = this.children.find((item) => {\n            return item instanceof AbstractButton && item.id === id;\n        });\n\n        if (!button && warnNotFound) {\n            logWarn(`button \"${id}\" not found in the navbar`);\n        }\n\n        return button as AbstractButton;\n    }\n\n    /**\n     * Automatically collapses buttons\n     * @internal\n     */\n    autoSize() {\n        this.children.forEach((child) => {\n            if (child instanceof AbstractButton) {\n                child.autoSize();\n            }\n        });\n\n        const availableWidth = this.container.offsetWidth;\n\n        let totalWidth = 0;\n        const collapsableButtons: AbstractButton[] = [];\n\n        this.children.forEach((item) => {\n            if (item.isVisible() && item instanceof AbstractButton) {\n                totalWidth += item.width;\n                if (item.collapsable) {\n                    collapsableButtons.push(item);\n                }\n            }\n        });\n\n        if (totalWidth === 0) {\n            return;\n        }\n\n        if (availableWidth < totalWidth && collapsableButtons.length > 0) {\n            collapsableButtons.forEach((item) => item.collapse());\n            this.collapsed = collapsableButtons;\n\n            this.getButton(MenuButton.id).show(false);\n        } else if (availableWidth >= totalWidth && this.collapsed.length > 0) {\n            this.collapsed.forEach((item) => item.uncollapse());\n            this.collapsed = [];\n\n            this.getButton(MenuButton.id).hide(false);\n        }\n\n        this.getButton(NavbarCaption.id, false)?.autoSize();\n    }\n}\n","import { Cache as ThreeCache } from 'three';\nimport { logWarn } from '../utils';\n\nThreeCache.enabled = false;\n\nexport const Cache = {\n    enabled: true,\n\n    maxItems: 10,\n\n    ttl: 10 * 60,\n\n    items: {} as Record<string, { files: Record<string, HTMLImageElement | Blob>; lastAccess: number }>,\n\n    purgeInterval: null as ReturnType<typeof setInterval>,\n\n    init() {\n        if (ThreeCache.enabled) {\n            logWarn('ThreeJS cache should be disabled');\n            ThreeCache.enabled = false;\n        }\n\n        if (!this.purgeInterval && this.enabled) {\n            this.purgeInterval = setInterval(() => this.purge(), 60 * 1000);\n        }\n    },\n\n    add(url: string, key: string, data: HTMLImageElement | Blob) {\n        if (this.enabled && key) {\n            this.items[key] = this.items[key] ?? { files: {}, lastAccess: null };\n            this.items[key].files[url] = data;\n            this.items[key].lastAccess = Date.now();\n        }\n    },\n\n    get(url: string, key: string): HTMLImageElement | Blob {\n        if (this.enabled && key && this.items[key]) {\n            this.items[key].lastAccess = Date.now();\n            return this.items[key].files[url];\n        }\n    },\n\n    remove(url: string, key: string) {\n        if (this.enabled && key && this.items[key]) {\n            delete this.items[key].files[url];\n            if (Object.keys(this.items[key].files).length === 0) {\n                delete this.items[key];\n            }\n        }\n    },\n\n    purge() {\n        Object.entries(this.items)\n            .sort(([, a], [, b]) => {\n                return b.lastAccess - a.lastAccess;\n            })\n            .forEach(([key, { lastAccess }], index) => {\n                // remove expired items and extra numerous items\n                // but always keep the most recent one\n                if (index > 0 && (Date.now() - lastAccess >= this.ttl * 1000 || index >= this.maxItems)) {\n                    delete this.items[key];\n                }\n            });\n    },\n};\n","import { ConfigChangedEvent, LoadProgressEvent } from '../events';\nimport { getStyleProperty } from '../utils';\nimport type { Viewer } from '../Viewer';\nimport { AbstractComponent } from './AbstractComponent';\n\n/**\n * Loader component\n */\nexport class Loader extends AbstractComponent {\n    private readonly loader: HTMLElement;\n    private readonly canvas: SVGElement;\n\n    private readonly size: number;\n    private readonly border: number;\n    private readonly thickness: number;\n    private readonly color: string;\n    private readonly textColor: string;\n\n    /**\n     * @internal\n     */\n    constructor(viewer: Viewer) {\n        super(viewer, { className: 'psv-loader-container' });\n\n        this.loader = document.createElement('div');\n        this.loader.className = 'psv-loader';\n        this.container.appendChild(this.loader);\n\n        this.size = this.loader.offsetWidth;\n\n        this.canvas = document.createElementNS('http://www.w3.org/2000/svg', 'svg');\n        this.canvas.setAttribute('class', 'psv-loader-canvas');\n        this.canvas.setAttribute('viewBox', `0 0 ${this.size} ${this.size}`);\n        this.loader.appendChild(this.canvas);\n\n        this.textColor = getStyleProperty(this.loader, 'color');\n        this.color = getStyleProperty(this.canvas, 'color');\n        this.border = parseInt(getStyleProperty(this.loader, '--psv-loader-border'), 10);\n        this.thickness = parseInt(getStyleProperty(this.loader, '--psv-loader-tickness'), 10);\n\n        this.viewer.addEventListener(ConfigChangedEvent.type, this);\n\n        this.__updateContent();\n        this.hide();\n    }\n\n    /**\n     * @internal\n     */\n    override destroy(): void {\n        this.viewer.removeEventListener(ConfigChangedEvent.type, this);\n\n        super.destroy();\n    }\n\n    /**\n     * @internal\n     */\n    handleEvent(e: Event) {\n        if (e instanceof ConfigChangedEvent) {\n            e.containsOptions('loadingImg', 'loadingTxt') && this.__updateContent();\n        }\n    }\n\n    /**\n     * Sets the loader progression\n     */\n    setProgress(value: number) {\n        const angle = (Math.min(value, 99.999) / 100) * Math.PI * 2;\n        const halfSize = this.size / 2;\n        const startX = halfSize;\n        const startY = this.thickness / 2 + this.border;\n        const radius = (this.size - this.thickness) / 2 - this.border;\n        const endX = Math.sin(angle) * radius + halfSize;\n        const endY = -Math.cos(angle) * radius + halfSize;\n        const largeArc = value > 50 ? '1' : '0';\n\n        this.canvas.innerHTML = `\n            <circle cx=\"${halfSize}\" cy=\"${halfSize}\" r=\"${halfSize}\" fill=\"${this.color}\"/>\n            <path d=\"M ${startX} ${startY} A ${radius} ${radius} 0 ${largeArc} 1 ${endX} ${endY}\" \n                  fill=\"none\" stroke=\"${this.textColor}\" stroke-width=\"${this.thickness}\" stroke-linecap=\"round\"/>\n        `;\n\n        this.viewer.dispatchEvent(new LoadProgressEvent(Math.round(value)));\n    }\n\n    private __updateContent() {\n        const current = this.loader.querySelector('.psv-loader-image, .psv-loader-text');\n        if (current) {\n            this.loader.removeChild(current);\n        }\n\n        let inner;\n        if (this.viewer.config.loadingImg) {\n            inner = document.createElement('img');\n            inner.className = 'psv-loader-image';\n            inner.src = this.viewer.config.loadingImg;\n        } else if (this.viewer.config.loadingTxt !== null) {\n            inner = document.createElement('div');\n            inner.className = 'psv-loader-text';\n            inner.innerHTML = this.viewer.config.loadingTxt || this.viewer.config.lang.loading;\n        }\n        if (inner) {\n            const size = Math.round(Math.sqrt(2 * Math.pow(this.size / 2 - this.thickness / 2 - this.border, 2)));\n            inner.style.maxWidth = size + 'px';\n            inner.style.maxHeight = size + 'px';\n            this.loader.appendChild(inner);\n        }\n    }\n}\n","import { PSVError } from '../PSVError';\nimport type { Viewer } from '../Viewer';\nimport { HideNotificationEvent, ShowNotificationEvent } from '../events';\nimport { AbstractComponent } from './AbstractComponent';\n\n/**\n * Configuration for {@link Notification.show}\n */\nexport type NotificationConfig = {\n    /**\n     * unique identifier to use with {@link Notification.hide} and {@link Notification.isVisible}\n     */\n    id?: string;\n    /**\n     * notification content\n     */\n    content: string;\n    /**\n     * automatically hide the notification after X milliseconds\n     */\n    timeout?: number;\n};\n\n/**\n * Notification component\n */\nexport class Notification extends AbstractComponent {\n    /**\n     * @internal\n     */\n    protected override readonly state = {\n        visible: false,\n        contentId: null as string,\n        timeout: null as ReturnType<typeof setTimeout>,\n    };\n\n    private readonly content: HTMLElement;\n\n    /**\n     * @internal\n     */\n    constructor(viewer: Viewer) {\n        super(viewer, {\n            className: 'psv-notification',\n        });\n\n        this.content = document.createElement('div');\n        this.content.className = 'psv-notification-content';\n        this.container.appendChild(this.content);\n\n        this.content.addEventListener('click', () => this.hide());\n    }\n\n    /**\n     * Checks if the notification is visible\n     */\n    override isVisible(id?: string) {\n        return this.state.visible && (!id || !this.state.contentId || this.state.contentId === id);\n    }\n\n    /**\n     * @throws {@link PSVError} always\n     * @internal\n     */\n    override toggle() {\n        throw new PSVError('Notification cannot be toggled');\n    }\n\n    /**\n     * Displays a notification on the viewer\n     *\n     * @example\n     * viewer.showNotification({ content: 'Hello world', timeout: 5000 })\n     * @example\n     * viewer.showNotification('Hello world')\n     */\n    override show(config: string | NotificationConfig) {\n        if (this.state.timeout) {\n            clearTimeout(this.state.timeout);\n            this.state.timeout = null;\n        }\n\n        if (typeof config === 'string') {\n            config = { content: config };\n        }\n\n        this.state.contentId = config.id || null;\n        this.content.innerHTML = config.content;\n\n        this.container.classList.add('psv-notification--visible');\n        this.state.visible = true;\n\n        this.viewer.dispatchEvent(new ShowNotificationEvent(config.id));\n\n        if (config.timeout) {\n            this.state.timeout = setTimeout(() => this.hide(this.state.contentId), config.timeout);\n        }\n    }\n\n    /**\n     * Hides the notification\n     */\n    override hide(id?: string) {\n        if (this.isVisible(id)) {\n            const contentId = this.state.contentId;\n\n            this.container.classList.remove('psv-notification--visible');\n            this.state.visible = false;\n\n            this.state.contentId = null;\n\n            this.viewer.dispatchEvent(new HideNotificationEvent(contentId));\n        }\n    }\n}\n","import { CAPTURE_EVENTS_CLASS, KEY_CODES } from '../data/constants';\nimport { PSVError } from '../PSVError';\nimport type { Viewer } from '../Viewer';\nimport { HideOverlayEvent, KeypressEvent, ShowOverlayEvent } from '../events';\nimport { AbstractComponent } from './AbstractComponent';\n\n/**\n * Configuration for {@link Overlay.show}\n */\nexport type OverlayConfig = {\n    /**\n     * unique identifier to use with {@link Overlay.hide} and {@link Overlay.isVisible}\n     */\n    id?: string;\n    /**\n     * SVG image/icon displayed above the text\n     */\n    image?: string;\n    /**\n     * main message\n     */\n    title: string;\n    /**\n     * secondary message\n     */\n    text?: string;\n    /**\n     * if the user can hide the overlay by clicking\n     * @default true\n     */\n    dissmisable?: boolean;\n};\n\n/**\n * Overlay component\n */\nexport class Overlay extends AbstractComponent {\n    /**\n     * @internal\n     */\n    protected override readonly state = {\n        visible: false,\n        contentId: null as string,\n        dissmisable: true,\n    };\n\n    private readonly image: HTMLElement;\n    private readonly title: HTMLElement;\n    private readonly text: HTMLElement;\n\n    /**\n     * @internal\n     */\n    constructor(viewer: Viewer) {\n        super(viewer, {\n            className: `psv-overlay ${CAPTURE_EVENTS_CLASS}`,\n        });\n\n        this.image = document.createElement('div');\n        this.image.className = 'psv-overlay-image';\n        this.container.appendChild(this.image);\n\n        this.title = document.createElement('div');\n        this.title.className = 'psv-overlay-title';\n        this.container.appendChild(this.title);\n\n        this.text = document.createElement('div');\n        this.text.className = 'psv-overlay-text';\n        this.container.appendChild(this.text);\n\n        this.container.addEventListener('click', this);\n        this.viewer.addEventListener(KeypressEvent.type, this);\n\n        super.hide();\n    }\n\n    /**\n     * @internal\n     */\n    override destroy() {\n        this.viewer.removeEventListener(KeypressEvent.type, this);\n\n        super.destroy();\n    }\n\n    /**\n     * @internal\n     */\n    handleEvent(e: Event) {\n        if (e.type === 'click') {\n            if (this.isVisible() && this.state.dissmisable) {\n                this.hide();\n                e.stopPropagation();\n            }\n        } else if (e instanceof KeypressEvent) {\n            if (this.isVisible() && this.state.dissmisable && e.key === KEY_CODES.Escape) {\n                this.hide();\n                e.preventDefault();\n            }\n        }\n    }\n\n    /**\n     * Checks if the overlay is visible\n     */\n    override isVisible(id?: string) {\n        return this.state.visible && (!id || !this.state.contentId || this.state.contentId === id);\n    }\n\n    /**\n     * @throws {@link PSVError} always\n     * @internal\n     */\n    override toggle() {\n        throw new PSVError('Overlay cannot be toggled');\n    }\n\n    /**\n     * Displays an overlay on the viewer\n     */\n    override show(config: string | OverlayConfig) {\n        if (typeof config === 'string') {\n            config = { title: config };\n        }\n\n        this.state.contentId = config.id || null;\n        this.state.dissmisable = config.dissmisable !== false;\n        this.image.innerHTML = config.image || '';\n        this.title.innerHTML = config.title || '';\n        this.text.innerHTML = config.text || '';\n\n        super.show();\n\n        this.viewer.dispatchEvent(new ShowOverlayEvent(config.id));\n    }\n\n    /**\n     * Hides the overlay\n     */\n    override hide(id?: string) {\n        if (this.isVisible(id)) {\n            const contentId = this.state.contentId;\n\n            super.hide();\n\n            this.state.contentId = null;\n\n            this.viewer.dispatchEvent(new HideOverlayEvent(contentId));\n        }\n    }\n}\n","import { CAPTURE_EVENTS_CLASS, ICONS, KEY_CODES } from '../data/constants';\nimport { PSVError } from '../PSVError';\nimport { toggleClass } from '../utils';\nimport type { Viewer } from '../Viewer';\nimport { HidePanelEvent, KeypressEvent, ShowPanelEvent } from '../events';\nimport { AbstractComponent } from './AbstractComponent';\n\nconst PANEL_MIN_WIDTH = 200;\n\nconst PANEL_CLASS_NO_INTERACTION = 'psv-panel-content--no-interaction';\n\n/**\n * Configuration for {@link Panel.show}\n */\nexport type PanelConfig = {\n    /**\n     * unique identifier to use with {@link Panel.hide} and {@link Panel.isVisible} and to store the width\n     */\n    id?: string;\n    /**\n     * HTML content of the panel\n     */\n    content: string;\n    /**\n     * remove the default margins\n     * @default false\n     */\n    noMargin?: boolean;\n    /**\n     * initial width\n     */\n    width?: string;\n    /**\n     * called when the user clicks inside the panel or presses the Enter key while an element focused\n     */\n    clickHandler?: (target: HTMLElement) => void;\n};\n\n/**\n * Panel component\n */\nexport class Panel extends AbstractComponent {\n    /**\n     * @internal\n     */\n    protected override readonly state = {\n        visible: false,\n        contentId: null as string,\n        mouseX: 0,\n        mouseY: 0,\n        mousedown: false,\n        clickHandler: null as (e: MouseEvent) => void,\n        keyHandler: null as (e: KeyboardEvent) => void,\n        width: {} as Record<string, string>,\n    };\n\n    private readonly content: HTMLElement;\n\n    /**\n     * @internal\n     */\n    constructor(viewer: Viewer) {\n        super(viewer, {\n            className: `psv-panel ${CAPTURE_EVENTS_CLASS}`,\n        });\n\n        const resizer = document.createElement('div');\n        resizer.className = 'psv-panel-resizer';\n        this.container.appendChild(resizer);\n\n        const closeBtn = document.createElement('div');\n        closeBtn.className = 'psv-panel-close-button';\n        closeBtn.innerHTML = ICONS.close;\n        closeBtn.title = viewer.config.lang.close;\n        this.container.appendChild(closeBtn);\n\n        this.content = document.createElement('div');\n        this.content.className = 'psv-panel-content';\n        this.container.appendChild(this.content);\n\n        // Stop wheel event bubbling from panel\n        this.container.addEventListener('wheel', (e) => e.stopPropagation());\n\n        closeBtn.addEventListener('click', () => this.hide());\n\n        // Event for panel resizing + stop bubling\n        resizer.addEventListener('mousedown', this);\n        resizer.addEventListener('touchstart', this);\n        this.viewer.container.addEventListener('mouseup', this);\n        this.viewer.container.addEventListener('touchend', this);\n        this.viewer.container.addEventListener('mousemove', this);\n        this.viewer.container.addEventListener('touchmove', this);\n\n        this.viewer.addEventListener(KeypressEvent.type, this);\n    }\n\n    /**\n     * @internal\n     */\n    override destroy() {\n        this.viewer.removeEventListener(KeypressEvent.type, this);\n\n        this.viewer.container.removeEventListener('mousemove', this);\n        this.viewer.container.removeEventListener('touchmove', this);\n        this.viewer.container.removeEventListener('mouseup', this);\n        this.viewer.container.removeEventListener('touchend', this);\n\n        super.destroy();\n    }\n\n    /**\n     * @internal\n     */\n    handleEvent(e: Event) {\n        // prettier-ignore\n        switch (e.type) {\n            case 'mousedown': this.__onMouseDown(e as MouseEvent); break;\n            case 'touchstart': this.__onTouchStart(e as TouchEvent); break;\n            case 'mousemove': this.__onMouseMove(e as MouseEvent); break;\n            case 'touchmove': this.__onTouchMove(e as TouchEvent); break;\n            case 'mouseup': this.__onMouseUp(e as MouseEvent); break;\n            case 'touchend': this.__onTouchEnd(e as TouchEvent); break;\n            case KeypressEvent.type: this.__onKeyPress(e as KeypressEvent); break;\n        }\n    }\n\n    /**\n     * Checks if the panel is visible\n     */\n    override isVisible(id?: string) {\n        return this.state.visible && (!id || !this.state.contentId || this.state.contentId === id);\n    }\n\n    /**\n     * @throws {@link PSVError} always\n     * @internal\n     */\n    override toggle() {\n        throw new PSVError('Panel cannot be toggled');\n    }\n\n    /**\n     * Shows the panel\n     */\n    override show(config: string | PanelConfig) {\n        if (typeof config === 'string') {\n            config = { content: config };\n        }\n        const wasVisible = this.isVisible(config.id);\n\n        this.state.contentId = config.id || null;\n        this.state.visible = true;\n\n        if (this.state.clickHandler) {\n            this.content.removeEventListener('click', this.state.clickHandler);\n            this.content.removeEventListener('keydown', this.state.keyHandler);\n            this.state.clickHandler = null;\n            this.state.keyHandler = null;\n        }\n\n        if (config.id && this.state.width[config.id]) {\n            this.container.style.width = this.state.width[config.id];\n        } else if (config.width) {\n            this.container.style.width = config.width;\n        } else {\n            this.container.style.width = null;\n        }\n\n        this.content.innerHTML = config.content;\n        this.content.scrollTop = 0;\n        this.container.classList.add('psv-panel--open');\n\n        toggleClass(this.content, 'psv-panel-content--no-margin', config.noMargin === true);\n\n        if (config.clickHandler) {\n            this.state.clickHandler = (e) => {\n                (config as PanelConfig).clickHandler(e.target as HTMLElement);\n            };\n            this.state.keyHandler = (e) => {\n                if (e.key === KEY_CODES.Enter) {\n                    (config as PanelConfig).clickHandler(e.target as HTMLElement);\n                }\n            };\n            this.content.addEventListener('click', this.state.clickHandler);\n            this.content.addEventListener('keydown', this.state.keyHandler);\n\n            // focus the first element if possible, after animation ends\n            if (!wasVisible) {\n                setTimeout(() => {\n                    (this.content.querySelector('a,button,[tabindex]') as HTMLElement)?.focus();\n                }, 300);\n            }\n        }\n\n        this.viewer.dispatchEvent(new ShowPanelEvent(config.id));\n    }\n\n    /**\n     * Hides the panel\n     */\n    override hide(id?: string) {\n        if (this.isVisible(id)) {\n            const contentId = this.state.contentId;\n\n            this.state.visible = false;\n            this.state.contentId = null;\n\n            this.content.innerHTML = null;\n            this.container.classList.remove('psv-panel--open');\n\n            if (this.state.clickHandler) {\n                this.content.removeEventListener('click', this.state.clickHandler);\n                this.state.clickHandler = null;\n            }\n\n            this.viewer.dispatchEvent(new HidePanelEvent(contentId));\n        }\n    }\n\n    private __onMouseDown(evt: MouseEvent) {\n        evt.stopPropagation();\n        this.__startResize(evt.clientX, evt.clientY);\n    }\n\n    private __onTouchStart(evt: TouchEvent) {\n        evt.stopPropagation();\n        if (evt.touches.length === 1) {\n            const touch = evt.touches[0];\n            this.__startResize(touch.clientX, touch.clientY);\n        }\n    }\n\n    private __onMouseUp(evt: MouseEvent) {\n        if (this.state.mousedown) {\n            evt.stopPropagation();\n            this.state.mousedown = false;\n            this.content.classList.remove(PANEL_CLASS_NO_INTERACTION);\n        }\n    }\n\n    private __onTouchEnd(evt: TouchEvent) {\n        if (this.state.mousedown) {\n            evt.stopPropagation();\n            if (evt.touches.length === 0) {\n                this.state.mousedown = false;\n                this.content.classList.remove(PANEL_CLASS_NO_INTERACTION);\n            }\n        }\n    }\n\n    private __onMouseMove(evt: MouseEvent) {\n        if (this.state.mousedown) {\n            evt.stopPropagation();\n            this.__resize(evt.clientX, evt.clientY);\n        }\n    }\n\n    private __onTouchMove(evt: TouchEvent) {\n        if (this.state.mousedown) {\n            const touch = evt.touches[0];\n            this.__resize(touch.clientX, touch.clientY);\n        }\n    }\n\n    private __onKeyPress(evt: KeypressEvent) {\n        if (this.isVisible() && evt.key === KEY_CODES.Escape) {\n            this.hide();\n            evt.preventDefault();\n        }\n    }\n\n    private __startResize(clientX: number, clientY: number) {\n        this.state.mouseX = clientX;\n        this.state.mouseY = clientY;\n        this.state.mousedown = true;\n        this.content.classList.add(PANEL_CLASS_NO_INTERACTION);\n    }\n\n    private __resize(clientX: number, clientY: number) {\n        const x = clientX;\n        const y = clientY;\n        const width = Math.max(PANEL_MIN_WIDTH, this.container.offsetWidth - (x - this.state.mouseX)) + 'px';\n\n        if (this.state.contentId) {\n            this.state.width[this.state.contentId] = width;\n        }\n\n        this.container.style.width = width;\n\n        this.state.mouseX = x;\n        this.state.mouseY = y;\n    }\n}\n","import { PSVError } from '../PSVError';\nimport type { Viewer } from '../Viewer';\nimport { HideTooltipEvent, ShowTooltipEvent } from '../events';\nimport { addClasses, cleanCssPosition, cssPositionIsOrdered, getStyleProperty } from '../utils';\nimport { AbstractComponent } from './AbstractComponent';\n\n/**\n * Object defining the tooltip position\n */\nexport type TooltipPosition = {\n    /**\n     * Position of the tip of the arrow of the tooltip, in pixels\n     */\n    top: number;\n    /**\n     * Position of the tip of the arrow of the tooltip, in pixels\n     */\n    left: number;\n    /**\n     * Tooltip position toward it's arrow tip.\n     * Accepted values are combinations of `top`, `center`, `bottom` and `left`, `center`, `right`.\n     */\n    position?: string | [string, string];\n    /**\n     * @internal\n     */\n    box?: { width: number; height: number };\n};\n\n/**\n * Configuration for {@link Viewer.createTooltip}\n */\nexport type TooltipConfig = TooltipPosition & {\n    /**\n     * HTML content of the tooltip\n     */\n    content: string;\n    /**\n     * Additional CSS class added to the tooltip\n     */\n    className?: string;\n    /**\n     * CSS properties added to the tooltip\n     */\n    style?: Record<string, string>;\n    /**\n     * Userdata associated to the tooltip\n     */\n    data?: any;\n};\n\ntype TooltipStyle = {\n    posClass: [string, string];\n    width: number;\n    height: number;\n    top: number;\n    left: number;\n    arrowTop: number;\n    arrowLeft: number;\n};\n\nconst enum TooltipState {\n    NONE,\n    SHOWING,\n    HIDING,\n    READY,\n}\n\n/**\n * Tooltip component\n * @description Never instanciate tooltips directly use {@link Viewer#createTooltip} instead\n */\nexport class Tooltip extends AbstractComponent {\n    /**\n     * @internal\n     */\n    protected override readonly state = {\n        visible: true,\n        arrow: 0,\n        border: 0,\n        state: TooltipState.NONE,\n        width: 0,\n        height: 0,\n        pos: '',\n        config: null as TooltipPosition,\n        data: null as any,\n    };\n\n    private readonly content: HTMLElement;\n    private readonly arrow: HTMLElement;\n\n    /**\n     * @internal\n     */\n    constructor(viewer: Viewer, config: TooltipConfig) {\n        super(viewer, {\n            className: 'psv-tooltip',\n        });\n\n        this.content = document.createElement('div');\n        this.content.className = 'psv-tooltip-content';\n        this.container.appendChild(this.content);\n\n        this.arrow = document.createElement('div');\n        this.arrow.className = 'psv-tooltip-arrow';\n        this.container.appendChild(this.arrow);\n\n        this.container.addEventListener('transitionend', this);\n\n        // allows to interact with static tooltips\n        this.container.addEventListener('touchdown', (e) => e.stopPropagation());\n        this.container.addEventListener('mousedown', (e) => e.stopPropagation());\n\n        this.container.style.top = '-1000px';\n        this.container.style.left = '-1000px';\n\n        this.show(config);\n    }\n\n    /**\n     * @internal\n     */\n    handleEvent(e: Event) {\n        if (e.type === 'transitionend') {\n            this.__onTransitionEnd(e as TransitionEvent);\n        }\n    }\n\n    /**\n     * @internal\n     */\n    override destroy() {\n        delete this.state.data;\n        super.destroy();\n    }\n\n    /**\n     * @throws {@link PSVError} always\n     * @internal\n     */\n    override toggle() {\n        throw new PSVError('Tooltip cannot be toggled');\n    }\n\n    /**\n     * Displays the tooltip on the viewer\n     * @internal\n     */\n    override show(config: TooltipConfig) {\n        if (this.state.state !== TooltipState.NONE) {\n            throw new PSVError('Initialized tooltip cannot be re-initialized');\n        }\n\n        if (config.className) {\n            addClasses(this.container, config.className);\n        }\n        if (config.style) {\n            Object.assign(this.container.style, config.style);\n        }\n\n        this.state.state = TooltipState.READY;\n\n        this.update(config.content, config);\n\n        this.state.data = config.data;\n        this.state.state = TooltipState.SHOWING;\n\n        this.viewer.dispatchEvent(new ShowTooltipEvent(this, this.state.data));\n\n        this.__waitImages();\n    }\n\n    /**\n     * Updates the content of the tooltip, optionally with a new position\n     * @throws {@link PSVError} if the configuration is invalid\n     */\n    update(content: string, config?: TooltipPosition) {\n        this.content.innerHTML = content;\n\n        const rect = this.container.getBoundingClientRect();\n        this.state.width = rect.right - rect.left;\n        this.state.height = rect.bottom - rect.top;\n        this.state.arrow = parseInt(getStyleProperty(this.arrow, 'border-top-width'), 10);\n        this.state.border = parseInt(getStyleProperty(this.container, 'border-top-left-radius'), 10);\n\n        this.move(config ?? this.state.config);\n        this.__waitImages();\n    }\n\n    /**\n     * Moves the tooltip to a new position\n     * @throws {@link PSVError} if the configuration is invalid\n     */\n    move(config: TooltipPosition) {\n        if (this.state.state !== TooltipState.SHOWING && this.state.state !== TooltipState.READY) {\n            throw new PSVError('Uninitialized tooltip cannot be moved');\n        }\n\n        config.box = config.box ?? this.state.config?.box ?? { width: 0, height: 0 };\n        this.state.config = config;\n\n        const t = this.container;\n        const a = this.arrow;\n\n        // compute size\n        const style: TooltipStyle = {\n            posClass: cleanCssPosition(config.position, { allowCenter: false, cssOrder: false }) || ['top', 'center'],\n            width: this.state.width,\n            height: this.state.height,\n            top: 0,\n            left: 0,\n            arrowTop: 0,\n            arrowLeft: 0,\n        };\n\n        // set initial position\n        this.__computeTooltipPosition(style, config);\n\n        // correct position if overflow\n        let swapY = null;\n        let swapX = null;\n        if (style.top < 0) {\n            swapY = 'bottom';\n        } else if (style.top + style.height > this.viewer.state.size.height) {\n            swapY = 'top';\n        }\n        if (style.left < 0) {\n            swapX = 'right';\n        } else if (style.left + style.width > this.viewer.state.size.width) {\n            swapX = 'left';\n        }\n        if (swapX || swapY) {\n            const ordered = cssPositionIsOrdered(style.posClass);\n            if (swapY) {\n                style.posClass[ordered ? 0 : 1] = swapY;\n            }\n            if (swapX) {\n                style.posClass[ordered ? 1 : 0] = swapX;\n            }\n            this.__computeTooltipPosition(style, config);\n        }\n\n        // apply position\n        t.style.top = style.top + 'px';\n        t.style.left = style.left + 'px';\n\n        a.style.top = style.arrowTop + 'px';\n        a.style.left = style.arrowLeft + 'px';\n\n        const newPos = style.posClass.join('-');\n        if (newPos !== this.state.pos) {\n            t.classList.remove(`psv-tooltip--${this.state.pos}`);\n\n            this.state.pos = newPos;\n            t.classList.add(`psv-tooltip--${this.state.pos}`);\n        }\n    }\n\n    /**\n     * Hides the tooltip\n     */\n    override hide() {\n        this.container.classList.remove('psv-tooltip--visible');\n        this.state.state = TooltipState.HIDING;\n\n        this.viewer.dispatchEvent(new HideTooltipEvent(this.state.data));\n    }\n\n    /**\n     * Finalize transition\n     */\n    private __onTransitionEnd(e: TransitionEvent) {\n        if (e.propertyName === 'transform') {\n            switch (this.state.state) {\n                case TooltipState.SHOWING:\n                    this.container.classList.add('psv-tooltip--visible');\n                    this.state.state = TooltipState.READY;\n                    break;\n\n                case TooltipState.HIDING:\n                    this.state.state = TooltipState.NONE;\n                    this.destroy();\n                    break;\n\n                default:\n                // nothing\n            }\n        }\n    }\n\n    /**\n     * Computes the position of the tooltip and its arrow\n     */\n    private __computeTooltipPosition(style: TooltipStyle, config: TooltipPosition) {\n        const arrow = this.state.arrow;\n        const top = config.top;\n        const height = style.height;\n        const left = config.left;\n        const width = style.width;\n        const offsetSide = arrow + this.state.border;\n        const offsetX = config.box.width / 2 + arrow * 2;\n        const offsetY = config.box.height / 2 + arrow * 2;\n\n        switch (style.posClass.join('-')) {\n            case 'top-left':\n                style.top = top - offsetY - height;\n                style.left = left + offsetSide - width;\n                style.arrowTop = height;\n                style.arrowLeft = width - offsetSide - arrow;\n                break;\n            case 'top-center':\n                style.top = top - offsetY - height;\n                style.left = left - width / 2;\n                style.arrowTop = height;\n                style.arrowLeft = width / 2 - arrow;\n                break;\n            case 'top-right':\n                style.top = top - offsetY - height;\n                style.left = left - offsetSide;\n                style.arrowTop = height;\n                style.arrowLeft = arrow;\n                break;\n            case 'bottom-left':\n                style.top = top + offsetY;\n                style.left = left + offsetSide - width;\n                style.arrowTop = -arrow * 2;\n                style.arrowLeft = width - offsetSide - arrow;\n                break;\n            case 'bottom-center':\n                style.top = top + offsetY;\n                style.left = left - width / 2;\n                style.arrowTop = -arrow * 2;\n                style.arrowLeft = width / 2 - arrow;\n                break;\n            case 'bottom-right':\n                style.top = top + offsetY;\n                style.left = left - offsetSide;\n                style.arrowTop = -arrow * 2;\n                style.arrowLeft = arrow;\n                break;\n            case 'left-top':\n                style.top = top + offsetSide - height;\n                style.left = left - offsetX - width;\n                style.arrowTop = height - offsetSide - arrow;\n                style.arrowLeft = width;\n                break;\n            case 'center-left':\n                style.top = top - height / 2;\n                style.left = left - offsetX - width;\n                style.arrowTop = height / 2 - arrow;\n                style.arrowLeft = width;\n                break;\n            case 'left-bottom':\n                style.top = top - offsetSide;\n                style.left = left - offsetX - width;\n                style.arrowTop = arrow;\n                style.arrowLeft = width;\n                break;\n            case 'right-top':\n                style.top = top + offsetSide - height;\n                style.left = left + offsetX;\n                style.arrowTop = height - offsetSide - arrow;\n                style.arrowLeft = -arrow * 2;\n                break;\n            case 'center-right':\n                style.top = top - height / 2;\n                style.left = left + offsetX;\n                style.arrowTop = height / 2 - arrow;\n                style.arrowLeft = -arrow * 2;\n                break;\n            case 'right-bottom':\n                style.top = top - offsetSide;\n                style.left = left + offsetX;\n                style.arrowTop = arrow;\n                style.arrowLeft = -arrow * 2;\n                break;\n\n            // no default\n        }\n    }\n\n    /**\n     * If the tooltip contains images, recompute its size once they are loaded\n     */\n    private __waitImages() {\n        const images = this.content.querySelectorAll('img') as NodeListOf<HTMLImageElement>;\n\n        if (images.length > 0) {\n            const promises: Array<Promise<any>> = [];\n\n            images.forEach((image) => {\n                if (!image.complete) {\n                    promises.push(\n                        new Promise((resolve) => {\n                            image.onload = resolve;\n                            image.onerror = resolve;\n                        })\n                    );\n                }\n            });\n\n            if (promises.length) {\n                Promise.all(promises).then(() => {\n                    if (this.state.state === TooltipState.SHOWING || this.state.state === TooltipState.READY) {\n                        const rect = this.container.getBoundingClientRect();\n                        this.state.width = rect.right - rect.left;\n                        this.state.height = rect.bottom - rect.top;\n                        this.move(this.state.config);\n                    }\n                });\n            }\n        }\n    }\n}\n","<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"15 15 70 70\"><path fill=\"currentColor\" d=\"M50,16.2c-18.6,0-33.8,15.1-33.8,33.8S31.4,83.7,50,83.7S83.8,68.6,83.8,50S68.6,16.2,50,16.2z M50,80.2c-16.7,0-30.2-13.6-30.2-30.2S33.3,19.7,50,19.7S80.3,33.3,80.3,50S66.7,80.2,50,80.2z\"/><rect fill=\"currentColor\" x=\"48\" y=\"31.7\" width=\"4\" height=\"28\"/><rect fill=\"currentColor\" x=\"48\" y=\"63.2\" width=\"4\" height=\"5\"/><!--Created by Shastry from the Noun Project--></svg>\n","import { Euler, MathUtils, Vector3 } from 'three';\nimport { ANIMATION_MIN_DURATION, SPHERE_RADIUS, VIEWER_DATA } from '../data/constants';\nimport { ExtendedPosition, PanoData, PanoramaPosition, Point, Position, SphereCorrection } from '../model';\nimport { PSVError } from '../PSVError';\nimport {\n    AnimationOptions,\n    applyEulerInverse,\n    getAngle,\n    getShortestArc,\n    isExtendedPosition,\n    isNil,\n    parseAngle,\n    speedToDuration,\n} from '../utils';\nimport type { Viewer } from '../Viewer';\nimport { AbstractService } from './AbstractService';\n\nconst vector3 = new Vector3();\nconst EULER_ZERO = new Euler(0, 0, 0, 'ZXY');\n\n/**\n * Collections of data converters for the viewer\n */\nexport class DataHelper extends AbstractService {\n    /**\n     * @internal\n     */\n    constructor(viewer: Viewer) {\n        super(viewer);\n    }\n\n    /**\n     * Converts vertical FOV to zoom level\n     */\n    fovToZoomLevel(fov: number): number {\n        const temp = Math.round(((fov - this.config.minFov) / (this.config.maxFov - this.config.minFov)) * 100);\n        return temp - 2 * (temp - 50);\n    }\n\n    /**\n     * Converts zoom level to vertical FOV\n     */\n    zoomLevelToFov(level: number): number {\n        return this.config.maxFov + (level / 100) * (this.config.minFov - this.config.maxFov);\n    }\n\n    /**\n     * Converts vertical FOV to horizontal FOV\n     */\n    vFovToHFov(vFov: number): number {\n        return MathUtils.radToDeg(2 * Math.atan(Math.tan(MathUtils.degToRad(vFov) / 2) * this.state.aspect));\n    }\n\n    /**\n     * @internal\n     */\n    getAnimationProperties(\n        speed: number | string,\n        targetPosition: Position,\n        targetZoom: number\n    ): {\n        duration: number;\n        properties: AnimationOptions<{ yaw: any; pitch: any; zoom: any }>['properties'];\n    } {\n        const positionProvided = !isNil(targetPosition);\n        const zoomProvided = !isNil(targetZoom);\n\n        const properties: AnimationOptions<{ yaw: any; pitch: any; zoom: any }>['properties'] = {};\n        let duration = null;\n\n        // clean/filter position and compute duration\n        if (positionProvided) {\n            const currentPosition = this.viewer.getPosition();\n            const dYaw = getShortestArc(currentPosition.yaw, targetPosition.yaw);\n\n            properties.yaw = { start: currentPosition.yaw, end: currentPosition.yaw + dYaw };\n            properties.pitch = { start: currentPosition.pitch, end: targetPosition.pitch };\n\n            duration = speedToDuration(speed, getAngle(currentPosition, targetPosition));\n        }\n\n        // clean/filter zoom and compute duration\n        if (zoomProvided) {\n            const currentZoom = this.viewer.getZoomLevel();\n            const dZoom = Math.abs(targetZoom - currentZoom);\n\n            properties.zoom = { start: currentZoom, end: targetZoom };\n\n            if (duration === null) {\n                // if animating zoom only and a speed is given, use an arbitrary PI/4 to compute the duration\n                duration = speedToDuration(speed, ((Math.PI / 4) * dZoom) / 100);\n            }\n        }\n\n        // if nothing to animate\n        if (duration === null) {\n            if (typeof speed === 'number') {\n                duration = speed;\n            } else {\n                duration = ANIMATION_MIN_DURATION;\n            }\n        } else {\n            duration = Math.max(ANIMATION_MIN_DURATION, duration);\n        }\n\n        return { duration, properties };\n    }\n\n    /**\n     * Converts pixel texture coordinates to spherical radians coordinates\n     * @throws {@link PSVError} when the current adapter does not support texture coordinates\n     */\n    textureCoordsToSphericalCoords(point: PanoramaPosition): Position {\n        if (!this.state.textureData?.panoData) {\n            throw new PSVError('Current adapter does not support texture coordinates or no texture has been loaded');\n        }\n\n        const result = this.viewer.adapter.textureCoordsToSphericalCoords(point, this.state.textureData.panoData);\n\n        if (\n            !EULER_ZERO.equals(this.viewer.renderer.panoramaPose) \n            || !EULER_ZERO.equals(this.viewer.renderer.sphereCorrection)\n        ) {\n            this.sphericalCoordsToVector3(result, vector3);\n            vector3.applyEuler(this.viewer.renderer.panoramaPose);\n            vector3.applyEuler(this.viewer.renderer.sphereCorrection);\n            return this.vector3ToSphericalCoords(vector3);\n        } else {\n            return result;\n        }\n    }\n\n    /**\n     * Converts spherical radians coordinates to pixel texture coordinates\n     * @throws {@link PSVError} when the current adapter does not support texture coordinates\n     */\n    sphericalCoordsToTextureCoords(position: Position): PanoramaPosition {\n        if (!this.state.textureData?.panoData) {\n            throw new PSVError('Current adapter does not support texture coordinates or no texture has been loaded');\n        }\n\n        if (\n            !EULER_ZERO.equals(this.viewer.renderer.panoramaPose) \n            || !EULER_ZERO.equals(this.viewer.renderer.sphereCorrection)\n        ) {\n            this.sphericalCoordsToVector3(position, vector3);\n            applyEulerInverse(vector3, this.viewer.renderer.sphereCorrection);\n            applyEulerInverse(vector3, this.viewer.renderer.panoramaPose);\n            position = this.vector3ToSphericalCoords(vector3);\n        }\n\n        return this.viewer.adapter.sphericalCoordsToTextureCoords(position, this.state.textureData.panoData);\n    }\n\n    /**\n     * Converts spherical radians coordinates to a Vector3\n     */\n    sphericalCoordsToVector3(position: Position, vector?: Vector3, distance = SPHERE_RADIUS): Vector3 {\n        if (!vector) {\n            vector = new Vector3();\n        }\n        vector.x = distance * -Math.cos(position.pitch) * Math.sin(position.yaw);\n        vector.y = distance * Math.sin(position.pitch);\n        vector.z = distance * Math.cos(position.pitch) * Math.cos(position.yaw);\n        return vector;\n    }\n\n    /**\n     * Converts a Vector3 to spherical radians coordinates\n     */\n    vector3ToSphericalCoords(vector: Vector3): Position {\n        const phi = Math.acos(vector.y / Math.sqrt(vector.x * vector.x + vector.y * vector.y + vector.z * vector.z));\n        const theta = Math.atan2(vector.x, vector.z);\n\n        return {\n            yaw: theta < 0 ? -theta : Math.PI * 2 - theta,\n            pitch: Math.PI / 2 - phi,\n        };\n    }\n\n    /**\n     * Converts position on the viewer to a THREE.Vector3\n     */\n    viewerCoordsToVector3(viewerPoint: Point): Vector3 {\n        const sphereIntersect = this.viewer.renderer\n            .getIntersections(viewerPoint)\n            .filter((i) => i.object.userData[VIEWER_DATA]);\n\n        if (sphereIntersect.length) {\n            return sphereIntersect[0].point;\n        } else {\n            return null;\n        }\n    }\n\n    /**\n     * Converts position on the viewer to spherical radians coordinates\n     */\n    viewerCoordsToSphericalCoords(viewerPoint: Point): Position {\n        const vector = this.viewerCoordsToVector3(viewerPoint);\n        return vector ? this.vector3ToSphericalCoords(vector) : null;\n    }\n\n    /**\n     * Converts a Vector3 to position on the viewer\n     */\n    vector3ToViewerCoords(vector: Vector3): Point {\n        const vectorClone = vector.clone();\n        vectorClone.project(this.viewer.renderer.camera);\n\n        return {\n            x: Math.round(((vectorClone.x + 1) / 2) * this.state.size.width),\n            y: Math.round(((1 - vectorClone.y) / 2) * this.state.size.height),\n        };\n    }\n\n    /**\n     * Converts spherical radians coordinates to position on the viewer\n     */\n    sphericalCoordsToViewerCoords(position: Position): Point {\n        this.sphericalCoordsToVector3(position, vector3);\n        return this.vector3ToViewerCoords(vector3);\n    }\n\n    /**\n     * Checks if a point in the 3D scene is currently visible\n     */\n    isPointVisible(vector: Vector3): boolean;\n\n    /**\n     * Checks if a point on the sphere is currently visible\n     */\n    isPointVisible(position: Position): boolean;\n\n    /**\n     * @internal\n     */\n    isPointVisible(point: Vector3 | Position): boolean {\n        let vector: Vector3;\n        let viewerPoint: Point;\n\n        if (point instanceof Vector3) {\n            vector = point;\n            viewerPoint = this.vector3ToViewerCoords(point);\n        } else if (isExtendedPosition(point)) {\n            vector = this.sphericalCoordsToVector3(point, vector3);\n            viewerPoint = this.vector3ToViewerCoords(vector);\n        } else {\n            return false;\n        }\n\n        return (\n            vector.dot(this.viewer.state.direction) > 0\n            && viewerPoint.x >= 0\n            && viewerPoint.x <= this.viewer.state.size.width\n            && viewerPoint.y >= 0\n            && viewerPoint.y <= this.viewer.state.size.height\n        );\n    }\n\n    /**\n     * Converts pixel position to angles if present and ensure boundaries\n     */\n    cleanPosition(position: ExtendedPosition): Position {\n        if ('yaw' in position || 'pitch' in position) {\n            if (!('yaw' in position) || !('pitch' in position)) {\n                throw new PSVError(`Position is missing 'yaw' or 'pitch'`);\n            }\n            return {\n                yaw: parseAngle(position.yaw),\n                pitch: parseAngle(position.pitch, !this.state.littlePlanet),\n            };\n        } else {\n            return this.textureCoordsToSphericalCoords(position);\n        }\n    }\n\n    /**\n     * Ensure a SphereCorrection object is valid\n     */\n    cleanSphereCorrection(sphereCorrection: SphereCorrection): SphereCorrection {\n        return {\n            pan: parseAngle(sphereCorrection?.pan || 0),\n            tilt: parseAngle(sphereCorrection?.tilt || 0, true),\n            roll: parseAngle(sphereCorrection?.roll || 0, true, false),\n        };\n    }\n\n    /**\n     * Parse the pose angles of the pano data\n     */\n    cleanPanoramaPose(panoData: PanoData): SphereCorrection {\n        return {\n            pan: MathUtils.degToRad(panoData?.poseHeading || 0),\n            tilt: MathUtils.degToRad(panoData?.posePitch || 0),\n            roll: MathUtils.degToRad(panoData?.poseRoll || 0),\n        };\n    }\n}\n","import { ParsedViewerConfig } from '../model';\nimport type { Viewer } from '../Viewer';\nimport { ViewerState } from './ViewerState';\n\n/**\n * Base class for services\n */\nexport abstract class AbstractService {\n    protected readonly config: ParsedViewerConfig;\n    protected readonly state: ViewerState;\n\n    /**\n     * @internal\n     */\n    constructor(protected readonly viewer: Viewer) {\n        this.config = viewer.config;\n        this.state = viewer.state;\n    }\n\n    /**\n     * Destroys the service\n     * @internal\n     */\n    // eslint-disable-next-line @typescript-eslint/no-empty-function\n    destroy() {}\n}\n","import { MathUtils, Mesh, SplineCurve, Vector2 } from 'three';\nimport {\n    ACTIONS,\n    CAPTURE_EVENTS_CLASS,\n    CTRLZOOM_TIMEOUT,\n    DBLCLICK_DELAY,\n    IDS,\n    INERTIA_WINDOW,\n    KEY_CODES,\n    LONGTOUCH_DELAY,\n    MOVE_THRESHOLD,\n    TWOFINGERSOVERLAY_DELAY,\n    VIEWER_DATA,\n} from '../data/constants';\nimport { SYSTEM } from '../data/system';\nimport {\n    ClickEvent,\n    DoubleClickEvent,\n    FullscreenEvent,\n    KeypressEvent,\n    ObjectEnterEvent,\n    ObjectHoverEvent,\n    ObjectLeaveEvent,\n    ViewerEvents,\n} from '../events';\nimport gestureIcon from '../icons/gesture.svg';\nimport mousewheelIcon from '../icons/mousewheel.svg';\nimport { ClickData, Point, Position } from '../model';\nimport {\n    Animation,\n    clone,\n    distance,\n    getClosest,\n    getPosition,\n    getTouchData,\n    hasParent,\n    isEmpty,\n    throttle,\n} from '../utils';\nimport { PressHandler } from '../utils/PressHandler';\nimport type { Viewer } from '../Viewer';\nimport { AbstractService } from './AbstractService';\n\nclass Step {\n    static IDLE = 0;\n    static CLICK = 1;\n    static MOVING = 2;\n    static INERTIA = 4;\n\n    private $: number = Step.IDLE;\n\n    is(...steps: number[]): boolean {\n        return steps.some((step) => this.$ & step);\n    }\n\n    set(step: number) {\n        this.$ = step;\n    }\n\n    add(step: number) {\n        this.$ |= step;\n    }\n\n    remove(step: number) {\n        this.$ &= ~step;\n    }\n}\n\n/**\n * Events handler\n * @internal\n */\nexport class EventsHandler extends AbstractService {\n    private readonly data = {\n        /** start x position of the click/touch */\n        startMouseX: 0,\n        /** start y position of the click/touch */\n        startMouseY: 0,\n        /** current x position of the cursor */\n        mouseX: 0,\n        /** current y position of the cursor */\n        mouseY: 0,\n        /** list of latest positions of the cursor, [time, x, y] */\n        mouseHistory: [] as Array<[number, number, number]>,\n        /** distance between fingers when zooming */\n        pinchDist: 0,\n        /** when the Ctrl key is pressed */\n        ctrlKeyDown: false,\n        /** temporary storage of click data between two clicks */\n        dblclickData: null as ClickData,\n        dblclickTimeout: null as ReturnType<typeof setTimeout>,\n        longtouchTimeout: null as ReturnType<typeof setTimeout>,\n        twofingersTimeout: null as ReturnType<typeof setTimeout>,\n        ctrlZoomTimeout: null as ReturnType<typeof setTimeout>,\n    };\n\n    private readonly step = new Step();\n    private readonly keyHandler = new PressHandler();\n    private readonly resizeObserver = new ResizeObserver(throttle(() => this.viewer.autoSize(), 50));\n    private readonly moveThreshold = MOVE_THRESHOLD * SYSTEM.pixelRatio;\n\n    constructor(viewer: Viewer) {\n        super(viewer);\n    }\n\n    /**\n     * @internal\n     */\n    init() {\n        window.addEventListener('keydown', this, { passive: false });\n        window.addEventListener('keyup', this);\n        this.viewer.container.addEventListener('mousedown', this);\n        window.addEventListener('mousemove', this, { passive: false });\n        window.addEventListener('mouseup', this);\n        this.viewer.container.addEventListener('touchstart', this, { passive: false });\n        window.addEventListener('touchmove', this, { passive: false });\n        window.addEventListener('touchend', this, { passive: false });\n        this.viewer.container.addEventListener('wheel', this, { passive: false });\n        document.addEventListener(SYSTEM.fullscreenEvent, this);\n        this.resizeObserver.observe(this.viewer.container);\n    }\n\n    override destroy() {\n        window.removeEventListener('keydown', this);\n        window.removeEventListener('keyup', this);\n        this.viewer.container.removeEventListener('mousedown', this);\n        window.removeEventListener('mousemove', this);\n        window.removeEventListener('mouseup', this);\n        this.viewer.container.removeEventListener('touchstart', this);\n        window.removeEventListener('touchmove', this);\n        window.removeEventListener('touchend', this);\n        this.viewer.container.removeEventListener('wheel', this);\n        document.removeEventListener(SYSTEM.fullscreenEvent, this);\n        this.resizeObserver.disconnect();\n\n        clearTimeout(this.data.dblclickTimeout);\n        clearTimeout(this.data.longtouchTimeout);\n        clearTimeout(this.data.twofingersTimeout);\n        clearTimeout(this.data.ctrlZoomTimeout);\n\n        super.destroy();\n    }\n\n    /**\n     * @internal\n     */\n    handleEvent(evt: Event) {\n        // prettier-ignore\n        switch (evt.type) {\n            case 'keydown': this.__onKeyDown(evt as KeyboardEvent); break;\n            case 'keyup': this.__onKeyUp(); break;\n            case 'mousemove': this.__onMouseMove(evt as MouseEvent); break;\n            case 'mouseup': this.__onMouseUp(evt as MouseEvent); break;\n            case 'touchmove': this.__onTouchMove(evt as TouchEvent); break;\n            case 'touchend': this.__onTouchEnd(evt as TouchEvent); break;\n            case SYSTEM.fullscreenEvent: this.__onFullscreenChange(); break;\n        }\n\n        if (!getClosest(evt.target as HTMLElement, '.' + CAPTURE_EVENTS_CLASS)) {\n            // prettier-ignore\n            switch (evt.type) {\n                case 'mousedown': this.__onMouseDown(evt as MouseEvent); break;\n                case 'touchstart': this.__onTouchStart(evt as TouchEvent); break;\n                case 'wheel': this.__onMouseWheel(evt as WheelEvent); break;\n            }\n        }\n    }\n\n    /**\n     * Handles keyboard events\n     */\n    private __onKeyDown(e: KeyboardEvent) {\n        if (this.config.mousewheelCtrlKey) {\n            this.data.ctrlKeyDown = e.key === KEY_CODES.Control;\n\n            if (this.data.ctrlKeyDown) {\n                clearTimeout(this.data.ctrlZoomTimeout);\n                this.viewer.overlay.hide(IDS.CTRL_ZOOM);\n            }\n        }\n\n        if (!this.viewer.dispatchEvent(new KeypressEvent(e.key))) {\n            return;\n        }\n\n        if (!this.state.keyboardEnabled) {\n            return;\n        }\n\n        const action = this.config.keyboardActions?.[e.key];\n\n        if (typeof action === 'function') {\n            action(this.viewer);\n            e.preventDefault();\n        } else if (action && !this.keyHandler.pending) {\n            if (action !== ACTIONS.ZOOM_IN && action !== ACTIONS.ZOOM_OUT) {\n                this.viewer.stopAll();\n            }\n\n            // prettier-ignore\n            switch (action) {\n                case ACTIONS.ROTATE_UP: this.viewer.dynamics.position.roll({ pitch: false }); break;\n                case ACTIONS.ROTATE_DOWN: this.viewer.dynamics.position.roll({ pitch: true }); break;\n                case ACTIONS.ROTATE_RIGHT: this.viewer.dynamics.position.roll({ yaw: false }); break;\n                case ACTIONS.ROTATE_LEFT: this.viewer.dynamics.position.roll({ yaw: true }); break;\n                case ACTIONS.ZOOM_IN: this.viewer.dynamics.zoom.roll(false); break;\n                case ACTIONS.ZOOM_OUT: this.viewer.dynamics.zoom.roll(true); break;\n            }\n\n            this.keyHandler.down();\n            e.preventDefault();\n        }\n    }\n\n    /**\n     * Handles keyboard events\n     */\n    private __onKeyUp() {\n        this.data.ctrlKeyDown = false;\n\n        if (!this.state.keyboardEnabled) {\n            return;\n        }\n\n        this.keyHandler.up(() => {\n            this.viewer.dynamics.position.stop();\n            this.viewer.dynamics.zoom.stop();\n            this.viewer.resetIdleTimer();\n        });\n    }\n\n    /**\n     * Handles mouse down events\n     */\n    private __onMouseDown(evt: MouseEvent) {\n        this.step.add(Step.CLICK);\n        this.data.startMouseX = evt.clientX;\n        this.data.startMouseY = evt.clientY;\n    }\n\n    /**\n     *Handles mouse up events\n     */\n    private __onMouseUp(evt: MouseEvent) {\n        if (this.step.is(Step.CLICK, Step.MOVING)) {\n            this.__stopMove(evt.clientX, evt.clientY, evt.target, evt.button === 2);\n        }\n    }\n\n    /**\n     * Handles mouse move events\n     */\n    private __onMouseMove(evt: MouseEvent) {\n        if (this.config.mousemove && this.step.is(Step.CLICK, Step.MOVING)) {\n            evt.preventDefault();\n            this.__doMove(evt.clientX, evt.clientY);\n        }\n\n        this.__handleObjectsEvents(evt);\n    }\n\n    /**\n     * Handles touch events\n     */\n    private __onTouchStart(evt: TouchEvent) {\n        if (evt.touches.length === 1) {\n            this.step.add(Step.CLICK);\n            this.data.startMouseX = evt.touches[0].clientX;\n            this.data.startMouseY = evt.touches[0].clientY;\n\n            if (!this.data.longtouchTimeout) {\n                this.data.longtouchTimeout = setTimeout(() => {\n                    const touch = evt.touches[0];\n                    this.__stopMove(touch.clientX, touch.clientY, touch.target, true);\n                    this.data.longtouchTimeout = null;\n                }, LONGTOUCH_DELAY);\n            }\n        } else if (evt.touches.length === 2) {\n            this.step.set(Step.IDLE);\n            this.__cancelLongTouch();\n\n            if (this.config.mousemove) {\n                this.__cancelTwoFingersOverlay();\n                this.__startMoveZoom(evt);\n                evt.preventDefault();\n            }\n        }\n    }\n\n    /**\n     * Handles touch events\n     */\n    private __onTouchEnd(evt: TouchEvent) {\n        this.__cancelLongTouch();\n\n        if (this.step.is(Step.CLICK, Step.MOVING)) {\n            evt.preventDefault();\n            this.__cancelTwoFingersOverlay();\n\n            if (evt.touches.length === 1) {\n                this.__stopMove(this.data.mouseX, this.data.mouseY);\n            } else if (evt.touches.length === 0) {\n                const touch = evt.changedTouches[0];\n                this.__stopMove(touch.clientX, touch.clientY, touch.target);\n            }\n        }\n    }\n\n    /**\n     * Handles touch move events\n     */\n    private __onTouchMove(evt: TouchEvent) {\n        this.__cancelLongTouch();\n\n        if (!this.config.mousemove) {\n            return;\n        }\n\n        if (evt.touches.length === 1) {\n            if (this.config.touchmoveTwoFingers) {\n                if (this.step.is(Step.CLICK) && !this.data.twofingersTimeout) {\n                    this.data.twofingersTimeout = setTimeout(() => {\n                        this.viewer.overlay.show({\n                            id: IDS.TWO_FINGERS,\n                            image: gestureIcon,\n                            title: this.config.lang.twoFingers,\n                        });\n                    }, TWOFINGERSOVERLAY_DELAY);\n                }\n            } else if (this.step.is(Step.CLICK, Step.MOVING)) {\n                evt.preventDefault();\n                const touch = evt.touches[0];\n                this.__doMove(touch.clientX, touch.clientY);\n            }\n        } else {\n            this.__doMoveZoom(evt);\n            this.__cancelTwoFingersOverlay();\n        }\n    }\n\n    /**\n     * Cancel the long touch timer if any\n     */\n    private __cancelLongTouch() {\n        if (this.data.longtouchTimeout) {\n            clearTimeout(this.data.longtouchTimeout);\n            this.data.longtouchTimeout = null;\n        }\n    }\n\n    /**\n     * Cancel the two fingers overlay timer if any\n     */\n    private __cancelTwoFingersOverlay() {\n        if (this.config.touchmoveTwoFingers) {\n            if (this.data.twofingersTimeout) {\n                clearTimeout(this.data.twofingersTimeout);\n                this.data.twofingersTimeout = null;\n            }\n            this.viewer.overlay.hide(IDS.TWO_FINGERS);\n        }\n    }\n\n    /**\n     * Handles mouse wheel events\n     */\n    private __onMouseWheel(evt: WheelEvent) {\n        if (!this.config.mousewheel || !evt.deltaY) {\n            return;\n        }\n\n        if (this.config.mousewheelCtrlKey && !this.data.ctrlKeyDown) {\n            this.viewer.overlay.show({\n                id: IDS.CTRL_ZOOM,\n                image: mousewheelIcon,\n                title: this.config.lang.ctrlZoom,\n            });\n\n            clearTimeout(this.data.ctrlZoomTimeout);\n            this.data.ctrlZoomTimeout = setTimeout(() => this.viewer.overlay.hide(IDS.CTRL_ZOOM), CTRLZOOM_TIMEOUT);\n\n            return;\n        }\n\n        evt.preventDefault();\n        evt.stopPropagation();\n\n        const delta = (evt.deltaY / Math.abs(evt.deltaY)) * 5 * this.config.zoomSpeed;\n        if (delta !== 0) {\n            this.viewer.dynamics.zoom.step(-delta, 5);\n        }\n    }\n\n    /**\n     * Handles fullscreen events\n     */\n    private __onFullscreenChange() {\n        const fullscreen = this.viewer.isFullscreenEnabled();\n\n        if (this.config.keyboard === 'fullscreen') {\n            if (fullscreen) {\n                this.viewer.startKeyboardControl();\n            } else {\n                this.viewer.stopKeyboardControl();\n            }\n        }\n\n        this.viewer.dispatchEvent(new FullscreenEvent(fullscreen));\n    }\n\n    /**\n     * Resets all state variables\n     */\n    private __resetMove() {\n        this.step.set(Step.IDLE);\n        this.data.mouseX = 0;\n        this.data.mouseY = 0;\n        this.data.startMouseX = 0;\n        this.data.startMouseY = 0;\n        this.data.mouseHistory.length = 0;\n    }\n\n    /**\n     * Initializes the combines move and zoom\n     */\n    private __startMoveZoom(evt: TouchEvent) {\n        this.viewer.stopAll(); // TODO nom ?\n        this.__resetMove();\n\n        const touchData = getTouchData(evt);\n\n        this.step.set(Step.MOVING);\n        ({\n            distance: this.data.pinchDist,\n            center: { x: this.data.mouseX, y: this.data.mouseY },\n        } = touchData);\n\n        this.__logMouseMove(this.data.mouseX, this.data.mouseY);\n    }\n\n    /**\n     * Stops the movement\n     * @description If the move threshold was not reached a click event is triggered, otherwise an animation is launched to simulate inertia\n     */\n    private __stopMove(clientX: number, clientY: number, target?: EventTarget, rightclick = false) {\n        if (this.step.is(Step.MOVING)) {\n            if (this.config.moveInertia) {\n                this.__logMouseMove(clientX, clientY);\n                this.__stopMoveInertia(clientX, clientY);\n            } else {\n                this.__resetMove();\n                this.viewer.resetIdleTimer();\n            }\n        } else {\n            if (this.step.is(Step.CLICK) && !this.__moveThresholdReached(clientX, clientY)) {\n                this.__doClick(clientX, clientY, target, rightclick);\n            }\n            this.step.remove(Step.CLICK);\n            if (!this.step.is(Step.INERTIA)) {\n                this.__resetMove();\n                this.viewer.resetIdleTimer();\n            }\n        }\n    }\n\n    /**\n     * Performs an animation to simulate inertia when the movement stops\n     */\n    private __stopMoveInertia(clientX: number, clientY: number) {\n        // get direction at end of movement\n        const curve = new SplineCurve(this.data.mouseHistory.map(([, x, y]) => new Vector2(x, y)));\n        const direction = curve.getTangent(1);\n\n        // average speed\n        // prettier-ignore\n        const speed = this.data.mouseHistory.reduce(({ total, prev }, curr) => ({\n            total: !prev ? 0 : total + distance({ x: prev[1], y: prev[2] }, { x: curr[1], y: curr[2] }) / (curr[0] - prev[0]),\n            prev: curr,\n        }), {\n            total: 0,\n            prev: null,\n        }).total / this.data.mouseHistory.length;\n\n        if (!speed) {\n            this.__resetMove();\n            this.viewer.resetIdleTimer();\n            return;\n        }\n\n        this.step.set(Step.INERTIA);\n\n        let currentClientX = clientX;\n        let currentClientY = clientY;\n\n        this.state.animation = new Animation({\n            properties: {\n                speed: { start: speed, end: 0 },\n            },\n            duration: 1000,\n            easing: 'outQuad',\n            onTick: (properties) => {\n                // 3 is a magic number\n                currentClientX += properties.speed * direction.x * 3 * SYSTEM.pixelRatio;\n                currentClientY += properties.speed * direction.y * 3 * SYSTEM.pixelRatio;\n                this.__applyMove(currentClientX, currentClientY);\n            },\n        });\n\n        this.state.animation.then((done) => {\n            this.state.animation = null;\n            if (done) {\n                this.__resetMove();\n                this.viewer.resetIdleTimer();\n            }\n        });\n    }\n\n    /**\n     * Triggers an event with all coordinates when a simple click is performed\n     */\n    private __doClick(clientX: number, clientY: number, target: EventTarget, rightclick = false) {\n        const boundingRect = this.viewer.container.getBoundingClientRect();\n\n        const viewerX = clientX - boundingRect.left;\n        const viewerY = clientY - boundingRect.top;\n\n        const intersections = this.viewer.renderer.getIntersections({ x: viewerX, y: viewerY });\n        const sphereIntersection = intersections.find((i) => i.object.userData[VIEWER_DATA]);\n\n        if (sphereIntersection) {\n            const sphericalCoords = this.viewer.dataHelper.vector3ToSphericalCoords(sphereIntersection.point);\n\n            const data: ClickData = {\n                rightclick: rightclick,\n                target: target as HTMLElement,\n                clientX,\n                clientY,\n                viewerX,\n                viewerY,\n                yaw: sphericalCoords.yaw,\n                pitch: sphericalCoords.pitch,\n                objects: intersections.map((i) => i.object).filter((o) => !o.userData[VIEWER_DATA]),\n            };\n\n            try {\n                const textureCoords = this.viewer.dataHelper.sphericalCoordsToTextureCoords(data);\n                Object.assign(data, textureCoords);\n            } catch (e) {\n                // nothing\n            }\n\n            if (!this.data.dblclickTimeout) {\n                this.viewer.dispatchEvent(new ClickEvent(data));\n\n                this.data.dblclickData = clone(data);\n                this.data.dblclickTimeout = setTimeout(() => {\n                    this.data.dblclickTimeout = null;\n                    this.data.dblclickData = null;\n                }, DBLCLICK_DELAY);\n            } else {\n                if (\n                    Math.abs(this.data.dblclickData.clientX - data.clientX) < this.moveThreshold\n                    && Math.abs(this.data.dblclickData.clientY - data.clientY) < this.moveThreshold\n                ) {\n                    this.viewer.dispatchEvent(new DoubleClickEvent(this.data.dblclickData));\n                }\n\n                clearTimeout(this.data.dblclickTimeout);\n                this.data.dblclickTimeout = null;\n                this.data.dblclickData = null;\n            }\n        }\n    }\n\n    /**\n     * Trigger events for observed THREE objects\n     */\n    private __handleObjectsEvents(evt: MouseEvent) {\n        if (!isEmpty(this.state.objectsObservers) && hasParent(evt.target as HTMLElement, this.viewer.container)) {\n            const viewerPos = getPosition(this.viewer.container);\n\n            const viewerPoint: Point = {\n                x: evt.clientX - viewerPos.x,\n                y: evt.clientY - viewerPos.y,\n            };\n\n            const intersections = this.viewer.renderer.getIntersections(viewerPoint);\n\n            const emit = (\n                object: Mesh,\n                key: string,\n                evtCtor: new (e: MouseEvent, o: Mesh, pt: Point, data: any) => ViewerEvents\n            ) => {\n                this.viewer.dispatchEvent(new evtCtor(evt, object, viewerPoint, key));\n            };\n\n            for (const [key, object] of Object.entries(this.state.objectsObservers) as Array<[string, Mesh | null]>) {\n                const intersection = intersections.find((i) => i.object.userData[key]);\n\n                if (intersection) {\n                    if (object && intersection.object !== object) {\n                        emit(object, key, ObjectLeaveEvent);\n                        this.state.objectsObservers[key] = null;\n                    }\n\n                    if (!object) {\n                        this.state.objectsObservers[key] = intersection.object;\n                        emit(intersection.object, key, ObjectEnterEvent);\n                    } else {\n                        emit(intersection.object, key, ObjectHoverEvent);\n                    }\n                } else if (object) {\n                    emit(object, key, ObjectLeaveEvent);\n                    this.state.objectsObservers[key] = null;\n                }\n            }\n        }\n    }\n\n    /**\n     * Starts moving when crossing moveThreshold and performs movement\n     */\n    private __doMove(clientX: number, clientY: number) {\n        if (this.step.is(Step.CLICK) && this.__moveThresholdReached(clientX, clientY)) {\n            this.viewer.stopAll();\n            this.__resetMove();\n            this.step.set(Step.MOVING);\n            this.data.mouseX = clientX;\n            this.data.mouseY = clientY;\n            this.__logMouseMove(clientX, clientY);\n        } else if (this.step.is(Step.MOVING)) {\n            this.__applyMove(clientX, clientY);\n            this.__logMouseMove(clientX, clientY);\n        }\n    }\n\n    /**\n     * Checks if the cursor was move beyond the move threshold\n     */\n    private __moveThresholdReached(clientX: number, clientY: number) {\n        return (\n            Math.abs(clientX - this.data.startMouseX) >= this.moveThreshold\n            || Math.abs(clientY - this.data.startMouseY) >= this.moveThreshold\n        );\n    }\n\n    /**\n     * Raw method for movement, called from mouse event and move inertia\n     */\n    private __applyMove(clientX: number, clientY: number) {\n        const x = (clientX - this.data.mouseX) * Math.cos(this.state.roll) - (clientY - this.data.mouseY) * Math.sin(this.state.roll);\n        const y = (clientY - this.data.mouseY) * Math.cos(this.state.roll) + (clientX - this.data.mouseX) * Math.sin(this.state.roll);\n\n        const rotation: Position = {\n            yaw:\n                this.config.moveSpeed\n                * (x / this.state.size.width)\n                * MathUtils.degToRad(this.state.littlePlanet ? 90 : this.state.hFov),\n            pitch:\n                this.config.moveSpeed\n                * (y / this.state.size.height)\n                * MathUtils.degToRad(this.state.littlePlanet ? 90 : this.state.vFov),\n        };\n\n        const currentPosition = this.viewer.getPosition();\n        this.viewer.rotate({\n            yaw: currentPosition.yaw - rotation.yaw,\n            pitch: currentPosition.pitch + rotation.pitch,\n        });\n\n        this.data.mouseX = clientX;\n        this.data.mouseY = clientY;\n    }\n\n    /**\n     * Perfoms combined move and zoom\n     */\n    private __doMoveZoom(evt: TouchEvent) {\n        if (this.step.is(Step.MOVING)) {\n            evt.preventDefault();\n\n            const touchData = getTouchData(evt);\n            const delta = ((touchData.distance - this.data.pinchDist) / SYSTEM.pixelRatio) * this.config.zoomSpeed;\n\n            this.viewer.zoom(this.viewer.getZoomLevel() + delta);\n            this.__doMove(touchData.center.x, touchData.center.y);\n\n            this.data.pinchDist = touchData.distance;\n        }\n    }\n\n    /**\n     * Stores each mouse position during a mouse move\n     * @description Positions older than \"INERTIA_WINDOW\" are removed<br>\n     * Positions before a pause of \"INERTIA_WINDOW\" / 10 are removed\n     */\n    private __logMouseMove(clientX: number, clientY: number) {\n        const now = Date.now();\n\n        const last = this.data.mouseHistory.length\n            ? this.data.mouseHistory[this.data.mouseHistory.length - 1]\n            : [0, -1, -1];\n\n        // avoid duplicates\n        if (last[1] === clientX && last[2] === clientY) {\n            last[0] = now;\n        } else if (now === last[0]) {\n            last[1] = clientX;\n            last[2] = clientY;\n        } else {\n            this.data.mouseHistory.push([now, clientX, clientY]);\n        }\n\n        let previous = null;\n\n        for (let i = 0; i < this.data.mouseHistory.length; ) {\n            if (this.data.mouseHistory[i][0] < now - INERTIA_WINDOW) {\n                this.data.mouseHistory.splice(i, 1);\n            } else if (previous && this.data.mouseHistory[i][0] - previous > INERTIA_WINDOW / 10) {\n                this.data.mouseHistory.splice(0, i);\n                i = 0;\n                previous = this.data.mouseHistory[i][0];\n            } else {\n                previous = this.data.mouseHistory[i][0];\n                i++;\n            }\n        }\n    }\n}\n","<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 100 100\"><path fill=\"currentColor\" d=\"M33.38 33.2a1.96 1.96 0 0 0 1.5-3.23 10.61 10.61 0 0 1 7.18-17.51c.7-.06 1.31-.49 1.61-1.12a13.02 13.02 0 0 1 11.74-7.43c7.14 0 12.96 5.8 12.96 12.9 0 3.07-1.1 6.05-3.1 8.38-.7.82-.61 2.05.21 2.76.83.7 2.07.6 2.78-.22a16.77 16.77 0 0 0 4.04-10.91C72.3 7.54 64.72 0 55.4 0a16.98 16.98 0 0 0-14.79 8.7 14.6 14.6 0 0 0-12.23 14.36c0 3.46 1.25 6.82 3.5 9.45.4.45.94.69 1.5.69m45.74 43.55a22.13 22.13 0 0 1-5.23 12.4c-4 4.55-9.53 6.86-16.42 6.86-12.6 0-20.1-10.8-20.17-10.91a1.82 1.82 0 0 0-.08-.1c-5.3-6.83-14.55-23.82-17.27-28.87-.05-.1 0-.21.02-.23a6.3 6.3 0 0 1 8.24 1.85l9.38 12.59a1.97 1.97 0 0 0 3.54-1.17V25.34a4 4 0 0 1 1.19-2.87 3.32 3.32 0 0 1 2.4-.95c1.88.05 3.4 1.82 3.4 3.94v24.32a1.96 1.96 0 0 0 3.93 0v-33.1a3.5 3.5 0 0 1 7 0v35.39a1.96 1.96 0 0 0 3.93 0v-.44c.05-2.05 1.6-3.7 3.49-3.7 1.93 0 3.5 1.7 3.5 3.82v5.63c0 .24.04.48.13.71l.1.26a1.97 1.97 0 0 0 3.76-.37c.33-1.78 1.77-3.07 3.43-3.07 1.9 0 3.45 1.67 3.5 3.74l-1.77 18.1zM77.39 51c-1.25 0-2.45.32-3.5.9v-.15c0-4.27-3.33-7.74-7.42-7.74-1.26 0-2.45.33-3.5.9V16.69a7.42 7.42 0 0 0-14.85 0v1.86a7 7 0 0 0-3.28-.94 7.21 7.21 0 0 0-5.26 2.07 7.92 7.92 0 0 0-2.38 5.67v37.9l-5.83-7.82a10.2 10.2 0 0 0-13.35-2.92 4.1 4.1 0 0 0-1.53 5.48C20 64.52 28.74 80.45 34.07 87.34c.72 1.04 9.02 12.59 23.4 12.59 7.96 0 14.66-2.84 19.38-8.2a26.06 26.06 0 0 0 6.18-14.6l1.78-18.2v-.2c0-4.26-3.32-7.73-7.42-7.73z\"/><!--Created by AomAm from the Noun Project--></svg>\n","<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"10 17 79 79\"><path fill=\"currentColor\" d=\"M38.1 29.27c-.24 0-.44.2-.44.45v10.7a.45.45 0 00.9 0v-10.7c0-.25-.2-.45-.45-.45zm10.2 26.66a11.54 11.54 0 01-8.48-6.14.45.45 0 10-.8.41 12.45 12.45 0 009.22 6.62.45.45 0 00.07-.9zm24.55-13.08a23.04 23.04 0 00-22.56-23v7.07l-.01.05a2.83 2.83 0 012.39 2.78v14.03l.09-.02h8.84v-9.22a.45.45 0 11.9 0v9.22h10.35v-.9zm0 27.33V44.66H62.5c-.02 2.01-.52 4-1.47 5.76a.45.45 0 01-.61.18.45.45 0 01-.19-.61 11.54 11.54 0 001.36-5.33h-8.83l-.1-.01a2.83 2.83 0 01-2.83 2.84h-.04-.04a2.83 2.83 0 01-2.83-2.83v-14.9a2.82 2.82 0 012.47-2.8v-7.11a23.04 23.04 0 00-22.57 23v.91h14.72V29.88a8.2 8.2 0 015.02-7.57c.22-.1.5.01.59.24.1.23-.01.5-.24.6a7.3 7.3 0 00-4.47 6.73v13.88h3.9a.45.45 0 110 .9h-3.9v.15a7.32 7.32 0 0011.23 6.17.45.45 0 01.49.76 8.22 8.22 0 01-12.62-6.93v-.15H26.82v25.52a23.04 23.04 0 0023.01 23.01 23.04 23.04 0 0023.02-23.01zm1.8-27.33v27.33A24.85 24.85 0 0149.84 95a24.85 24.85 0 01-24.82-24.82V42.85a24.85 24.85 0 0124.82-24.82 24.85 24.85 0 0124.83 24.82zM57.98 29.88v9.36a.45.45 0 11-.9 0v-9.36a7.28 7.28 0 00-3.4-6.17.45.45 0 01.49-.76 8.18 8.18 0 013.8 6.93z\"/><!-- Created by Icon Island from the Noun Project --></svg>\n","import {\n    Box3,\n    ColorManagement,\n    Euler,\n    Frustum,\n    Group,\n    Intersection,\n    LinearSRGBColorSpace,\n    Matrix4,\n    Mesh,\n    Object3D,\n    PerspectiveCamera,\n    Raycaster,\n    Scene,\n    Renderer as ThreeRenderer,\n    Vector2,\n    Vector3,\n    WebGLRenderTarget,\n    WebGLRenderer,\n} from 'three';\nimport { SPHERE_RADIUS, VIEWER_DATA } from '../data/constants';\nimport { SYSTEM } from '../data/system';\nimport {\n    BeforeAnimateEvent,\n    BeforeRenderEvent,\n    ConfigChangedEvent,\n    PositionUpdatedEvent,\n    RenderEvent,\n    RollUpdatedEvent,\n    SizeUpdatedEvent,\n    ZoomUpdatedEvent,\n} from '../events';\nimport { PanoData, PanoramaOptions, Point, SphereCorrection, TextureData } from '../model';\nimport { Animation, isNil } from '../utils';\nimport type { Viewer } from '../Viewer';\nimport { AbstractService } from './AbstractService';\n\n// https://discourse.threejs.org/t/updates-to-color-management-in-three-js-r152/50791\nColorManagement.enabled = false;\n\nconst vector2 = new Vector2();\nconst matrix4 = new Matrix4();\nconst box3 = new Box3();\n\nexport type CustomRenderer = Pick<ThreeRenderer, 'render'> & {\n    getIntersections?(raycaster: Raycaster, vector: Vector2): Array<Intersection<Mesh>>;\n};\n\n/**\n * Controller for the three.js scene\n */\nexport class Renderer extends AbstractService {\n    private readonly renderer: WebGLRenderer;\n    private readonly scene: Scene;\n    /** @internal */\n    public readonly camera: PerspectiveCamera;\n    private readonly mesh: Mesh;\n    private readonly meshContainer: Group;\n    private readonly raycaster: Raycaster;\n    private readonly frustum: Frustum;\n    private readonly container: HTMLElement;\n\n    private timestamp?: number;\n    private frustumNeedsUpdate = true;\n    private customRenderer?: CustomRenderer;\n\n    get panoramaPose(): Euler {\n        return this.mesh.rotation;\n    }\n\n    get sphereCorrection(): Euler {\n        return this.meshContainer.rotation;\n    }\n\n    /**\n     * @internal\n     */\n    constructor(viewer: Viewer) {\n        super(viewer);\n\n        this.renderer = new WebGLRenderer(this.config.rendererParameters);\n        this.renderer.setPixelRatio(SYSTEM.pixelRatio);\n        // https://discourse.threejs.org/t/updates-to-color-management-in-three-js-r152/50791\n        this.renderer.outputColorSpace = LinearSRGBColorSpace;\n        this.renderer.domElement.className = 'psv-canvas';\n\n        this.scene = new Scene();\n\n        this.camera = new PerspectiveCamera(50, 16 / 9, 0.1, 2 * SPHERE_RADIUS);\n        this.camera.matrixWorldAutoUpdate = false;\n\n        this.mesh = this.viewer.adapter.createMesh();\n        this.mesh.userData = { [VIEWER_DATA]: true };\n\n        this.meshContainer = new Group();\n        this.meshContainer.add(this.mesh);\n        this.scene.add(this.meshContainer);\n\n        this.raycaster = new Raycaster();\n        this.frustum = new Frustum();\n\n        this.container = document.createElement('div');\n        this.container.className = 'psv-canvas-container';\n        this.container.appendChild(this.renderer.domElement);\n        this.viewer.container.appendChild(this.container);\n\n        this.viewer.addEventListener(SizeUpdatedEvent.type, this);\n        this.viewer.addEventListener(ZoomUpdatedEvent.type, this);\n        this.viewer.addEventListener(PositionUpdatedEvent.type, this);\n        this.viewer.addEventListener(RollUpdatedEvent.type, this);\n        this.viewer.addEventListener(ConfigChangedEvent.type, this);\n\n        this.hide();\n    }\n\n    /**\n     * @internal\n     */\n    init() {\n        this.show();\n        this.renderer.setAnimationLoop((t) => this.__renderLoop(t));\n    }\n\n    /**\n     * @internal\n     */\n    override destroy() {\n        // cancel render loop\n        this.renderer.setAnimationLoop(null);\n\n        // destroy ThreeJS view\n        this.cleanScene(this.scene);\n\n        // remove container\n        this.viewer.container.removeChild(this.container);\n\n        this.viewer.removeEventListener(SizeUpdatedEvent.type, this);\n        this.viewer.removeEventListener(ZoomUpdatedEvent.type, this);\n        this.viewer.removeEventListener(PositionUpdatedEvent.type, this);\n        this.viewer.removeEventListener(RollUpdatedEvent.type, this);\n        this.viewer.removeEventListener(ConfigChangedEvent.type, this);\n\n        super.destroy();\n    }\n\n    /**\n     * @internal\n     */\n    handleEvent(e: Event) {\n        // prettier-ignore\n        switch (e.type) {\n            case SizeUpdatedEvent.type: this.__onSizeUpdated(); break;\n            case ZoomUpdatedEvent.type: this.__onZoomUpdated(); break;\n            case PositionUpdatedEvent.type: this.__onPositionUpdated(); break;\n            case RollUpdatedEvent.type: this.__onPositionUpdated(); break;\n            case ConfigChangedEvent.type:\n                if ((e as ConfigChangedEvent).containsOptions('fisheye')) {\n                    this.__onPositionUpdated();\n                }\n                break;\n        }\n    }\n\n    /**\n     * Hides the viewer\n     */\n    hide() {\n        this.container.style.opacity = '0';\n    }\n\n    /**\n     * Shows the viewer\n     */\n    show() {\n        this.container.style.opacity = '1';\n    }\n\n    /**\n     * Resets or replaces the THREE renderer by a custom one\n     */\n    setCustomRenderer(factory: (renderer: WebGLRenderer) => CustomRenderer) {\n        if (factory) {\n            this.customRenderer = factory(this.renderer);\n        } else {\n            this.customRenderer = null;\n        }\n        this.viewer.needsUpdate();\n    }\n\n    /**\n     * Updates the size of the renderer and the aspect of the camera\n     */\n    private __onSizeUpdated() {\n        this.renderer.setSize(this.state.size.width, this.state.size.height);\n        this.camera.aspect = this.state.aspect;\n        this.camera.updateProjectionMatrix();\n        this.viewer.needsUpdate();\n        this.frustumNeedsUpdate = true;\n    }\n\n    /**\n     * Updates the fov of the camera\n     */\n    private __onZoomUpdated() {\n        this.camera.fov = this.state.vFov;\n        this.camera.updateProjectionMatrix();\n        this.viewer.needsUpdate();\n        this.frustumNeedsUpdate = true;\n    }\n\n    /**\n     * Updates the position of the camera\n     */\n    private __onPositionUpdated() {\n        this.camera.position.set(0, 0, 0);\n        this.camera.lookAt(this.state.direction);\n        if (this.config.fisheye) {\n            this.camera.position\n                .copy(this.state.direction)\n                .multiplyScalar(this.config.fisheye / 2)\n                .negate();\n        }\n        this.camera.rotateZ(-this.state.roll);\n        this.camera.updateMatrixWorld();\n        this.viewer.needsUpdate();\n        this.frustumNeedsUpdate = true;\n    }\n\n    /**\n     * Main event loop, performs a render if `state.needsUpdate` is true\n     */\n    private __renderLoop(timestamp: number) {\n        const elapsed = !this.timestamp ? 0 : timestamp - this.timestamp;\n        this.timestamp = timestamp;\n\n        this.viewer.dispatchEvent(new BeforeRenderEvent(timestamp, elapsed));\n        this.viewer.dynamics.update(elapsed);\n\n        if (this.state.needsUpdate || this.state.continuousUpdateCount > 0) {\n            this.state.needsUpdate = false;\n            (this.customRenderer || this.renderer).render(this.scene, this.camera);\n            this.viewer.dispatchEvent(new RenderEvent());\n        }\n    }\n\n    /**\n     * Applies the texture to the scene, creates the scene if needed\n     * @internal\n     */\n    setTexture(textureData: TextureData) {\n        if (this.state.textureData) {\n            this.viewer.adapter.disposeTexture(this.state.textureData);\n        }\n\n        this.state.textureData = textureData;\n\n        this.viewer.adapter.setTexture(this.mesh, textureData);\n\n        this.viewer.needsUpdate();\n    }\n\n    /**\n     * Applies a panorama data pose to a Mesh\n     * @internal\n     */\n    setPanoramaPose(panoData: PanoData, mesh: Mesh = this.mesh) {\n        // By Google documentation the angles are applied on the camera in order : heading, pitch, roll\n        // here we apply the reverse transformation on the sphere\n        const cleanCorrection = this.viewer.dataHelper.cleanPanoramaPose(panoData);\n\n        mesh.rotation.set(-cleanCorrection.tilt, -cleanCorrection.pan, -cleanCorrection.roll, 'ZXY');\n    }\n\n    /**\n     * Applies a SphereCorrection to a Group\n     * @internal\n     */\n    setSphereCorrection(sphereCorrection: SphereCorrection, group: Object3D = this.meshContainer) {\n        const cleanCorrection = this.viewer.dataHelper.cleanSphereCorrection(sphereCorrection);\n\n        group.rotation.set(cleanCorrection.tilt, cleanCorrection.pan, cleanCorrection.roll, 'ZXY');\n    }\n\n    /**\n     * Performs transition between the current and a new texture\n     * @internal\n     */\n    transition(textureData: TextureData, options: PanoramaOptions): Animation<any> {\n        const positionProvided = !isNil(options.position);\n        const zoomProvided = !isNil(options.zoom);\n\n        const e = new BeforeAnimateEvent(\n            positionProvided ? this.viewer.dataHelper.cleanPosition(options.position) : undefined,\n            options.zoom\n        );\n        this.viewer.dispatchEvent(e);\n\n        // create temp group and new mesh, half size to be in \"front\" of the first one\n        const group = new Group();\n        const mesh = this.viewer.adapter.createMesh(0.5);\n        this.viewer.adapter.setTexture(mesh, textureData, true);\n        this.viewer.adapter.setTextureOpacity(mesh, 0);\n        this.setPanoramaPose(textureData.panoData, mesh);\n        this.setSphereCorrection(options.sphereCorrection, group);\n\n        // rotate the new sphere to make the target position face the camera\n        if (positionProvided && options.transition === 'fade-only') {\n            const currentPosition = this.viewer.getPosition();\n\n            // rotation along the vertical axis\n            const verticalAxis = new Vector3(0, 1, 0);\n            group.rotateOnWorldAxis(verticalAxis, e.position.yaw - currentPosition.yaw);\n\n            // rotation along the camera horizontal axis\n            const horizontalAxis = new Vector3(0, 1, 0).cross(this.camera.getWorldDirection(new Vector3())).normalize();\n            group.rotateOnWorldAxis(horizontalAxis, e.position.pitch - currentPosition.pitch);\n        }\n\n        group.add(mesh);\n        this.scene.add(group);\n\n        // make sure the new texture is transfered to the GPU before starting the animation\n        this.renderer.setRenderTarget(new WebGLRenderTarget<any>());\n        this.renderer.render(this.scene, this.camera);\n        this.renderer.setRenderTarget(null);\n\n        const { duration, properties } = this.viewer.dataHelper.getAnimationProperties(\n            options.speed,\n            options.transition === true ? e.position : null,\n            e.zoomLevel\n        );\n\n        const animation = new Animation({\n            properties: {\n                ...properties,\n                opacity: { start: 0.0, end: 1.0 },\n            },\n            duration: duration,\n            easing: 'inOutCubic',\n            onTick: (props) => {\n                this.viewer.adapter.setTextureOpacity(mesh, props.opacity);\n\n                if (positionProvided && options.transition === true) {\n                    this.viewer.dynamics.position.setValue({\n                        yaw: props.yaw,\n                        pitch: props.pitch,\n                    });\n                }\n                if (zoomProvided) {\n                    this.viewer.dynamics.zoom.setValue(props.zoom);\n                }\n\n                this.viewer.needsUpdate();\n            },\n        });\n\n        animation.then((completed) => {\n            if (completed) {\n                // remove temp sphere and transfer the texture to the main mesh\n                this.setTexture(textureData);\n                this.viewer.adapter.setTextureOpacity(this.mesh, 1);\n                this.setPanoramaPose(textureData.panoData);\n                this.setSphereCorrection(options.sphereCorrection);\n\n                // actually rotate the camera\n                if (positionProvided && options.transition === 'fade-only') {\n                    this.viewer.rotate(options.position);\n                }\n            } else {\n                this.viewer.adapter.disposeTexture(textureData);\n            }\n\n            this.scene.remove(group);\n            mesh.geometry.dispose();\n            mesh.geometry = null;\n        });\n\n        return animation;\n    }\n\n    /**\n     * Returns intersections with objects in the scene\n     */\n    getIntersections(viewerPoint: Point): Array<Intersection<Mesh>> {\n        vector2.x = (2 * viewerPoint.x) / this.state.size.width - 1;\n        vector2.y = (-2 * viewerPoint.y) / this.state.size.height + 1;\n\n        this.raycaster.setFromCamera(vector2, this.camera);\n\n        const intersections = this.raycaster\n            .intersectObjects(this.scene.children, true)\n            .filter((i) => i.object.visible)\n            .filter((i) => (i.object as Mesh).isMesh && !!i.object.userData) as Array<Intersection<Mesh>>;\n\n        if (this.customRenderer?.getIntersections) {\n            intersections.push(...this.customRenderer.getIntersections(this.raycaster, vector2));\n        }\n\n        return intersections;\n    }\n\n    /**\n     * Checks if an object/point is currently visible\n     */\n    isObjectVisible(value: Object3D | Vector3): boolean {\n        if (!value) {\n            return false;\n        }\n\n        if (this.frustumNeedsUpdate) {\n            matrix4.multiplyMatrices(this.camera.projectionMatrix, this.camera.matrixWorldInverse);\n            this.frustum.setFromProjectionMatrix(matrix4);\n            this.frustumNeedsUpdate = false;\n        }\n\n        if ((value as Vector3).isVector3) {\n            return this.frustum.containsPoint(value as Vector3);\n        } else if ((value as Mesh).isMesh && (value as Mesh).geometry) {\n            // Frustum.intersectsObject uses the boundingSphere by default\n            // for better precision we prefer the boundingBox\n            const mesh = value as Mesh;\n            if (!mesh.geometry.boundingBox) {\n                mesh.geometry.computeBoundingBox();\n            }\n            box3.copy(mesh.geometry.boundingBox).applyMatrix4(mesh.matrixWorld);\n            return this.frustum.intersectsBox(box3);\n        } else if ((value as Object3D).isObject3D) {\n            return this.frustum.intersectsObject(value as Object3D);\n        } else {\n            return false;\n        }\n    }\n\n    /**\n     * Adds an object to the THREE scene\n     */\n    addObject(object: Object3D) {\n        this.scene.add(object);\n    }\n\n    /**\n     * Removes an object from the THREE scene\n     */\n    removeObject(object: Object3D) {\n        this.scene.remove(object);\n    }\n\n    /**\n     * Calls `dispose` on all objects and textures\n     * @internal\n     */\n    cleanScene(object: any) {\n        const disposeMaterial = (material: any) => {\n            material.map?.dispose();\n\n            if (material.uniforms) {\n                Object.values(material.uniforms).forEach((uniform: any) => {\n                    uniform.value?.dispose?.();\n                });\n            }\n\n            material.dispose();\n        };\n\n        object.traverse((item: any) => {\n            item.geometry?.dispose();\n\n            if (item.material) {\n                if (Array.isArray(item.material)) {\n                    item.material.forEach((material: any) => {\n                        disposeMaterial(material);\n                    });\n                } else {\n                    disposeMaterial(item.material);\n                }\n            }\n\n            if (!(item instanceof Scene)) {\n                item.dispose?.();\n            }\n\n            if (item !== object) {\n                this.cleanScene(item);\n            }\n        });\n    }\n}\n","import { Loader } from 'three';\n\n/**\n * Copy of ThreeJS FileLoader with support of an AbortSignal and only supporting Blob response\n * Also removing all unused features for PSV\n */\nexport class BlobLoader extends Loader<Blob, string> {\n\n    // @ts-ignore\n    load(\n        url: string,\n        onLoad: (data: Blob) => void,\n        onProgress: (event: ProgressEvent) => void,\n        onError: (err: unknown) => void,\n        abortSignal?: AbortSignal\n    ) {\n        // create request\n        const req = new Request(url, {\n            headers: new Headers(this.requestHeader),\n            credentials: this.withCredentials ? 'include' : 'same-origin',\n        });\n\n        // start the fetch\n        fetch(req, {\n            signal: abortSignal,\n        })\n            .then(response => {\n                if (response.status === 200 || response.status === 0) {\n                    const reader = response.body.getReader();\n\n                    // Nginx needs X-File-Size check\n                    // https://serverfault.com/questions/482875/why-does-nginx-remove-content-length-header-for-chunked-content\n                    const contentLength = response.headers.get('Content-Length') || response.headers.get('X-File-Size');\n                    const total = contentLength ? parseInt(contentLength) : 0;\n                    const lengthComputable = total !== 0;\n                    let loaded = 0;\n\n                    // periodically read data into the new stream tracking while download progress\n                    const stream = new ReadableStream({\n                        start(controller) {\n                            readData();\n\n                            function readData() {\n                                reader.read()\n                                    .then(({ done, value }) => {\n                                        if (done) {\n                                            controller.close();\n                                        } else {\n                                            loaded += value.byteLength;\n                                            const event = new ProgressEvent('progress', { lengthComputable, loaded, total });\n                                            onProgress(event);\n                                            controller.enqueue(value);\n                                            readData();\n                                        }\n                                    })\n                                    .catch((err) => {\n                                        onError(err);\n                                    });\n                            }\n                        }\n                    });\n\n                    return new Response(stream);\n\n                } else {\n                    throw new Error(`fetch for \"${response.url}\" responded with ${response.status}: ${response.statusText}`);\n                }\n            })\n            .then(response => {\n                return response.blob();\n            })\n            .then(data => {\n                onLoad(data);\n            })\n            .catch(err => {\n                onError(err);\n            });\n    }\n\n}\n","import { Loader } from 'three';\n\n/**\n * Copy of ThreeJS ImageLoader with support of an AbortSignal\n * Also removing all unused features for PSV\n */\nexport class ImageLoader extends Loader<HTMLImageElement, string> {\n\n    // @ts-ignore\n    load(\n        url: string,\n        onLoad: (data: HTMLImageElement) => void,\n        onError: (err: unknown) => void,\n        abortSignal?: AbortSignal\n    ) {\n\n        const image = document.createElement('img');\n\n        function onImageLoad(this: HTMLImageElement) {\n            removeEventListeners();\n            onLoad(this);\n        }\n\n        function onImageError(event: ErrorEvent) {\n            removeEventListeners();\n\n            if (abortSignal?.aborted) {\n                // Simulate an error similar to the DOMException thrown by the Fetch API\n                // (DOMException is not instanciable)\n                const e = new Error();\n                e.name = 'AbortError';\n                e.message = 'The operation was aborted.';\n                onError(e);\n\n            } else {\n                onError(event);\n            }\n        }\n\n        function onAbortSignal() {\n            image.src = '';\n        }\n\n        function removeEventListeners() {\n            image.removeEventListener('load', onImageLoad, false);\n            image.removeEventListener('error', onImageError, false);\n\n            abortSignal?.removeEventListener('abort', onAbortSignal, false);\n        }\n\n        image.addEventListener('load', onImageLoad, false);\n        image.addEventListener('error', onImageError, false);\n\n        abortSignal?.addEventListener('abort', onAbortSignal, false);\n\n        if (!url.startsWith('data:') && this.crossOrigin !== undefined) {\n            image.crossOrigin = this.crossOrigin;\n        }\n\n        image.src = url;\n\n        return image;\n    }\n\n}\n","import { PSVError } from '../PSVError';\nimport type { Viewer } from '../Viewer';\nimport { Cache } from '../data/cache';\nimport { AbstractService } from './AbstractService';\nimport { BlobLoader } from '../lib/BlobLoader';\nimport { ImageLoader } from '../lib/ImageLoader';\n\n/**\n * Image and texture loading system\n */\nexport class TextureLoader extends AbstractService {\n    private readonly fileLoader: BlobLoader;\n    private readonly imageLoader: ImageLoader;\n\n    private abortCtrl: Record<string, AbortController> = {};\n\n    /**\n     * @internal\n     */\n    constructor(viewer: Viewer) {\n        super(viewer);\n\n        this.fileLoader = new BlobLoader();\n        this.imageLoader = new ImageLoader();\n\n        if (this.config.withCredentials) {\n            this.fileLoader.setWithCredentials(true);\n            this.imageLoader.setCrossOrigin('use-credentials');\n        }\n    }\n\n    /**\n     * @internal\n     */\n    override destroy() {\n        this.abortLoading();\n        super.destroy();\n    }\n\n    /**\n     * Cancels current HTTP requests\n     * @internal\n     */\n    abortLoading() {\n        Object.values(this.abortCtrl).forEach((ctrl) => ctrl.abort());\n        this.abortCtrl = {};\n    }\n\n    /**\n     * Loads a Blob with FileLoader\n     */\n    loadFile(url: string, onProgress?: (p: number) => void, cacheKey?: string): Promise<Blob> {\n        const cached = Cache.get(url, cacheKey);\n\n        if (cached) {\n            if (cached instanceof Blob) {\n                onProgress?.(100);\n                return Promise.resolve(cached);\n            } else {\n                // unlikely case when the image has already been loaded with the ImageLoader\n                Cache.remove(url, cacheKey);\n            }\n        }\n\n        if (this.config.requestHeaders) {\n            this.fileLoader.setRequestHeader(this.config.requestHeaders(url));\n        }\n\n        return new Promise((resolve, reject) => {\n            let progress = 0;\n            onProgress?.(progress);\n\n            this.fileLoader.load(\n                url,\n                (result) => {\n                    progress = 100;\n                    onProgress?.(progress);\n                    Cache.add(url, cacheKey, result);\n                    resolve(result);\n                },\n                (e) => {\n                    if (e.lengthComputable) {\n                        const newProgress = (e.loaded / e.total) * 100;\n                        if (newProgress > progress) {\n                            progress = newProgress;\n                            onProgress?.(progress);\n                        }\n                    }\n                },\n                (err) => {\n                    reject(err);\n                },\n                this.__getAbortSignal(cacheKey)\n            );\n        });\n    }\n\n    /**\n     * Loads an image with ImageLoader or with FileLoader if progress is tracked or if request headers are configured\n     */\n    loadImage(url: string, onProgress?: (p: number) => void, cacheKey?: string): Promise<HTMLImageElement> {\n        const cached = Cache.get(url, cacheKey);\n\n        if (cached) {\n            onProgress?.(100);\n            if (cached instanceof Blob) {\n                // unlikely case when the image has already been loaded with the FileLoader\n                return this.blobToImage(cached);\n            } else {\n                return Promise.resolve(cached);\n            }\n        }\n\n        if (!onProgress && !this.config.requestHeaders) {\n            return new Promise((resolve, reject) => {\n                this.imageLoader.load(\n                    url,\n                    (result) => {\n                        Cache.add(url, cacheKey, result);\n                        resolve(result);\n                    },\n                    (err) => {\n                        reject(err);\n                    },\n                    this.__getAbortSignal(cacheKey)\n                );\n            });\n        } else {\n            return this.loadFile(url, onProgress, cacheKey).then((blob) => this.blobToImage(blob));\n        }\n    }\n\n    /**\n     * Converts a file loaded with {@link loadFile} into an image\n     */\n    blobToImage(blob: Blob): Promise<HTMLImageElement> {\n        return new Promise((resolve, reject) => {\n            const img = document.createElement('img');\n            img.onload = () => {\n                URL.revokeObjectURL(img.src);\n                resolve(img);\n            };\n            img.onerror = reject;\n            img.src = URL.createObjectURL(blob);\n        });\n    }\n\n    /**\n     * Preload a panorama file without displaying it\n     */\n    preloadPanorama(panorama: any): Promise<unknown> {\n        if (this.viewer.adapter.supportsPreload(panorama)) {\n            return this.viewer.adapter.loadTexture(panorama, false);\n        } else {\n            return Promise.reject(new PSVError('Current adapter does not support preload'));\n        }\n    }\n\n    /**\n     * Get an abort signal\n     * the signal is shared accross all requests with the same cache key (for tiles adapters)\n     */\n    private __getAbortSignal(cacheKey: string): AbortSignal {\n        if (cacheKey) {\n            if (this.abortCtrl[cacheKey]?.signal.aborted) {\n                delete this.abortCtrl[cacheKey];\n            }\n            if (!this.abortCtrl[cacheKey]) {\n                this.abortCtrl[cacheKey] = new AbortController();\n            }\n            return this.abortCtrl[cacheKey].signal;\n        }\n        return null;\n    }\n\n}\n","import { MathUtils } from 'three';\nimport { Dynamic, MultiDynamic } from '../utils';\nimport type { Viewer } from '../Viewer';\nimport { PositionUpdatedEvent, RollUpdatedEvent, ZoomUpdatedEvent } from '../events';\nimport { AbstractService } from './AbstractService';\n\nexport class ViewerDynamics extends AbstractService {\n    readonly zoom = new Dynamic(\n        (zoomLevel) => {\n            this.viewer.state.vFov = this.viewer.dataHelper.zoomLevelToFov(zoomLevel);\n            this.viewer.state.hFov = this.viewer.dataHelper.vFovToHFov(this.viewer.state.vFov);\n            this.viewer.dispatchEvent(new ZoomUpdatedEvent(zoomLevel));\n        },\n        {\n            defaultValue: this.viewer.config.defaultZoomLvl,\n            min: 0,\n            max: 100,\n            wrap: false,\n        }\n    );\n\n    readonly position = new MultiDynamic(\n        (position) => {\n            this.viewer.dataHelper.sphericalCoordsToVector3(position, this.viewer.state.direction);\n            this.viewer.dispatchEvent(new PositionUpdatedEvent(position));\n        },\n        {\n            yaw: new Dynamic(null, {\n                defaultValue: this.config.defaultYaw,\n                min: 0,\n                max: 2 * Math.PI,\n                wrap: true,\n            }),\n            pitch: new Dynamic(null, {\n                defaultValue: this.config.defaultPitch,\n                min: !this.viewer.state.littlePlanet ? -Math.PI / 2 : 0,\n                max: !this.viewer.state.littlePlanet ? Math.PI / 2 : Math.PI * 2,\n                wrap: this.viewer.state.littlePlanet,\n            }),\n        }\n    );\n\n    readonly roll = new Dynamic(\n        (roll) => {\n            this.viewer.state.roll = roll;\n            this.viewer.dispatchEvent(new RollUpdatedEvent(roll));\n        },\n        {\n            defaultValue: 0,\n            min: - Math.PI,\n            max: Math.PI,\n            wrap: false,\n        }\n    );\n\n    /**\n     * @internal\n     */\n    constructor(viewer: Viewer) {\n        super(viewer);\n        this.updateSpeeds();\n    }\n\n    /**\n     * @internal\n     */\n    updateSpeeds() {\n        this.zoom.setSpeed(this.config.zoomSpeed * 50);\n        this.position.setSpeed(MathUtils.degToRad(this.config.moveSpeed * 50));\n        this.roll.setSpeed(MathUtils.degToRad(this.config.moveSpeed * 50));\n    }\n\n    /**\n     * @internal\n     */\n    update(elapsed: number) {\n        this.zoom.update(elapsed);\n        this.position.update(elapsed);\n        this.roll.update(elapsed);\n    }\n}\n","import { Mesh, Vector3 } from 'three';\nimport { SPHERE_RADIUS } from '../data/constants';\nimport { Size, TextureData } from '../model';\nimport type { Animation } from '../utils';\n\n/**\n * Internal properties of the viewer\n */\nexport class ViewerState {\n    /**\n     * when all components are loaded\n     */\n    ready = false;\n\n    /**\n     * if the view needs to be renderer\n     */\n    needsUpdate = false;\n\n    /**\n     * number of plugins requesting to continuously render the scene\n     */\n    continuousUpdateCount = 0;\n\n    /**\n     * if the keyboard events are currently listened to\n     */\n    keyboardEnabled = false;\n\n    /**\n     * direction of the camera\n     */\n    direction = new Vector3(0, 0, SPHERE_RADIUS);\n\n    /**\n     * current camera roll\n     */\n    roll = 0;\n\n    /**\n     * vertical FOV\n     */\n    vFov = 60;\n\n    /**\n     * horizontal FOV\n     */\n    hFov = 60;\n\n    /**\n     * renderer aspect ratio\n     */\n    aspect = 1;\n\n    /**\n     * currently running animation\n     */\n    animation: Animation = null;\n\n    /**\n     * currently running transition\n     */\n    transitionAnimation: Animation = null;\n\n    /**\n     * promise of the last \"setPanorama()\" call\n     */\n    loadingPromise: Promise<any> = null;\n\n    /**\n     * special tweaks for LittlePlanetAdapter\n     */\n    littlePlanet = false;\n\n    /**\n     * time of the last user action\n     */\n    idleTime = -1;\n\n    /**\n     * registered THREE objects observer\n     */\n    objectsObservers: Record<string, Mesh | null> = {};\n\n    /**\n     * size of the container\n     */\n    size: Size = {\n        width: 0,\n        height: 0,\n    };\n\n    /**\n     * Current panorama texture displayed\n     */\n    textureData: TextureData;\n\n    /**\n     * Current override of the global cursor\n     */\n    cursorOverride: string;\n\n    /**\n     * @internal\n     */\n    // eslint-disable-next-line  @typescript-eslint/no-empty-function\n    constructor() {}\n}\n","import { PSVError } from './PSVError';\nimport type { AbstractAdapter } from './adapters/AbstractAdapter';\nimport type { AbstractComponent } from './components/AbstractComponent';\nimport { Loader } from './components/Loader';\nimport { Navbar } from './components/Navbar';\nimport { Notification } from './components/Notification';\nimport { Overlay } from './components/Overlay';\nimport { Panel } from './components/Panel';\nimport { Tooltip, TooltipConfig } from './components/Tooltip';\nimport { Cache } from './data/cache';\nimport { CONFIG_PARSERS, DEFAULTS, getViewerConfig, READONLY_OPTIONS } from './data/config';\nimport { DEFAULT_TRANSITION, IDS, VIEWER_DATA } from './data/constants';\nimport { SYSTEM } from './data/system';\nimport {\n    BeforeAnimateEvent,\n    BeforeRotateEvent,\n    ConfigChangedEvent,\n    PanoramaErrorEvent,\n    PanoramaLoadedEvent,\n    PanoramaLoadEvent,\n    ReadyEvent,\n    SizeUpdatedEvent,\n    StopAllEvent,\n    ViewerEvents,\n    ZoomUpdatedEvent,\n} from './events';\nimport errorIcon from './icons/error.svg';\nimport { TypedEventTarget } from './lib/TypedEventTarget';\nimport {\n    AnimateOptions,\n    CssSize,\n    ExtendedPosition,\n    PanoramaOptions,\n    ParsedViewerConfig,\n    Position,\n    Size,\n    UpdatableViewerConfig,\n    ViewerConfig,\n} from './model';\nimport type { AbstractPlugin, PluginConstructor } from './plugins/AbstractPlugin';\nimport { pluginInterop } from './plugins/AbstractPlugin';\nimport { DataHelper } from './services/DataHelper';\nimport { EventsHandler } from './services/EventsHandler';\nimport { Renderer } from './services/Renderer';\nimport { TextureLoader } from './services/TextureLoader';\nimport { ViewerDynamics } from './services/ViewerDynamics';\nimport { ViewerState } from './services/ViewerState';\nimport {\n    Animation,\n    checkStylesheet,\n    exitFullscreen,\n    getAbortError,\n    getElement,\n    isAbortError,\n    isExtendedPosition,\n    isFullscreenEnabled,\n    isNil,\n    logWarn,\n    requestFullscreen,\n    resolveBoolean,\n    throttle,\n    toggleClass,\n} from './utils';\n\n/**\n * Photo Sphere Viewer controller\n */\nexport class Viewer extends TypedEventTarget<ViewerEvents> {\n    readonly state: ViewerState;\n    readonly config: ParsedViewerConfig;\n\n    readonly parent: HTMLElement;\n    readonly container: HTMLElement;\n\n    /** @internal */\n    readonly adapter: AbstractAdapter<any, any, any>;\n    /** @internal */\n    readonly plugins: Record<string, AbstractPlugin<any>> = {};\n    /** @internal */\n    readonly dynamics: ViewerDynamics;\n\n    readonly renderer: Renderer;\n    readonly textureLoader: TextureLoader;\n    /** @internal */\n    readonly eventsHandler: EventsHandler;\n    readonly dataHelper: DataHelper;\n\n    readonly loader: Loader;\n    readonly navbar: Navbar;\n    readonly notification: Notification;\n    readonly overlay: Overlay;\n    readonly panel: Panel;\n\n    /** @internal */\n    readonly children: AbstractComponent[] = [];\n\n    private readonly onResize = throttle(() => this.navbar.autoSize(), 500);\n\n    constructor(config: ViewerConfig) {\n        super();\n\n        // init\n        this.parent = getElement(config.container);\n        if (!this.parent) {\n            throw new PSVError(`\"container\" element not found.`);\n        }\n\n        // @ts-ignore\n        this.parent[VIEWER_DATA] = this;\n\n        this.container = document.createElement('div');\n        this.container.classList.add('psv-container');\n        this.parent.appendChild(this.container);\n\n        checkStylesheet(this.container, 'core');\n\n        this.state = new ViewerState();\n        this.config = getViewerConfig(config);\n\n        this.__setSize(this.config.size);\n\n        this.overlay = new Overlay(this);\n\n        try {\n            SYSTEM.load();\n        } catch (err) {\n            console.error(err);\n            this.showError(this.config.lang.webglError);\n            return;\n        }\n\n        Cache.init();\n\n        // @ts-ignore\n        this.adapter = new this.config.adapter[0](this, this.config.adapter[1]);\n\n        this.renderer = new Renderer(this);\n        this.textureLoader = new TextureLoader(this);\n        this.eventsHandler = new EventsHandler(this);\n        this.dataHelper = new DataHelper(this);\n        this.dynamics = new ViewerDynamics(this);\n\n        this.adapter.init?.();\n\n        this.loader = new Loader(this);\n        this.navbar = new Navbar(this);\n        this.panel = new Panel(this);\n        this.notification = new Notification(this);\n\n        this.autoSize();\n        this.setCursor(null);\n\n        resolveBoolean(SYSTEM.isTouchEnabled, (enabled) => {\n            toggleClass(this.container, 'psv--is-touch', enabled);\n        });\n\n        // init plugins\n        this.config.plugins.forEach(([plugin, opts]) => {\n            // @ts-ignore\n            this.plugins[plugin.id] = new plugin(this, opts);\n        });\n        for (const plugin of Object.values(this.plugins)) {\n            plugin.init?.();\n        }\n\n        // init buttons\n        if (this.config.navbar) {\n            this.navbar.setButtons(this.config.navbar);\n        }\n\n        // load panorama\n        if (!this.state.loadingPromise) {\n            if (this.config.panorama) {\n                this.setPanorama(this.config.panorama);\n            } else {\n                this.loader.show();\n            }\n        }\n    }\n\n    /**\n     * Destroys the viewer\n     */\n    destroy() {\n        this.stopAll();\n        this.stopKeyboardControl();\n        this.exitFullscreen();\n\n        for (const [id, plugin] of Object.entries(this.plugins)) {\n            plugin.destroy();\n            delete this.plugins[id];\n        }\n\n        this.children.slice().forEach((child) => child.destroy());\n        this.children.length = 0;\n\n        this.eventsHandler?.destroy();\n        this.renderer?.destroy();\n        this.textureLoader?.destroy();\n        this.dataHelper?.destroy();\n        this.adapter?.destroy();\n        this.dynamics?.destroy();\n\n        this.parent.removeChild(this.container);\n        // @ts-ignore\n        delete this.parent[VIEWER_DATA];\n    }\n\n    private init() {\n        this.eventsHandler.init();\n        this.renderer.init();\n\n        if (this.config.navbar) {\n            this.navbar.show();\n        }\n\n        if (this.config.keyboard === 'always') {\n            this.startKeyboardControl();\n        }\n\n        this.resetIdleTimer();\n\n        this.state.ready = true;\n\n        this.dispatchEvent(new ReadyEvent());\n    }\n\n    /**\n     * Restarts the idle timer\n     * @internal\n     */\n    resetIdleTimer() {\n        this.state.idleTime = performance.now();\n    }\n\n    /**\n     * Stops the idle timer\n     * @internal\n     */\n    disableIdleTimer() {\n        this.state.idleTime = -1;\n    }\n\n    /**\n     * Returns the instance of a plugin if it exists\n     * @example By plugin identifier\n     * ```js\n     * viewer.getPlugin('markers')\n     * ```\n     * @example By plugin class with TypeScript support\n     * ```ts\n     * viewer.getPlugin<MarkersPlugin>(MarkersPlugin)\n     * ```\n     */\n    getPlugin<T extends AbstractPlugin<any>>(pluginId: string | PluginConstructor): T {\n        if (typeof pluginId === 'string') {\n            return this.plugins[pluginId] as T;\n        } else {\n            const pluginCtor = pluginInterop(pluginId);\n            return pluginCtor ? (this.plugins[pluginCtor.id] as T) : null;\n        }\n    }\n\n    /**\n     * Returns the current position of the camera\n     */\n    getPosition(): Position {\n        return this.dataHelper.cleanPosition(this.dynamics.position.current);\n    }\n\n    /**\n     * Returns the current zoom level\n     */\n    getZoomLevel(): number {\n        return this.dynamics.zoom.current;\n    }\n\n    /**\n     * Returns the current viewer size\n     */\n    getSize(): Size {\n        return { ...this.state.size };\n    }\n\n    /**\n     * Checks if the viewer is in fullscreen\n     */\n    isFullscreenEnabled(): boolean {\n        return isFullscreenEnabled(this.parent);\n    }\n\n    /**\n     * Request a new render of the scene\n     */\n    needsUpdate() {\n        this.state.needsUpdate = true;\n    }\n\n    /**\n     * Request the scene to be continuously renderer (when using videos)\n     */\n    needsContinuousUpdate(enabled: boolean) {\n        if (enabled) {\n            this.state.continuousUpdateCount++;\n        } else if (this.state.continuousUpdateCount > 0) {\n            this.state.continuousUpdateCount--;\n        }\n    }\n\n    /**\n     * Resizes the scene if the viewer is resized\n     */\n    autoSize() {\n        if (\n            this.container.clientWidth !== this.state.size.width\n            || this.container.clientHeight !== this.state.size.height\n        ) {\n            this.state.size.width = Math.round(this.container.clientWidth);\n            this.state.size.height = Math.round(this.container.clientHeight);\n            this.state.aspect = this.state.size.width / this.state.size.height;\n            this.state.hFov = this.dataHelper.vFovToHFov(this.state.vFov);\n\n            this.dispatchEvent(new SizeUpdatedEvent(this.getSize()));\n            this.onResize();\n        }\n    }\n\n    /**\n     * Loads a new panorama file\n     * @description Loads a new panorama file, optionally changing the camera position/zoom and activating the transition animation.<br>\n     * If the \"options\" parameter is not defined, the camera will not move and the ongoing animation will continue.<br>\n     * If another loading is already in progress it will be aborted.\n     * @returns promise resolved with false if the loading was aborted by another call\n     */\n    setPanorama(path: any, options: PanoramaOptions = {}): Promise<boolean> {\n        this.textureLoader.abortLoading();\n        this.state.transitionAnimation?.cancel();\n\n        // apply default parameters on first load\n        if (!this.state.ready) {\n            ['sphereCorrection', 'panoData'].forEach((opt) => {\n                if (!(opt in options)) {\n                    // @ts-ignore\n                    options[opt] = this.config[opt];\n                }\n            });\n        }\n\n        if (options.transition === undefined) {\n            options.transition = true;\n        }\n        if (options.speed === undefined) {\n            options.speed = DEFAULT_TRANSITION;\n        }\n        if (options.showLoader === undefined) {\n            options.showLoader = true;\n        }\n        if (options.caption === undefined) {\n            options.caption = this.config.caption;\n        }\n        if (options.description === undefined) {\n            options.description = this.config.description;\n        }\n        if (!options.panoData && typeof this.config.panoData === 'function') {\n            options.panoData = this.config.panoData;\n        }\n\n        const positionProvided = !isNil(options.position);\n        const zoomProvided = !isNil(options.zoom);\n\n        if (positionProvided || zoomProvided) {\n            this.stopAll();\n        }\n\n        this.hideError();\n        this.resetIdleTimer();\n\n        this.config.panorama = path;\n        this.config.caption = options.caption;\n        this.config.description = options.description;\n\n        const done = (err?: Error) => {\n            if (isAbortError(err)) {\n                return false;\n            }\n\n            this.loader.hide();\n            this.state.loadingPromise = null;\n\n            if (err) {\n                this.navbar.setCaption('');\n                this.showError(this.config.lang.loadError);\n                console.error(err);\n                this.dispatchEvent(new PanoramaErrorEvent(path, err));\n                throw err;\n            } else {\n                this.navbar.setCaption(this.config.caption);\n                return true;\n            }\n        };\n\n        this.navbar.setCaption(`<em>${this.config.lang.loading}</em>`);\n        if (options.showLoader || !this.state.ready) {\n            this.loader.show();\n        }\n\n        this.dispatchEvent(new PanoramaLoadEvent(path));\n\n        const loadingPromise = this.adapter.loadTexture(this.config.panorama, true, options.panoData).then((textureData) => {\n            // check if another panorama was requested\n            if (textureData.panorama !== this.config.panorama) {\n                this.adapter.disposeTexture(textureData);\n                throw getAbortError();\n            }\n            return textureData;\n        });\n\n        if (!options.transition || !this.state.ready || !this.adapter.supportsTransition(this.config.panorama)) {\n            this.state.loadingPromise = loadingPromise\n                .then((textureData) => {\n                    this.renderer.show();\n                    this.renderer.setTexture(textureData);\n                    this.renderer.setPanoramaPose(textureData.panoData);\n                    this.renderer.setSphereCorrection(options.sphereCorrection);\n\n                    if (!this.state.ready) {\n                        this.init();\n                    }\n\n                    this.dispatchEvent(new PanoramaLoadedEvent(textureData));\n\n                    if (zoomProvided) {\n                        this.zoom(options.zoom);\n                    }\n                    if (positionProvided) {\n                        this.rotate(options.position);\n                    }\n                })\n                .then(\n                    () => done(),\n                    (err) => done(err)\n                );\n        } else {\n            this.state.loadingPromise = loadingPromise\n                .then((textureData) => {\n                    this.loader.hide();\n\n                    this.dispatchEvent(new PanoramaLoadedEvent(textureData));\n\n                    this.state.transitionAnimation = this.renderer.transition(textureData, options);\n                    return this.state.transitionAnimation;\n                })\n                .then((completed) => {\n                    this.state.transitionAnimation = null;\n                    if (!completed) {\n                        throw getAbortError();\n                    }\n                })\n                .then(\n                    () => done(),\n                    (err) => done(err)\n                );\n        }\n\n        return this.state.loadingPromise;\n    }\n\n    /**\n     * Update options\n     * @throws {@link PSVError} if the configuration is invalid\n     */\n    setOptions(options: Partial<UpdatableViewerConfig>) {\n        const rawConfig: ViewerConfig = {\n            ...this.config,\n            ...options,\n        };\n\n        for (let [key, value] of Object.entries(options) as Array<[keyof typeof rawConfig, any]>) {\n            if (!(key in DEFAULTS)) {\n                logWarn(`Unknown option ${key}`);\n                continue;\n            }\n\n            if (key in READONLY_OPTIONS) {\n                logWarn((READONLY_OPTIONS as any)[key]);\n                continue;\n            }\n\n            if (key in CONFIG_PARSERS) {\n                // @ts-ignore\n                value = CONFIG_PARSERS[key](value, {\n                    rawConfig: rawConfig,\n                    defValue: DEFAULTS[key],\n                } as any);\n            }\n\n            // @ts-ignore\n            this.config[key] = value;\n\n            switch (key) {\n                case 'mousemove':\n                    if (!this.state.cursorOverride) {\n                        this.setCursor(null);\n                    }\n                    break;\n\n                case 'caption':\n                    this.navbar.setCaption(this.config.caption);\n                    break;\n\n                case 'size':\n                    this.resize(this.config.size);\n                    break;\n\n                case 'sphereCorrection':\n                    this.renderer.setSphereCorrection(this.config.sphereCorrection);\n                    break;\n\n                case 'navbar':\n                case 'lang':\n                    this.navbar.setButtons(this.config.navbar);\n                    break;\n\n                case 'moveSpeed':\n                case 'zoomSpeed':\n                    this.dynamics.updateSpeeds();\n                    break;\n\n                case 'minFov':\n                case 'maxFov':\n                    this.dynamics.zoom.setValue(this.dataHelper.fovToZoomLevel(this.state.vFov));\n                    this.dispatchEvent(new ZoomUpdatedEvent(this.getZoomLevel()));\n                    break;\n\n                case 'keyboard':\n                    if (this.config.keyboard === 'always') {\n                        this.startKeyboardControl();\n                    } else {\n                        this.stopKeyboardControl();\n                    }\n                    break;\n\n                default:\n                    break;\n            }\n        }\n\n        this.needsUpdate();\n\n        this.dispatchEvent(new ConfigChangedEvent(Object.keys(options) as any));\n    }\n\n    /**\n     * Update options\n     * @throws {@link PSVError} if the configuration is invalid\n     */\n    setOption<T extends keyof UpdatableViewerConfig>(option: T, value: UpdatableViewerConfig[T]) {\n        this.setOptions({ [option]: value });\n    }\n\n    /**\n     * Displays an error message over the viewer\n     */\n    showError(message: string) {\n        this.overlay.show({\n            id: IDS.ERROR,\n            image: errorIcon,\n            title: message,\n            dissmisable: false,\n        });\n    }\n\n    /**\n     *  Hides the error message\n     */\n    hideError() {\n        this.overlay.hide(IDS.ERROR);\n    }\n\n    /**\n     * Rotates the view to specific position\n     */\n    rotate(position: ExtendedPosition) {\n        const e = new BeforeRotateEvent(this.dataHelper.cleanPosition(position));\n        this.dispatchEvent(e);\n\n        if (e.defaultPrevented) {\n            return;\n        }\n\n        this.dynamics.position.setValue(e.position);\n    }\n\n    /**\n     * Zooms to a specific level between `maxFov` and `minFov`\n     */\n    zoom(level: number) {\n        this.dynamics.zoom.setValue(level);\n    }\n\n    /**\n     * Increases the zoom level\n     */\n    zoomIn(step = 1) {\n        this.dynamics.zoom.step(step);\n    }\n\n    /**\n     * Decreases the zoom level\n     */\n    zoomOut(step = 1) {\n        this.dynamics.zoom.step(-step);\n    }\n\n    /**\n     * Rotates and zooms the view with a smooth animation\n     */\n    animate(options: AnimateOptions): Animation {\n        const positionProvided = isExtendedPosition(options);\n        const zoomProvided = !isNil(options.zoom);\n\n        const e = new BeforeAnimateEvent(\n            positionProvided ? this.dataHelper.cleanPosition(options) : undefined,\n            options.zoom\n        );\n        this.dispatchEvent(e);\n\n        if (e.defaultPrevented) {\n            return;\n        }\n\n        this.stopAll();\n\n        const { duration, properties } = this.dataHelper.getAnimationProperties(options.speed, e.position, e.zoomLevel);\n\n        // if no animation needed\n        if (!duration) {\n            if (positionProvided) {\n                this.rotate(e.position);\n            }\n            if (zoomProvided) {\n                this.zoom(e.zoomLevel);\n            }\n\n            return new Animation(null);\n        }\n\n        this.state.animation = new Animation({\n            properties: properties,\n            duration: duration,\n            easing: options.easing || 'inOutSine',\n            onTick: (props) => {\n                if (positionProvided) {\n                    this.dynamics.position.setValue({\n                        yaw: props.yaw,\n                        pitch: props.pitch,\n                    });\n                }\n                if (zoomProvided) {\n                    this.dynamics.zoom.setValue(props.zoom);\n                }\n            },\n        });\n\n        this.state.animation.then(() => {\n            this.state.animation = null;\n            this.resetIdleTimer();\n        });\n\n        return this.state.animation;\n    }\n\n    /**\n     * Stops the ongoing animation\n     * @description The return value is a Promise because the is no guaranty the animation can be stopped synchronously.\n     */\n    stopAnimation(): PromiseLike<any> {\n        if (this.state.animation) {\n            this.state.animation.cancel();\n            return this.state.animation;\n        } else {\n            return Promise.resolve();\n        }\n    }\n\n    /**\n     * Resizes the viewer\n     */\n    resize(size: CssSize) {\n        this.__setSize(size);\n        this.autoSize();\n    }\n\n    private __setSize(size: CssSize) {\n        const s = size as any;\n        (['width', 'height'] as Array<'width' | 'height'>).forEach((dim) => {\n            if (size && s[dim]) {\n                if (/^[0-9.]+$/.test(s[dim])) {\n                    s[dim] += 'px';\n                }\n                this.parent.style[dim] = s[dim];\n            }\n        });\n    }\n\n    /**\n     * Enters the fullscreen mode\n     */\n    enterFullscreen() {\n        if (!this.isFullscreenEnabled()) {\n            requestFullscreen(this.parent);\n        }\n    }\n\n    /**\n     * Exits the fullscreen mode\n     */\n    exitFullscreen() {\n        if (this.isFullscreenEnabled()) {\n            exitFullscreen();\n        }\n    }\n\n    /**\n     * Enters or exits the fullscreen mode\n     */\n    toggleFullscreen() {\n        if (!this.isFullscreenEnabled()) {\n            this.enterFullscreen();\n        } else {\n            this.exitFullscreen();\n        }\n    }\n\n    /**\n     * Enables the keyboard controls\n     */\n    startKeyboardControl() {\n        this.state.keyboardEnabled = true;\n    }\n\n    /**\n     * Disables the keyboard controls\n     */\n    stopKeyboardControl() {\n        this.state.keyboardEnabled = false;\n    }\n\n    /**\n     * Creates a new tooltip\n     * @description Use {@link Tooltip.move} to update the tooltip without re-create\n     * @throws {@link PSVError} if the configuration is invalid\n     */\n    createTooltip(config: TooltipConfig): Tooltip {\n        return new Tooltip(this, config);\n    }\n\n    /**\n     * Changes the global mouse cursor\n     */\n    setCursor(cursor: string) {\n        this.state.cursorOverride = cursor;\n        if (!cursor) {\n            this.container.style.cursor = this.config.mousemove ? 'move' : 'default';\n        } else {\n            this.container.style.cursor = cursor;\n        }\n    }\n\n    /**\n     * Subscribes to events on objects in the three.js scene\n     * @param userDataKey - only objects with the following `userData` will be observed\n     */\n    observeObjects(userDataKey: string): void {\n        if (!this.state.objectsObservers[userDataKey]) {\n            this.state.objectsObservers[userDataKey] = null;\n        }\n    }\n\n    /**\n     * Unsubscribes to events on objects\n     */\n    unobserveObjects(userDataKey: string): void {\n        delete this.state.objectsObservers[userDataKey];\n    }\n\n    /**\n     * Stops all current animations\n     * @internal\n     */\n    stopAll(): PromiseLike<void> {\n        this.dispatchEvent(new StopAllEvent());\n\n        this.disableIdleTimer();\n\n        return this.stopAnimation();\n    }\n}\n"],"mappings":"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","names":["ACTIONS","target","src","angle","import_three","SliderDirection","import_three","getConfig","angle","import_three","import_three","ThreeCache","angle","import_three","distance","import_three","import_three","import_three","import_three","import_three","import_three"]}