var app=function(){"use strict";function e(){}function t(e){return e()}function n(){return Object.create(null)}function o(e){e.forEach(t)}function r(e){return"function"==typeof e}function l(e,t){return e!=e?t==t:e!==t||e&&"object"==typeof e||"function"==typeof e}function i(e,t){e.appendChild(t)}function a(e,t,n){e.insertBefore(t,n||null)}function c(e){e.parentNode.removeChild(e)}function u(e){return document.createElement(e)}function s(e){return document.createElementNS("http://www.w3.org/2000/svg",e)}function d(e){return document.createTextNode(e)}function p(){return d(" ")}function f(e,t,n,o){return e.addEventListener(t,n,o),()=>e.removeEventListener(t,n,o)}function m(e,t,n){null==n?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function h(e,t,n){t in e?e[t]=n:m(e,t,n)}function g(e,t){e.value=null==t?"":t}function b(e,t,n,o){e.style.setProperty(t,n,o?"important":"")}let $;function v(e){$=e}function y(){if(!$)throw new Error("Function called outside component initialization");return $}function w(e){y().$$.on_mount.push(e)}const U=[],x=[],C=[],L=[],k=Promise.resolve();let _=!1;function E(e){C.push(e)}let j=!1;const P=new Set;function H(){if(!j){j=!0;do{for(let e=0;e<U.length;e+=1){const t=U[e];v(t),R(t.$$)}for(v(null),U.length=0;x.length;)x.pop()();for(let e=0;e<C.length;e+=1){const t=C[e];P.has(t)||(P.add(t),t())}C.length=0}while(U.length);for(;L.length;)L.pop()();_=!1,j=!1,P.clear()}}function R(e){if(null!==e.fragment){e.update(),o(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(E)}}const S=new Set;let A;function M(e,t){e&&e.i&&(S.delete(e),e.i(t))}function O(e,t,n,o){if(e&&e.o){if(S.has(e))return;S.add(e),A.c.push((()=>{S.delete(e),o&&(n&&e.d(1),o())})),e.o(t)}}function D(e){e&&e.c()}function T(e,n,l){const{fragment:i,on_mount:a,on_destroy:c,after_update:u}=e.$$;i&&i.m(n,l),E((()=>{const n=a.map(t).filter(r);c?c.push(...n):o(n),e.$$.on_mount=[]})),u.forEach(E)}function F(e,t){const n=e.$$;null!==n.fragment&&(o(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function N(e,t){-1===e.$$.dirty[0]&&(U.push(e),_||(_=!0,k.then(H)),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function B(t,r,l,i,a,u,s=[-1]){const d=$;v(t);const p=r.props||{},f=t.$$={fragment:null,ctx:null,props:u,update:e,not_equal:a,bound:n(),on_mount:[],on_destroy:[],before_update:[],after_update:[],context:new Map(d?d.$$.context:[]),callbacks:n(),dirty:s,skip_bound:!1};let m=!1;if(f.ctx=l?l(t,p,((e,n,...o)=>{const r=o.length?o[0]:n;return f.ctx&&a(f.ctx[e],f.ctx[e]=r)&&(!f.skip_bound&&f.bound[e]&&f.bound[e](r),m&&N(t,e)),n})):[],f.update(),m=!0,o(f.before_update),f.fragment=!!i&&i(f.ctx),r.target){if(r.hydrate){const e=function(e){return Array.from(e.childNodes)}(r.target);f.fragment&&f.fragment.l(e),e.forEach(c)}else f.fragment&&f.fragment.c();r.intro&&M(t.$$.fragment),T(t,r.target,r.anchor),H()}v(d)}class K{$destroy(){F(this,1),this.$destroy=e}$on(e,t){const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(t),()=>{const e=n.indexOf(t);-1!==e&&n.splice(e,1)}}$set(e){var t;this.$$set&&(t=e,0!==Object.keys(t).length)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}function Q(t){let n,o,r,l,d;return{c(){n=u("a"),o=s("svg"),r=s("path"),l=s("path"),d=s("path"),m(r,"d","M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"),m(l,"d","M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6\n      120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3\n      125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2"),m(l,"fill","currentColor"),b(l,"transform-origin","130px 106px"),m(l,"class","octo-arm svelte-9fn96p"),m(d,"d","M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6\n      C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0\n      C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1\n      C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4\n      C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9\n      C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5\n      C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9\n      L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z"),m(d,"fill","currentColor"),m(d,"class","octo-body"),m(o,"width","80"),m(o,"height","80"),m(o,"viewBox","0 0 250 250"),b(o,"fill","#151513"),b(o,"color","#fff"),b(o,"position","absolute"),b(o,"top","0"),b(o,"border","0"),b(o,"right","0"),b(o,"border-top-right-radius","0.5rem"),m(o,"aria-hidden","true"),m(n,"href",t[0]),m(n,"class","github-corner svelte-9fn96p"),m(n,"aria-label","View source on GitHub")},m(e,t){a(e,n,t),i(n,o),i(o,r),i(o,l),i(o,d)},p(e,[t]){1&t&&m(n,"href",e[0])},i:e,o:e,d(e){e&&c(n)}}}function V(e,t,n){let{repoUrl:o="https://github.com/tholman/github-corners"}=t;return e.$$set=e=>{"repoUrl"in e&&n(0,o=e.repoUrl)},[o]}class W extends K{constructor(e){super(),B(this,e,V,Q,l,{repoUrl:0})}}function q(e){return!!e&&"blob"===e.substring(0,4)}function G(e,t,n){const o=e.slice();return o[14]=t[n].url,o[15]=t[n].label,o[17]=n,o}function I(e){let t,n,r,l,s,h,$,v,y,w,U,x,C,L,k,_,E,j,P,H,R,S,A,N,B,K,Q,V,I,Z,z=(e[2]?e[2]:"Upload")+"";n=new W({props:{repoUrl:"https://github.com/bryik/stereo-panorama-viewer"}});let X=e[5],te=[];for(let t=0;t<X.length;t+=1)te[t]=J(G(e,X,t));function ne(e,t){return(null==S||2&t)&&(S=!q(e[1])),S?ee:Y}let oe=ne(e,-1),re=oe(e);return{c(){t=u("form"),D(n.$$.fragment),r=p(),l=u("h1"),l.textContent="Stereo Panorama Viewer",s=p(),h=u("p"),h.innerHTML='Drag and drop a\n        <a href="https://developers.google.com/vr/discover/360-degree-media#common_formats">stacked</a>\n        (over/under) stereo panorama into this window. Alternatively, provide a URL\n        below.',$=p(),v=u("details"),y=u("summary"),y.textContent="Examples",w=p();for(let e=0;e<te.length;e+=1)te[e].c();U=p(),x=u("div"),C=u("div"),L=u("label"),L.textContent="URL",k=p(),_=u("input"),E=p(),j=u("small"),j.textContent="Must be a direct link to a stereo panorama hosted on a CORS-enabled\n            host (e.g. Imgur).",P=p(),H=u("button"),H.textContent="Go",R=p(),re.c(),A=p(),N=u("button"),B=d(z),K=p(),Q=u("button"),Q.textContent="Close",m(l,"class","f4 f3-ns lh-title"),m(h,"class","lh-copy f5 measure"),m(y,"class","f5 lh-copy svelte-1yg7omo"),m(L,"for","pano-url"),m(L,"class","f6 b db mb2"),m(_,"class","input-reset ba b--black-20 pa2 mb2 dib w-100"),m(_,"type","url"),m(_,"id","pano-url"),m(_,"aria-describedby","pano-desc"),m(_,"placeholder","https://i.imgur.com/xLc3Kj7.jpg"),_.required=!0,m(j,"id","pano-desc"),m(j,"class","f6 lh-copy black-60 db mb2"),m(C,"class","measure-narrow"),m(x,"class","pa3 black-80"),m(H,"class","f6 link dim br2 ph3 pv2 mb2 dib white bg-near-black svelte-1yg7omo"),b(H,"cursor","pointer"),m(H,"type","submit"),m(N,"id","upload-button"),m(N,"class","f6 link dim br2 ph3 pv2 mb2 dib white bg-near-black svelte-1yg7omo"),b(N,"cursor","pointer"),m(N,"type","button"),m(Q,"id","close-button"),m(Q,"type","button"),m(Q,"class","f6 link dim br2 ph3 pv2 mb2 dib white bg-red fr svelte-1yg7omo"),b(Q,"cursor","pointer"),m(t,"class","instructions avenir ma3 pa3 bg-near-white br3 shadow-4 svelte-1yg7omo")},m(o,c){a(o,t,c),T(n,t,null),i(t,r),i(t,l),i(t,s),i(t,h),i(t,$),i(t,v),i(v,y),i(v,w);for(let e=0;e<te.length;e+=1)te[e].m(v,null);var u;i(t,U),i(t,x),i(x,C),i(C,L),i(C,k),i(C,_),g(_,e[4]),i(C,E),i(C,j),i(t,P),i(t,H),i(t,R),re.m(t,null),i(t,A),i(t,N),i(N,B),i(t,K),i(t,Q),V=!0,I||(Z=[f(_,"input",e[13]),f(N,"click",e[7]),f(Q,"click",e[6]),f(t,"submit",(u=e[8],function(e){return e.preventDefault(),u.call(this,e)}))],I=!0)},p(e,n){if(306&n){let t;for(X=e[5],t=0;t<X.length;t+=1){const o=G(e,X,t);te[t]?te[t].p(o,n):(te[t]=J(o),te[t].c(),te[t].m(v,null))}for(;t<te.length;t+=1)te[t].d(1);te.length=X.length}16&n&&g(_,e[4]),oe===(oe=ne(e,n))&&re?re.p(e,n):(re.d(1),re=oe(e),re&&(re.c(),re.m(t,A))),(!V||4&n)&&z!==(z=(e[2]?e[2]:"Upload")+"")&&function(e,t){t=""+t,e.wholeText!==t&&(e.data=t)}(B,z)},i(e){V||(M(n.$$.fragment,e),V=!0)},o(e){O(n.$$.fragment,e),V=!1},d(e){e&&c(t),F(n),function(e,t){for(let n=0;n<e.length;n+=1)e[n]&&e[n].d(t)}(te,e),re.d(),I=!1,o(Z)}}}function Z(t){let n,o,r;return{c(){n=u("div"),n.textContent="...",m(n,"class","instructions glow br2 ph3 pv2 mb2 dib bg-near-white fr o-20 svelte-1yg7omo"),b(n,"cursor","pointer")},m(e,l){a(e,n,l),o||(r=f(n,"click",t[6]),o=!0)},p:e,i:e,o:e,d(e){e&&c(n),o=!1,r()}}}function z(e){let t,n,o,r,l,s=e[15]+"";function h(...t){return e[12](e[14],...t)}return{c(){t=u("p"),n=d(s),o=p(),m(t,"class","f5 lh-copy ml3"),b(t,"cursor","pointer")},m(e,c){a(e,t,c),i(t,n),i(t,o),r||(l=f(t,"click",h),r=!0)},p(t,n){e=t},d(e){e&&c(t),r=!1,l()}}}function X(e){let t,n,o,r,l,s=e[15]+"";function h(...t){return e[11](e[14],...t)}return{c(){t=u("p"),n=d(s),o=p(),m(t,"class","f5 lh-copy ml3 b"),b(t,"cursor","pointer")},m(e,c){a(e,t,c),i(t,n),i(t,o),r||(l=f(t,"click",h),r=!0)},p(t,n){e=t},d(e){e&&c(t),r=!1,l()}}}function J(e){let t;function n(e,t){return e[14]===e[1]?X:z}let o=n(e),r=o(e);return{c(){r.c(),t=d("")},m(e,n){r.m(e,n),a(e,t,n)},p(e,l){o===(o=n(e))&&r?r.p(e,l):(r.d(1),r=o(e),r&&(r.c(),r.m(t.parentNode,t)))},d(e){r.d(e),e&&c(t)}}}function Y(t){let n,o,r;return{c(){n=u("input"),m(n,"id","file-upload"),m(n,"type","file"),m(n,"accept","image/*"),b(n,"display","none"),n.value=""},m(e,l){a(e,n,l),o||(r=f(n,"change",t[9]),o=!0)},p:e,d(e){e&&c(n),o=!1,r()}}}function ee(t){let n,o,r;return{c(){n=u("input"),m(n,"id","file-upload"),m(n,"type","file"),m(n,"accept","image/*"),b(n,"display","none"),n.value=""},m(e,l){a(e,n,l),o||(r=f(n,"change",t[9]),o=!0)},p:e,d(e){e&&c(n),o=!1,r()}}}function te(e){let t,n,r,l,i;const s=[Z,I],d=[];function p(e,t){return e[3]?0:1}return n=p(e),r=d[n]=s[n](e),{c(){t=u("div"),r.c(),m(t,"style",l=!e[0]&&"display: none")},m(e,o){a(e,t,o),d[n].m(t,null),i=!0},p(e,[a]){let c=n;n=p(e),n===c?d[n].p(e,a):(A={r:0,c:[],p:A},O(d[c],1,1,(()=>{d[c]=null})),A.r||o(A.c),A=A.p,r=d[n],r||(r=d[n]=s[n](e),r.c()),M(r,1),r.m(t,null)),(!i||1&a&&l!==(l=!e[0]&&"display: none"))&&m(t,"style",l)},i(e){i||(M(r),i=!0)},o(e){O(r),i=!1},d(e){e&&c(t),d[n].d()}}}function ne(e,t,n){let{visible:o=!0}=t,{panoUrl:r=null}=t,{filename:l=null}=t,{fileUploadHandler:i}=t,a=!1,c="";const u=()=>i({newPanoUrl:c,filename:"",shouldUpdateQuerystring:!0});return e.$$set=e=>{"visible"in e&&n(0,o=e.visible),"panoUrl"in e&&n(1,r=e.panoUrl),"filename"in e&&n(2,l=e.filename),"fileUploadHandler"in e&&n(10,i=e.fileUploadHandler)},e.$$.update=()=>{2&e.$$.dirty&&(q(r)?n(4,c=""):n(4,c=r))},[o,r,l,a,c,[{url:"https://i.imgur.com/PgAHSy8.jpg",label:"Red pond (The Witness)"},{url:"https://i.imgur.com/xLc3Kj7.jpg",label:"Reaching out (The Witness)"},{url:"https://i.imgur.com/xlrCeyV.jpg",label:"Kaer Morhen Balcony (Witcher 3)"},{url:"https://i.imgur.com/hD2QXlF.jpg",label:"Mount Kilimanjaro (real life)"}],()=>n(3,a=!a),()=>{document.getElementById("file-upload").click()},u,e=>{const t=e.target.files[0],n=t.name,o=URL.createObjectURL(t);i({newPanoUrl:o,newFilename:n})},i,e=>{n(4,c=e),u()},e=>{n(4,c=e),u()},function(){c=this.value,n(4,c),n(1,r)}]}class oe extends K{constructor(e){super(),B(this,e,ne,te,l,{visible:0,panoUrl:1,filename:2,fileUploadHandler:10})}}function re(t){let n,o,r,l;return{c(){n=u("a-scene"),o=u("a-camera"),r=p(),l=u("a-entity"),h(o,"position","0 0 0"),h(o,"stereocam","eye:left;"),h(l,"rotation","0 0 0"),h(l,"overunder",t[0])},m(e,t){a(e,n,t),i(n,o),i(n,r),i(n,l)},p(e,[t]){1&t&&h(l,"overunder",e[0])},i:e,o:e,d(e){e&&c(n)}}}function le(e,t,n){let{panoUrl:o="https://i.imgur.com/PgAHSy8.jpg"}=t;return e.$$set=e=>{"panoUrl"in e&&n(0,o=e.panoUrl)},[o]}class ie extends K{constructor(e){super(),B(this,e,le,re,l,{panoUrl:0})}}function ae(e){e.preventDefault(),e.stopPropagation(),e.dataTransfer.dropEffect="copy"}function ce(e){e.preventDefault(),e.stopPropagation(),document.body.style.opacity=.5}function ue(e){e.preventDefault(),e.stopPropagation(),document.body.style.opacity=1}function se(e,t,n){let{fileUploadHandler:o}=t;function r(e){e.preventDefault(),e.stopPropagation();const t=e.dataTransfer.files[0],n=URL.createObjectURL(t),r=t.name;o({newPanoUrl:n,newFilename:r}),document.body.style.opacity=1}var l;return w((()=>{document.addEventListener("dragover",ae,!1),document.addEventListener("dragenter",ce,!1),document.addEventListener("dragleave",ue,!1),document.addEventListener("drop",r,!1)})),l=()=>{document.removeEventListener("dragover",ae,!1),document.removeEventListener("dragenter",ce,!1),document.removeEventListener("dragleave",ue,!1),document.removeEventListener("drop",r,!1)},y().$$.on_destroy.push(l),e.$$set=e=>{"fileUploadHandler"in e&&n(0,o=e.fileUploadHandler)},[o]}class de extends K{constructor(e){super(),B(this,e,se,null,l,{fileUploadHandler:0})}}function pe(){const{location:e}=window;return new URLSearchParams(e.search)}function fe(e){let t,n,o,r,l,i;return t=new de({props:{fileUploadHandler:e[3]}}),o=new oe({props:{panoUrl:e[0],filename:e[1],visible:e[2],fileUploadHandler:e[3]}}),l=new ie({props:{panoUrl:e[0]}}),{c(){D(t.$$.fragment),n=p(),D(o.$$.fragment),r=p(),D(l.$$.fragment)},m(e,c){T(t,e,c),a(e,n,c),T(o,e,c),a(e,r,c),T(l,e,c),i=!0},p(e,[t]){const n={};1&t&&(n.panoUrl=e[0]),2&t&&(n.filename=e[1]),4&t&&(n.visible=e[2]),o.$set(n);const r={};1&t&&(r.panoUrl=e[0]),l.$set(r)},i(e){i||(M(t.$$.fragment,e),M(o.$$.fragment,e),M(l.$$.fragment,e),i=!0)},o(e){O(t.$$.fragment,e),O(o.$$.fragment,e),O(l.$$.fragment,e),i=!1},d(e){F(t,e),e&&c(n),F(o,e),e&&c(r),F(l,e)}}}function me(e,t,n){var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(r,l){function i(e){try{c(o.next(e))}catch(e){l(e)}}function a(e){try{c(o.throw(e))}catch(e){l(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}c((o=o.apply(e,t||[])).next())}))};let r=null,l=null,i=!0;return w((()=>o(void 0,void 0,void 0,(function*(){const e=pe();e.has("embedded")&&n(2,i=!1),e.has("url")?n(0,r=e.get("url")):n(0,r="https://i.imgur.com/PgAHSy8.jpg")})))),[r,l,i,({newPanoUrl:e,newFilename:t,shouldUpdateQuerystring:o})=>{q(r)&&URL.revokeObjectURL(r),n(0,r=e),n(1,l=null!=t?t:null),o&&function(e){const t=pe();Object.entries(e).forEach((([e,n])=>{null===n?t.delete(e):t.set(e,n)}));const n=`${window.location.pathname}?${t.toString()}`;window.history.replaceState({},"",n)}({url:r})}]}return new class extends K{constructor(e){super(),B(this,e,me,fe,l,{})}}({target:document.body})}();
//# sourceMappingURL=bundle.js.map
